var oh=e=>{throw TypeError(e)};var Uo=(e,t,s)=>t.has(e)||oh("Cannot "+s);var E=(e,t,s)=>(Uo(e,t,"read from private field"),s?s.call(e):t.get(e)),ie=(e,t,s)=>t.has(e)?oh("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),X=(e,t,s,n)=>(Uo(e,t,"write to private field"),n?n.call(e,s):t.set(e,s),s),ve=(e,t,s)=>(Uo(e,t,"access private method"),s);var Qi=(e,t,s,n)=>({set _(a){X(e,t,a,s)},get _(){return E(e,t,n)}});function Zg(e,t){for(var s=0;s<t.length;s++){const n=t[s];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function s(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=s(a);fetch(a.href,i)}})();var ey=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Tf(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Rf={exports:{}},po={},Of={exports:{}},je={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ui=Symbol.for("react.element"),ty=Symbol.for("react.portal"),sy=Symbol.for("react.fragment"),ry=Symbol.for("react.strict_mode"),ny=Symbol.for("react.profiler"),ay=Symbol.for("react.provider"),iy=Symbol.for("react.context"),ly=Symbol.for("react.forward_ref"),oy=Symbol.for("react.suspense"),cy=Symbol.for("react.memo"),uy=Symbol.for("react.lazy"),ch=Symbol.iterator;function dy(e){return e===null||typeof e!="object"?null:(e=ch&&e[ch]||e["@@iterator"],typeof e=="function"?e:null)}var Af={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},If=Object.assign,$f={};function ba(e,t,s){this.props=e,this.context=t,this.refs=$f,this.updater=s||Af}ba.prototype.isReactComponent={};ba.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ba.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function qf(){}qf.prototype=ba.prototype;function Yu(e,t,s){this.props=e,this.context=t,this.refs=$f,this.updater=s||Af}var Xu=Yu.prototype=new qf;Xu.constructor=Yu;If(Xu,ba.prototype);Xu.isPureReactComponent=!0;var uh=Array.isArray,Mf=Object.prototype.hasOwnProperty,Zu={current:null},Lf={key:!0,ref:!0,__self:!0,__source:!0};function Df(e,t,s){var n,a={},i=null,l=null;if(t!=null)for(n in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(i=""+t.key),t)Mf.call(t,n)&&!Lf.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=s;else if(1<o){for(var c=Array(o),u=0;u<o;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:Ui,type:e,key:i,ref:l,props:a,_owner:Zu.current}}function hy(e,t){return{$$typeof:Ui,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function ed(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ui}function my(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(s){return t[s]})}var dh=/\/+/g;function zo(e,t){return typeof e=="object"&&e!==null&&e.key!=null?my(""+e.key):t.toString(36)}function jl(e,t,s,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case Ui:case ty:l=!0}}if(l)return l=e,a=a(l),e=n===""?"."+zo(l,0):n,uh(a)?(s="",e!=null&&(s=e.replace(dh,"$&/")+"/"),jl(a,t,s,"",function(u){return u})):a!=null&&(ed(a)&&(a=hy(a,s+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(dh,"$&/")+"/")+e)),t.push(a)),1;if(l=0,n=n===""?".":n+":",uh(e))for(var o=0;o<e.length;o++){i=e[o];var c=n+zo(i,o);l+=jl(i,t,s,c,a)}else if(c=dy(e),typeof c=="function")for(e=c.call(e),o=0;!(i=e.next()).done;)i=i.value,c=n+zo(i,o++),l+=jl(i,t,s,c,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function Gi(e,t,s){if(e==null)return e;var n=[],a=0;return jl(e,n,"","",function(i){return t.call(s,i,a++)}),n}function fy(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(s){(e._status===0||e._status===-1)&&(e._status=1,e._result=s)},function(s){(e._status===0||e._status===-1)&&(e._status=2,e._result=s)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Tt={current:null},wl={transition:null},py={ReactCurrentDispatcher:Tt,ReactCurrentBatchConfig:wl,ReactCurrentOwner:Zu};function Ff(){throw Error("act(...) is not supported in production builds of React.")}je.Children={map:Gi,forEach:function(e,t,s){Gi(e,function(){t.apply(this,arguments)},s)},count:function(e){var t=0;return Gi(e,function(){t++}),t},toArray:function(e){return Gi(e,function(t){return t})||[]},only:function(e){if(!ed(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};je.Component=ba;je.Fragment=sy;je.Profiler=ny;je.PureComponent=Yu;je.StrictMode=ry;je.Suspense=oy;je.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=py;je.act=Ff;je.cloneElement=function(e,t,s){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=If({},e.props),a=e.key,i=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,l=Zu.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)Mf.call(t,c)&&!Lf.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=s;else if(1<c){o=Array(c);for(var u=0;u<c;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:Ui,type:e.type,key:a,ref:i,props:n,_owner:l}};je.createContext=function(e){return e={$$typeof:iy,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:ay,_context:e},e.Consumer=e};je.createElement=Df;je.createFactory=function(e){var t=Df.bind(null,e);return t.type=e,t};je.createRef=function(){return{current:null}};je.forwardRef=function(e){return{$$typeof:ly,render:e}};je.isValidElement=ed;je.lazy=function(e){return{$$typeof:uy,_payload:{_status:-1,_result:e},_init:fy}};je.memo=function(e,t){return{$$typeof:cy,type:e,compare:t===void 0?null:t}};je.startTransition=function(e){var t=wl.transition;wl.transition={};try{e()}finally{wl.transition=t}};je.unstable_act=Ff;je.useCallback=function(e,t){return Tt.current.useCallback(e,t)};je.useContext=function(e){return Tt.current.useContext(e)};je.useDebugValue=function(){};je.useDeferredValue=function(e){return Tt.current.useDeferredValue(e)};je.useEffect=function(e,t){return Tt.current.useEffect(e,t)};je.useId=function(){return Tt.current.useId()};je.useImperativeHandle=function(e,t,s){return Tt.current.useImperativeHandle(e,t,s)};je.useInsertionEffect=function(e,t){return Tt.current.useInsertionEffect(e,t)};je.useLayoutEffect=function(e,t){return Tt.current.useLayoutEffect(e,t)};je.useMemo=function(e,t){return Tt.current.useMemo(e,t)};je.useReducer=function(e,t,s){return Tt.current.useReducer(e,t,s)};je.useRef=function(e){return Tt.current.useRef(e)};je.useState=function(e){return Tt.current.useState(e)};je.useSyncExternalStore=function(e,t,s){return Tt.current.useSyncExternalStore(e,t,s)};je.useTransition=function(){return Tt.current.useTransition()};je.version="18.3.1";Of.exports=je;var S=Of.exports;const is=Tf(S),Uf=Zg({__proto__:null,default:is},[S]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xy=S,gy=Symbol.for("react.element"),yy=Symbol.for("react.fragment"),vy=Object.prototype.hasOwnProperty,jy=xy.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,wy={key:!0,ref:!0,__self:!0,__source:!0};function zf(e,t,s){var n,a={},i=null,l=null;s!==void 0&&(i=""+s),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(l=t.ref);for(n in t)vy.call(t,n)&&!wy.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:gy,type:e,key:i,ref:l,props:a,_owner:jy.current}}po.Fragment=yy;po.jsx=zf;po.jsxs=zf;Rf.exports=po;var r=Rf.exports,Cc={},Bf={exports:{}},Jt={},Kf={exports:{}},Wf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(V,Y){var Z=V.length;V.push(Y);e:for(;0<Z;){var O=Z-1>>>1,C=V[O];if(0<a(C,Y))V[O]=Y,V[Z]=C,Z=O;else break e}}function s(V){return V.length===0?null:V[0]}function n(V){if(V.length===0)return null;var Y=V[0],Z=V.pop();if(Z!==Y){V[0]=Z;e:for(var O=0,C=V.length,B=C>>>1;O<B;){var K=2*(O+1)-1,ce=V[K],Q=K+1,ge=V[Q];if(0>a(ce,Z))Q<C&&0>a(ge,ce)?(V[O]=ge,V[Q]=Z,O=Q):(V[O]=ce,V[K]=Z,O=K);else if(Q<C&&0>a(ge,Z))V[O]=ge,V[Q]=Z,O=Q;else break e}}return Y}function a(V,Y){var Z=V.sortIndex-Y.sortIndex;return Z!==0?Z:V.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,o=l.now();e.unstable_now=function(){return l.now()-o}}var c=[],u=[],d=1,m=null,f=3,v=!1,g=!1,w=!1,_=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(V){for(var Y=s(u);Y!==null;){if(Y.callback===null)n(u);else if(Y.startTime<=V)n(u),Y.sortIndex=Y.expirationTime,t(c,Y);else break;Y=s(u)}}function j(V){if(w=!1,y(V),!g)if(s(c)!==null)g=!0,ue(b);else{var Y=s(u);Y!==null&&me(j,Y.startTime-V)}}function b(V,Y){g=!1,w&&(w=!1,x(h),h=-1),v=!0;var Z=f;try{for(y(Y),m=s(c);m!==null&&(!(m.expirationTime>Y)||V&&!U());){var O=m.callback;if(typeof O=="function"){m.callback=null,f=m.priorityLevel;var C=O(m.expirationTime<=Y);Y=e.unstable_now(),typeof C=="function"?m.callback=C:m===s(c)&&n(c),y(Y)}else n(c);m=s(c)}if(m!==null)var B=!0;else{var K=s(u);K!==null&&me(j,K.startTime-Y),B=!1}return B}finally{m=null,f=Z,v=!1}}var N=!1,T=null,h=-1,R=5,P=-1;function U(){return!(e.unstable_now()-P<R)}function W(){if(T!==null){var V=e.unstable_now();P=V;var Y=!0;try{Y=T(!0,V)}finally{Y?ee():(N=!1,T=null)}}else N=!1}var ee;if(typeof p=="function")ee=function(){p(W)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,re=oe.port2;oe.port1.onmessage=W,ee=function(){re.postMessage(null)}}else ee=function(){_(W,0)};function ue(V){T=V,N||(N=!0,ee())}function me(V,Y){h=_(function(){V(e.unstable_now())},Y)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(V){V.callback=null},e.unstable_continueExecution=function(){g||v||(g=!0,ue(b))},e.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<V?Math.floor(1e3/V):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return s(c)},e.unstable_next=function(V){switch(f){case 1:case 2:case 3:var Y=3;break;default:Y=f}var Z=f;f=Y;try{return V()}finally{f=Z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(V,Y){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var Z=f;f=V;try{return Y()}finally{f=Z}},e.unstable_scheduleCallback=function(V,Y,Z){var O=e.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?O+Z:O):Z=O,V){case 1:var C=-1;break;case 2:C=250;break;case 5:C=1073741823;break;case 4:C=1e4;break;default:C=5e3}return C=Z+C,V={id:d++,callback:Y,priorityLevel:V,startTime:Z,expirationTime:C,sortIndex:-1},Z>O?(V.sortIndex=Z,t(u,V),s(c)===null&&V===s(u)&&(w?(x(h),h=-1):w=!0,me(j,Z-O))):(V.sortIndex=C,t(c,V),g||v||(g=!0,ue(b))),V},e.unstable_shouldYield=U,e.unstable_wrapCallback=function(V){var Y=f;return function(){var Z=f;f=Y;try{return V.apply(this,arguments)}finally{f=Z}}}})(Wf);Kf.exports=Wf;var _y=Kf.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var by=S,Gt=_y;function H(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)t+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Vf=new Set,li={};function vn(e,t){fa(e,t),fa(e+"Capture",t)}function fa(e,t){for(li[e]=t,e=0;e<t.length;e++)Vf.add(t[e])}var Vs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ec=Object.prototype.hasOwnProperty,Ny=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,hh={},mh={};function ky(e){return Ec.call(mh,e)?!0:Ec.call(hh,e)?!1:Ny.test(e)?mh[e]=!0:(hh[e]=!0,!1)}function Sy(e,t,s,n){if(s!==null&&s.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:s!==null?!s.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Cy(e,t,s,n){if(t===null||typeof t>"u"||Sy(e,t,s,n))return!0;if(n)return!1;if(s!==null)switch(s.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Rt(e,t,s,n,a,i,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=s,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=l}var gt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){gt[e]=new Rt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];gt[t]=new Rt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){gt[e]=new Rt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){gt[e]=new Rt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){gt[e]=new Rt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){gt[e]=new Rt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){gt[e]=new Rt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){gt[e]=new Rt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){gt[e]=new Rt(e,5,!1,e.toLowerCase(),null,!1,!1)});var td=/[\-:]([a-z])/g;function sd(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(td,sd);gt[t]=new Rt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(td,sd);gt[t]=new Rt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(td,sd);gt[t]=new Rt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){gt[e]=new Rt(e,1,!1,e.toLowerCase(),null,!1,!1)});gt.xlinkHref=new Rt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){gt[e]=new Rt(e,1,!1,e.toLowerCase(),null,!0,!0)});function rd(e,t,s,n){var a=gt.hasOwnProperty(t)?gt[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Cy(t,s,a,n)&&(s=null),n||a===null?ky(t)&&(s===null?e.removeAttribute(t):e.setAttribute(t,""+s)):a.mustUseProperty?e[a.propertyName]=s===null?a.type===3?!1:"":s:(t=a.attributeName,n=a.attributeNamespace,s===null?e.removeAttribute(t):(a=a.type,s=a===3||a===4&&s===!0?"":""+s,n?e.setAttributeNS(n,t,s):e.setAttribute(t,s))))}var Js=by.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ji=Symbol.for("react.element"),In=Symbol.for("react.portal"),$n=Symbol.for("react.fragment"),nd=Symbol.for("react.strict_mode"),Pc=Symbol.for("react.profiler"),Hf=Symbol.for("react.provider"),Qf=Symbol.for("react.context"),ad=Symbol.for("react.forward_ref"),Tc=Symbol.for("react.suspense"),Rc=Symbol.for("react.suspense_list"),id=Symbol.for("react.memo"),rr=Symbol.for("react.lazy"),Gf=Symbol.for("react.offscreen"),fh=Symbol.iterator;function Oa(e){return e===null||typeof e!="object"?null:(e=fh&&e[fh]||e["@@iterator"],typeof e=="function"?e:null)}var Be=Object.assign,Bo;function za(e){if(Bo===void 0)try{throw Error()}catch(s){var t=s.stack.trim().match(/\n( *(at )?)/);Bo=t&&t[1]||""}return`
`+Bo+e}var Ko=!1;function Wo(e,t){if(!e||Ko)return"";Ko=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),i=n.stack.split(`
`),l=a.length-1,o=i.length-1;1<=l&&0<=o&&a[l]!==i[o];)o--;for(;1<=l&&0<=o;l--,o--)if(a[l]!==i[o]){if(l!==1||o!==1)do if(l--,o--,0>o||a[l]!==i[o]){var c=`
`+a[l].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=l&&0<=o);break}}}finally{Ko=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?za(e):""}function Ey(e){switch(e.tag){case 5:return za(e.type);case 16:return za("Lazy");case 13:return za("Suspense");case 19:return za("SuspenseList");case 0:case 2:case 15:return e=Wo(e.type,!1),e;case 11:return e=Wo(e.type.render,!1),e;case 1:return e=Wo(e.type,!0),e;default:return""}}function Oc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case $n:return"Fragment";case In:return"Portal";case Pc:return"Profiler";case nd:return"StrictMode";case Tc:return"Suspense";case Rc:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Qf:return(e.displayName||"Context")+".Consumer";case Hf:return(e._context.displayName||"Context")+".Provider";case ad:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case id:return t=e.displayName||null,t!==null?t:Oc(e.type)||"Memo";case rr:t=e._payload,e=e._init;try{return Oc(e(t))}catch{}}return null}function Py(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Oc(t);case 8:return t===nd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Or(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Jf(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Ty(e){var t=Jf(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var a=s.get,i=s.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(l){n=""+l,i.call(this,l)}}),Object.defineProperty(e,t,{enumerable:s.enumerable}),{getValue:function(){return n},setValue:function(l){n=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Yi(e){e._valueTracker||(e._valueTracker=Ty(e))}function Yf(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var s=t.getValue(),n="";return e&&(n=Jf(e)?e.checked?"true":"false":e.value),e=n,e!==s?(t.setValue(e),!0):!1}function Al(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ac(e,t){var s=t.checked;return Be({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??e._wrapperState.initialChecked})}function ph(e,t){var s=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;s=Or(t.value!=null?t.value:s),e._wrapperState={initialChecked:n,initialValue:s,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Xf(e,t){t=t.checked,t!=null&&rd(e,"checked",t,!1)}function Ic(e,t){Xf(e,t);var s=Or(t.value),n=t.type;if(s!=null)n==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?$c(e,t.type,s):t.hasOwnProperty("defaultValue")&&$c(e,t.type,Or(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function xh(e,t,s){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,s||t===e.value||(e.value=t),e.defaultValue=t}s=e.name,s!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,s!==""&&(e.name=s)}function $c(e,t,s){(t!=="number"||Al(e.ownerDocument)!==e)&&(s==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var Ba=Array.isArray;function Hn(e,t,s,n){if(e=e.options,t){t={};for(var a=0;a<s.length;a++)t["$"+s[a]]=!0;for(s=0;s<e.length;s++)a=t.hasOwnProperty("$"+e[s].value),e[s].selected!==a&&(e[s].selected=a),a&&n&&(e[s].defaultSelected=!0)}else{for(s=""+Or(s),t=null,a=0;a<e.length;a++){if(e[a].value===s){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function qc(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(H(91));return Be({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function gh(e,t){var s=t.value;if(s==null){if(s=t.children,t=t.defaultValue,s!=null){if(t!=null)throw Error(H(92));if(Ba(s)){if(1<s.length)throw Error(H(93));s=s[0]}t=s}t==null&&(t=""),s=t}e._wrapperState={initialValue:Or(s)}}function Zf(e,t){var s=Or(t.value),n=Or(t.defaultValue);s!=null&&(s=""+s,s!==e.value&&(e.value=s),t.defaultValue==null&&e.defaultValue!==s&&(e.defaultValue=s)),n!=null&&(e.defaultValue=""+n)}function yh(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function ep(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Mc(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?ep(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Xi,tp=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,s,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,s,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Xi=Xi||document.createElement("div"),Xi.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Xi.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function oi(e,t){if(t){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=t;return}}e.textContent=t}var Ja={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ry=["Webkit","ms","Moz","O"];Object.keys(Ja).forEach(function(e){Ry.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ja[t]=Ja[e]})});function sp(e,t,s){return t==null||typeof t=="boolean"||t===""?"":s||typeof t!="number"||t===0||Ja.hasOwnProperty(e)&&Ja[e]?(""+t).trim():t+"px"}function rp(e,t){e=e.style;for(var s in t)if(t.hasOwnProperty(s)){var n=s.indexOf("--")===0,a=sp(s,t[s],n);s==="float"&&(s="cssFloat"),n?e.setProperty(s,a):e[s]=a}}var Oy=Be({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Lc(e,t){if(t){if(Oy[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(H(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(H(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(H(61))}if(t.style!=null&&typeof t.style!="object")throw Error(H(62))}}function Dc(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Fc=null;function ld(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Uc=null,Qn=null,Gn=null;function vh(e){if(e=Ki(e)){if(typeof Uc!="function")throw Error(H(280));var t=e.stateNode;t&&(t=jo(t),Uc(e.stateNode,e.type,t))}}function np(e){Qn?Gn?Gn.push(e):Gn=[e]:Qn=e}function ap(){if(Qn){var e=Qn,t=Gn;if(Gn=Qn=null,vh(e),t)for(e=0;e<t.length;e++)vh(t[e])}}function ip(e,t){return e(t)}function lp(){}var Vo=!1;function op(e,t,s){if(Vo)return e(t,s);Vo=!0;try{return ip(e,t,s)}finally{Vo=!1,(Qn!==null||Gn!==null)&&(lp(),ap())}}function ci(e,t){var s=e.stateNode;if(s===null)return null;var n=jo(s);if(n===null)return null;s=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(H(231,t,typeof s));return s}var zc=!1;if(Vs)try{var Aa={};Object.defineProperty(Aa,"passive",{get:function(){zc=!0}}),window.addEventListener("test",Aa,Aa),window.removeEventListener("test",Aa,Aa)}catch{zc=!1}function Ay(e,t,s,n,a,i,l,o,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(s,u)}catch(d){this.onError(d)}}var Ya=!1,Il=null,$l=!1,Bc=null,Iy={onError:function(e){Ya=!0,Il=e}};function $y(e,t,s,n,a,i,l,o,c){Ya=!1,Il=null,Ay.apply(Iy,arguments)}function qy(e,t,s,n,a,i,l,o,c){if($y.apply(this,arguments),Ya){if(Ya){var u=Il;Ya=!1,Il=null}else throw Error(H(198));$l||($l=!0,Bc=u)}}function jn(e){var t=e,s=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(s=t.return),e=t.return;while(e)}return t.tag===3?s:null}function cp(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function jh(e){if(jn(e)!==e)throw Error(H(188))}function My(e){var t=e.alternate;if(!t){if(t=jn(e),t===null)throw Error(H(188));return t!==e?null:e}for(var s=e,n=t;;){var a=s.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){s=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===s)return jh(a),e;if(i===n)return jh(a),t;i=i.sibling}throw Error(H(188))}if(s.return!==n.return)s=a,n=i;else{for(var l=!1,o=a.child;o;){if(o===s){l=!0,s=a,n=i;break}if(o===n){l=!0,n=a,s=i;break}o=o.sibling}if(!l){for(o=i.child;o;){if(o===s){l=!0,s=i,n=a;break}if(o===n){l=!0,n=i,s=a;break}o=o.sibling}if(!l)throw Error(H(189))}}if(s.alternate!==n)throw Error(H(190))}if(s.tag!==3)throw Error(H(188));return s.stateNode.current===s?e:t}function up(e){return e=My(e),e!==null?dp(e):null}function dp(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=dp(e);if(t!==null)return t;e=e.sibling}return null}var hp=Gt.unstable_scheduleCallback,wh=Gt.unstable_cancelCallback,Ly=Gt.unstable_shouldYield,Dy=Gt.unstable_requestPaint,Je=Gt.unstable_now,Fy=Gt.unstable_getCurrentPriorityLevel,od=Gt.unstable_ImmediatePriority,mp=Gt.unstable_UserBlockingPriority,ql=Gt.unstable_NormalPriority,Uy=Gt.unstable_LowPriority,fp=Gt.unstable_IdlePriority,xo=null,Ps=null;function zy(e){if(Ps&&typeof Ps.onCommitFiberRoot=="function")try{Ps.onCommitFiberRoot(xo,e,void 0,(e.current.flags&128)===128)}catch{}}var gs=Math.clz32?Math.clz32:Wy,By=Math.log,Ky=Math.LN2;function Wy(e){return e>>>=0,e===0?32:31-(By(e)/Ky|0)|0}var Zi=64,el=4194304;function Ka(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ml(e,t){var s=e.pendingLanes;if(s===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,l=s&268435455;if(l!==0){var o=l&~a;o!==0?n=Ka(o):(i&=l,i!==0&&(n=Ka(i)))}else l=s&~a,l!==0?n=Ka(l):i!==0&&(n=Ka(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=s&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)s=31-gs(t),a=1<<s,n|=e[s],t&=~a;return n}function Vy(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Hy(e,t){for(var s=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var l=31-gs(i),o=1<<l,c=a[l];c===-1?(!(o&s)||o&n)&&(a[l]=Vy(o,t)):c<=t&&(e.expiredLanes|=o),i&=~o}}function Kc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function pp(){var e=Zi;return Zi<<=1,!(Zi&4194240)&&(Zi=64),e}function Ho(e){for(var t=[],s=0;31>s;s++)t.push(e);return t}function zi(e,t,s){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-gs(t),e[t]=s}function Qy(e,t){var s=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<s;){var a=31-gs(s),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,s&=~i}}function cd(e,t){var s=e.entangledLanes|=t;for(e=e.entanglements;s;){var n=31-gs(s),a=1<<n;a&t|e[n]&t&&(e[n]|=t),s&=~a}}var Te=0;function xp(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var gp,ud,yp,vp,jp,Wc=!1,tl=[],wr=null,_r=null,br=null,ui=new Map,di=new Map,ir=[],Gy="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function _h(e,t){switch(e){case"focusin":case"focusout":wr=null;break;case"dragenter":case"dragleave":_r=null;break;case"mouseover":case"mouseout":br=null;break;case"pointerover":case"pointerout":ui.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":di.delete(t.pointerId)}}function Ia(e,t,s,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:s,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=Ki(t),t!==null&&ud(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function Jy(e,t,s,n,a){switch(t){case"focusin":return wr=Ia(wr,e,t,s,n,a),!0;case"dragenter":return _r=Ia(_r,e,t,s,n,a),!0;case"mouseover":return br=Ia(br,e,t,s,n,a),!0;case"pointerover":var i=a.pointerId;return ui.set(i,Ia(ui.get(i)||null,e,t,s,n,a)),!0;case"gotpointercapture":return i=a.pointerId,di.set(i,Ia(di.get(i)||null,e,t,s,n,a)),!0}return!1}function wp(e){var t=Hr(e.target);if(t!==null){var s=jn(t);if(s!==null){if(t=s.tag,t===13){if(t=cp(s),t!==null){e.blockedOn=t,jp(e.priority,function(){yp(s)});return}}else if(t===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function _l(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var s=Vc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(s===null){s=e.nativeEvent;var n=new s.constructor(s.type,s);Fc=n,s.target.dispatchEvent(n),Fc=null}else return t=Ki(s),t!==null&&ud(t),e.blockedOn=s,!1;t.shift()}return!0}function bh(e,t,s){_l(e)&&s.delete(t)}function Yy(){Wc=!1,wr!==null&&_l(wr)&&(wr=null),_r!==null&&_l(_r)&&(_r=null),br!==null&&_l(br)&&(br=null),ui.forEach(bh),di.forEach(bh)}function $a(e,t){e.blockedOn===t&&(e.blockedOn=null,Wc||(Wc=!0,Gt.unstable_scheduleCallback(Gt.unstable_NormalPriority,Yy)))}function hi(e){function t(a){return $a(a,e)}if(0<tl.length){$a(tl[0],e);for(var s=1;s<tl.length;s++){var n=tl[s];n.blockedOn===e&&(n.blockedOn=null)}}for(wr!==null&&$a(wr,e),_r!==null&&$a(_r,e),br!==null&&$a(br,e),ui.forEach(t),di.forEach(t),s=0;s<ir.length;s++)n=ir[s],n.blockedOn===e&&(n.blockedOn=null);for(;0<ir.length&&(s=ir[0],s.blockedOn===null);)wp(s),s.blockedOn===null&&ir.shift()}var Jn=Js.ReactCurrentBatchConfig,Ll=!0;function Xy(e,t,s,n){var a=Te,i=Jn.transition;Jn.transition=null;try{Te=1,dd(e,t,s,n)}finally{Te=a,Jn.transition=i}}function Zy(e,t,s,n){var a=Te,i=Jn.transition;Jn.transition=null;try{Te=4,dd(e,t,s,n)}finally{Te=a,Jn.transition=i}}function dd(e,t,s,n){if(Ll){var a=Vc(e,t,s,n);if(a===null)rc(e,t,n,Dl,s),_h(e,n);else if(Jy(a,e,t,s,n))n.stopPropagation();else if(_h(e,n),t&4&&-1<Gy.indexOf(e)){for(;a!==null;){var i=Ki(a);if(i!==null&&gp(i),i=Vc(e,t,s,n),i===null&&rc(e,t,n,Dl,s),i===a)break;a=i}a!==null&&n.stopPropagation()}else rc(e,t,n,null,s)}}var Dl=null;function Vc(e,t,s,n){if(Dl=null,e=ld(n),e=Hr(e),e!==null)if(t=jn(e),t===null)e=null;else if(s=t.tag,s===13){if(e=cp(t),e!==null)return e;e=null}else if(s===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Dl=e,null}function _p(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Fy()){case od:return 1;case mp:return 4;case ql:case Uy:return 16;case fp:return 536870912;default:return 16}default:return 16}}var yr=null,hd=null,bl=null;function bp(){if(bl)return bl;var e,t=hd,s=t.length,n,a="value"in yr?yr.value:yr.textContent,i=a.length;for(e=0;e<s&&t[e]===a[e];e++);var l=s-e;for(n=1;n<=l&&t[s-n]===a[i-n];n++);return bl=a.slice(e,1<n?1-n:void 0)}function Nl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function sl(){return!0}function Nh(){return!1}function Yt(e){function t(s,n,a,i,l){this._reactName=s,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=l,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(s=e[o],this[o]=s?s(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?sl:Nh,this.isPropagationStopped=Nh,this}return Be(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=sl)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=sl)},persist:function(){},isPersistent:sl}),t}var Na={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},md=Yt(Na),Bi=Be({},Na,{view:0,detail:0}),ev=Yt(Bi),Qo,Go,qa,go=Be({},Bi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fd,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==qa&&(qa&&e.type==="mousemove"?(Qo=e.screenX-qa.screenX,Go=e.screenY-qa.screenY):Go=Qo=0,qa=e),Qo)},movementY:function(e){return"movementY"in e?e.movementY:Go}}),kh=Yt(go),tv=Be({},go,{dataTransfer:0}),sv=Yt(tv),rv=Be({},Bi,{relatedTarget:0}),Jo=Yt(rv),nv=Be({},Na,{animationName:0,elapsedTime:0,pseudoElement:0}),av=Yt(nv),iv=Be({},Na,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),lv=Yt(iv),ov=Be({},Na,{data:0}),Sh=Yt(ov),cv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},uv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function hv(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=dv[e])?!!t[e]:!1}function fd(){return hv}var mv=Be({},Bi,{key:function(e){if(e.key){var t=cv[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Nl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?uv[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fd,charCode:function(e){return e.type==="keypress"?Nl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Nl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),fv=Yt(mv),pv=Be({},go,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ch=Yt(pv),xv=Be({},Bi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fd}),gv=Yt(xv),yv=Be({},Na,{propertyName:0,elapsedTime:0,pseudoElement:0}),vv=Yt(yv),jv=Be({},go,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),wv=Yt(jv),_v=[9,13,27,32],pd=Vs&&"CompositionEvent"in window,Xa=null;Vs&&"documentMode"in document&&(Xa=document.documentMode);var bv=Vs&&"TextEvent"in window&&!Xa,Np=Vs&&(!pd||Xa&&8<Xa&&11>=Xa),Eh=" ",Ph=!1;function kp(e,t){switch(e){case"keyup":return _v.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Sp(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var qn=!1;function Nv(e,t){switch(e){case"compositionend":return Sp(t);case"keypress":return t.which!==32?null:(Ph=!0,Eh);case"textInput":return e=t.data,e===Eh&&Ph?null:e;default:return null}}function kv(e,t){if(qn)return e==="compositionend"||!pd&&kp(e,t)?(e=bp(),bl=hd=yr=null,qn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Np&&t.locale!=="ko"?null:t.data;default:return null}}var Sv={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Th(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Sv[e.type]:t==="textarea"}function Cp(e,t,s,n){np(n),t=Fl(t,"onChange"),0<t.length&&(s=new md("onChange","change",null,s,n),e.push({event:s,listeners:t}))}var Za=null,mi=null;function Cv(e){Lp(e,0)}function yo(e){var t=Dn(e);if(Yf(t))return e}function Ev(e,t){if(e==="change")return t}var Ep=!1;if(Vs){var Yo;if(Vs){var Xo="oninput"in document;if(!Xo){var Rh=document.createElement("div");Rh.setAttribute("oninput","return;"),Xo=typeof Rh.oninput=="function"}Yo=Xo}else Yo=!1;Ep=Yo&&(!document.documentMode||9<document.documentMode)}function Oh(){Za&&(Za.detachEvent("onpropertychange",Pp),mi=Za=null)}function Pp(e){if(e.propertyName==="value"&&yo(mi)){var t=[];Cp(t,mi,e,ld(e)),op(Cv,t)}}function Pv(e,t,s){e==="focusin"?(Oh(),Za=t,mi=s,Za.attachEvent("onpropertychange",Pp)):e==="focusout"&&Oh()}function Tv(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return yo(mi)}function Rv(e,t){if(e==="click")return yo(t)}function Ov(e,t){if(e==="input"||e==="change")return yo(t)}function Av(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var vs=typeof Object.is=="function"?Object.is:Av;function fi(e,t){if(vs(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var s=Object.keys(e),n=Object.keys(t);if(s.length!==n.length)return!1;for(n=0;n<s.length;n++){var a=s[n];if(!Ec.call(t,a)||!vs(e[a],t[a]))return!1}return!0}function Ah(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ih(e,t){var s=Ah(e);e=0;for(var n;s;){if(s.nodeType===3){if(n=e+s.textContent.length,e<=t&&n>=t)return{node:s,offset:t-e};e=n}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=Ah(s)}}function Tp(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Tp(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Rp(){for(var e=window,t=Al();t instanceof e.HTMLIFrameElement;){try{var s=typeof t.contentWindow.location.href=="string"}catch{s=!1}if(s)e=t.contentWindow;else break;t=Al(e.document)}return t}function xd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Iv(e){var t=Rp(),s=e.focusedElem,n=e.selectionRange;if(t!==s&&s&&s.ownerDocument&&Tp(s.ownerDocument.documentElement,s)){if(n!==null&&xd(s)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in s)s.selectionStart=t,s.selectionEnd=Math.min(e,s.value.length);else if(e=(t=s.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=s.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=Ih(s,i);var l=Ih(s,n);a&&l&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=s;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<t.length;s++)e=t[s],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var $v=Vs&&"documentMode"in document&&11>=document.documentMode,Mn=null,Hc=null,ei=null,Qc=!1;function $h(e,t,s){var n=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Qc||Mn==null||Mn!==Al(n)||(n=Mn,"selectionStart"in n&&xd(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),ei&&fi(ei,n)||(ei=n,n=Fl(Hc,"onSelect"),0<n.length&&(t=new md("onSelect","select",null,t,s),e.push({event:t,listeners:n}),t.target=Mn)))}function rl(e,t){var s={};return s[e.toLowerCase()]=t.toLowerCase(),s["Webkit"+e]="webkit"+t,s["Moz"+e]="moz"+t,s}var Ln={animationend:rl("Animation","AnimationEnd"),animationiteration:rl("Animation","AnimationIteration"),animationstart:rl("Animation","AnimationStart"),transitionend:rl("Transition","TransitionEnd")},Zo={},Op={};Vs&&(Op=document.createElement("div").style,"AnimationEvent"in window||(delete Ln.animationend.animation,delete Ln.animationiteration.animation,delete Ln.animationstart.animation),"TransitionEvent"in window||delete Ln.transitionend.transition);function vo(e){if(Zo[e])return Zo[e];if(!Ln[e])return e;var t=Ln[e],s;for(s in t)if(t.hasOwnProperty(s)&&s in Op)return Zo[e]=t[s];return e}var Ap=vo("animationend"),Ip=vo("animationiteration"),$p=vo("animationstart"),qp=vo("transitionend"),Mp=new Map,qh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $r(e,t){Mp.set(e,t),vn(t,[e])}for(var ec=0;ec<qh.length;ec++){var tc=qh[ec],qv=tc.toLowerCase(),Mv=tc[0].toUpperCase()+tc.slice(1);$r(qv,"on"+Mv)}$r(Ap,"onAnimationEnd");$r(Ip,"onAnimationIteration");$r($p,"onAnimationStart");$r("dblclick","onDoubleClick");$r("focusin","onFocus");$r("focusout","onBlur");$r(qp,"onTransitionEnd");fa("onMouseEnter",["mouseout","mouseover"]);fa("onMouseLeave",["mouseout","mouseover"]);fa("onPointerEnter",["pointerout","pointerover"]);fa("onPointerLeave",["pointerout","pointerover"]);vn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));vn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));vn("onBeforeInput",["compositionend","keypress","textInput","paste"]);vn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));vn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));vn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lv=new Set("cancel close invalid load scroll toggle".split(" ").concat(Wa));function Mh(e,t,s){var n=e.type||"unknown-event";e.currentTarget=s,qy(n,t,void 0,e),e.currentTarget=null}function Lp(e,t){t=(t&4)!==0;for(var s=0;s<e.length;s++){var n=e[s],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var l=n.length-1;0<=l;l--){var o=n[l],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==i&&a.isPropagationStopped())break e;Mh(a,o,u),i=c}else for(l=0;l<n.length;l++){if(o=n[l],c=o.instance,u=o.currentTarget,o=o.listener,c!==i&&a.isPropagationStopped())break e;Mh(a,o,u),i=c}}}if($l)throw e=Bc,$l=!1,Bc=null,e}function $e(e,t){var s=t[Zc];s===void 0&&(s=t[Zc]=new Set);var n=e+"__bubble";s.has(n)||(Dp(t,e,2,!1),s.add(n))}function sc(e,t,s){var n=0;t&&(n|=4),Dp(s,e,n,t)}var nl="_reactListening"+Math.random().toString(36).slice(2);function pi(e){if(!e[nl]){e[nl]=!0,Vf.forEach(function(s){s!=="selectionchange"&&(Lv.has(s)||sc(s,!1,e),sc(s,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[nl]||(t[nl]=!0,sc("selectionchange",!1,t))}}function Dp(e,t,s,n){switch(_p(t)){case 1:var a=Xy;break;case 4:a=Zy;break;default:a=dd}s=a.bind(null,t,s,e),a=void 0,!zc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,s,{capture:!0,passive:a}):e.addEventListener(t,s,!0):a!==void 0?e.addEventListener(t,s,{passive:a}):e.addEventListener(t,s,!1)}function rc(e,t,s,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var l=n.tag;if(l===3||l===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(l===4)for(l=n.return;l!==null;){var c=l.tag;if((c===3||c===4)&&(c=l.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;l=l.return}for(;o!==null;){if(l=Hr(o),l===null)return;if(c=l.tag,c===5||c===6){n=i=l;continue e}o=o.parentNode}}n=n.return}op(function(){var u=i,d=ld(s),m=[];e:{var f=Mp.get(e);if(f!==void 0){var v=md,g=e;switch(e){case"keypress":if(Nl(s)===0)break e;case"keydown":case"keyup":v=fv;break;case"focusin":g="focus",v=Jo;break;case"focusout":g="blur",v=Jo;break;case"beforeblur":case"afterblur":v=Jo;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=kh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=sv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=gv;break;case Ap:case Ip:case $p:v=av;break;case qp:v=vv;break;case"scroll":v=ev;break;case"wheel":v=wv;break;case"copy":case"cut":case"paste":v=lv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=Ch}var w=(t&4)!==0,_=!w&&e==="scroll",x=w?f!==null?f+"Capture":null:f;w=[];for(var p=u,y;p!==null;){y=p;var j=y.stateNode;if(y.tag===5&&j!==null&&(y=j,x!==null&&(j=ci(p,x),j!=null&&w.push(xi(p,j,y)))),_)break;p=p.return}0<w.length&&(f=new v(f,g,null,s,d),m.push({event:f,listeners:w}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",v=e==="mouseout"||e==="pointerout",f&&s!==Fc&&(g=s.relatedTarget||s.fromElement)&&(Hr(g)||g[Hs]))break e;if((v||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,v?(g=s.relatedTarget||s.toElement,v=u,g=g?Hr(g):null,g!==null&&(_=jn(g),g!==_||g.tag!==5&&g.tag!==6)&&(g=null)):(v=null,g=u),v!==g)){if(w=kh,j="onMouseLeave",x="onMouseEnter",p="mouse",(e==="pointerout"||e==="pointerover")&&(w=Ch,j="onPointerLeave",x="onPointerEnter",p="pointer"),_=v==null?f:Dn(v),y=g==null?f:Dn(g),f=new w(j,p+"leave",v,s,d),f.target=_,f.relatedTarget=y,j=null,Hr(d)===u&&(w=new w(x,p+"enter",g,s,d),w.target=y,w.relatedTarget=_,j=w),_=j,v&&g)t:{for(w=v,x=g,p=0,y=w;y;y=_n(y))p++;for(y=0,j=x;j;j=_n(j))y++;for(;0<p-y;)w=_n(w),p--;for(;0<y-p;)x=_n(x),y--;for(;p--;){if(w===x||x!==null&&w===x.alternate)break t;w=_n(w),x=_n(x)}w=null}else w=null;v!==null&&Lh(m,f,v,w,!1),g!==null&&_!==null&&Lh(m,_,g,w,!0)}}e:{if(f=u?Dn(u):window,v=f.nodeName&&f.nodeName.toLowerCase(),v==="select"||v==="input"&&f.type==="file")var b=Ev;else if(Th(f))if(Ep)b=Ov;else{b=Tv;var N=Pv}else(v=f.nodeName)&&v.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(b=Rv);if(b&&(b=b(e,u))){Cp(m,b,s,d);break e}N&&N(e,f,u),e==="focusout"&&(N=f._wrapperState)&&N.controlled&&f.type==="number"&&$c(f,"number",f.value)}switch(N=u?Dn(u):window,e){case"focusin":(Th(N)||N.contentEditable==="true")&&(Mn=N,Hc=u,ei=null);break;case"focusout":ei=Hc=Mn=null;break;case"mousedown":Qc=!0;break;case"contextmenu":case"mouseup":case"dragend":Qc=!1,$h(m,s,d);break;case"selectionchange":if($v)break;case"keydown":case"keyup":$h(m,s,d)}var T;if(pd)e:{switch(e){case"compositionstart":var h="onCompositionStart";break e;case"compositionend":h="onCompositionEnd";break e;case"compositionupdate":h="onCompositionUpdate";break e}h=void 0}else qn?kp(e,s)&&(h="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(h="onCompositionStart");h&&(Np&&s.locale!=="ko"&&(qn||h!=="onCompositionStart"?h==="onCompositionEnd"&&qn&&(T=bp()):(yr=d,hd="value"in yr?yr.value:yr.textContent,qn=!0)),N=Fl(u,h),0<N.length&&(h=new Sh(h,e,null,s,d),m.push({event:h,listeners:N}),T?h.data=T:(T=Sp(s),T!==null&&(h.data=T)))),(T=bv?Nv(e,s):kv(e,s))&&(u=Fl(u,"onBeforeInput"),0<u.length&&(d=new Sh("onBeforeInput","beforeinput",null,s,d),m.push({event:d,listeners:u}),d.data=T))}Lp(m,t)})}function xi(e,t,s){return{instance:e,listener:t,currentTarget:s}}function Fl(e,t){for(var s=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=ci(e,s),i!=null&&n.unshift(xi(e,i,a)),i=ci(e,t),i!=null&&n.push(xi(e,i,a))),e=e.return}return n}function _n(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Lh(e,t,s,n,a){for(var i=t._reactName,l=[];s!==null&&s!==n;){var o=s,c=o.alternate,u=o.stateNode;if(c!==null&&c===n)break;o.tag===5&&u!==null&&(o=u,a?(c=ci(s,i),c!=null&&l.unshift(xi(s,c,o))):a||(c=ci(s,i),c!=null&&l.push(xi(s,c,o)))),s=s.return}l.length!==0&&e.push({event:t,listeners:l})}var Dv=/\r\n?/g,Fv=/\u0000|\uFFFD/g;function Dh(e){return(typeof e=="string"?e:""+e).replace(Dv,`
`).replace(Fv,"")}function al(e,t,s){if(t=Dh(t),Dh(e)!==t&&s)throw Error(H(425))}function Ul(){}var Gc=null,Jc=null;function Yc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Xc=typeof setTimeout=="function"?setTimeout:void 0,Uv=typeof clearTimeout=="function"?clearTimeout:void 0,Fh=typeof Promise=="function"?Promise:void 0,zv=typeof queueMicrotask=="function"?queueMicrotask:typeof Fh<"u"?function(e){return Fh.resolve(null).then(e).catch(Bv)}:Xc;function Bv(e){setTimeout(function(){throw e})}function nc(e,t){var s=t,n=0;do{var a=s.nextSibling;if(e.removeChild(s),a&&a.nodeType===8)if(s=a.data,s==="/$"){if(n===0){e.removeChild(a),hi(t);return}n--}else s!=="$"&&s!=="$?"&&s!=="$!"||n++;s=a}while(s);hi(t)}function Nr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Uh(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(t===0)return e;t--}else s==="/$"&&t++}e=e.previousSibling}return null}var ka=Math.random().toString(36).slice(2),Es="__reactFiber$"+ka,gi="__reactProps$"+ka,Hs="__reactContainer$"+ka,Zc="__reactEvents$"+ka,Kv="__reactListeners$"+ka,Wv="__reactHandles$"+ka;function Hr(e){var t=e[Es];if(t)return t;for(var s=e.parentNode;s;){if(t=s[Hs]||s[Es]){if(s=t.alternate,t.child!==null||s!==null&&s.child!==null)for(e=Uh(e);e!==null;){if(s=e[Es])return s;e=Uh(e)}return t}e=s,s=e.parentNode}return null}function Ki(e){return e=e[Es]||e[Hs],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Dn(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(H(33))}function jo(e){return e[gi]||null}var eu=[],Fn=-1;function qr(e){return{current:e}}function qe(e){0>Fn||(e.current=eu[Fn],eu[Fn]=null,Fn--)}function Ae(e,t){Fn++,eu[Fn]=e.current,e.current=t}var Ar={},bt=qr(Ar),Lt=qr(!1),un=Ar;function pa(e,t){var s=e.type.contextTypes;if(!s)return Ar;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in s)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Dt(e){return e=e.childContextTypes,e!=null}function zl(){qe(Lt),qe(bt)}function zh(e,t,s){if(bt.current!==Ar)throw Error(H(168));Ae(bt,t),Ae(Lt,s)}function Fp(e,t,s){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return s;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(H(108,Py(e)||"Unknown",a));return Be({},s,n)}function Bl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ar,un=bt.current,Ae(bt,e),Ae(Lt,Lt.current),!0}function Bh(e,t,s){var n=e.stateNode;if(!n)throw Error(H(169));s?(e=Fp(e,t,un),n.__reactInternalMemoizedMergedChildContext=e,qe(Lt),qe(bt),Ae(bt,e)):qe(Lt),Ae(Lt,s)}var Ms=null,wo=!1,ac=!1;function Up(e){Ms===null?Ms=[e]:Ms.push(e)}function Vv(e){wo=!0,Up(e)}function Mr(){if(!ac&&Ms!==null){ac=!0;var e=0,t=Te;try{var s=Ms;for(Te=1;e<s.length;e++){var n=s[e];do n=n(!0);while(n!==null)}Ms=null,wo=!1}catch(a){throw Ms!==null&&(Ms=Ms.slice(e+1)),hp(od,Mr),a}finally{Te=t,ac=!1}}return null}var Un=[],zn=0,Kl=null,Wl=0,es=[],ts=0,dn=null,zs=1,Bs="";function zr(e,t){Un[zn++]=Wl,Un[zn++]=Kl,Kl=e,Wl=t}function zp(e,t,s){es[ts++]=zs,es[ts++]=Bs,es[ts++]=dn,dn=e;var n=zs;e=Bs;var a=32-gs(n)-1;n&=~(1<<a),s+=1;var i=32-gs(t)+a;if(30<i){var l=a-a%5;i=(n&(1<<l)-1).toString(32),n>>=l,a-=l,zs=1<<32-gs(t)+a|s<<a|n,Bs=i+e}else zs=1<<i|s<<a|n,Bs=e}function gd(e){e.return!==null&&(zr(e,1),zp(e,1,0))}function yd(e){for(;e===Kl;)Kl=Un[--zn],Un[zn]=null,Wl=Un[--zn],Un[zn]=null;for(;e===dn;)dn=es[--ts],es[ts]=null,Bs=es[--ts],es[ts]=null,zs=es[--ts],es[ts]=null}var Qt=null,Ht=null,Le=!1,xs=null;function Bp(e,t){var s=ss(5,null,null,0);s.elementType="DELETED",s.stateNode=t,s.return=e,t=e.deletions,t===null?(e.deletions=[s],e.flags|=16):t.push(s)}function Kh(e,t){switch(e.tag){case 5:var s=e.type;return t=t.nodeType!==1||s.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Qt=e,Ht=Nr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Qt=e,Ht=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(s=dn!==null?{id:zs,overflow:Bs}:null,e.memoizedState={dehydrated:t,treeContext:s,retryLane:1073741824},s=ss(18,null,null,0),s.stateNode=t,s.return=e,e.child=s,Qt=e,Ht=null,!0):!1;default:return!1}}function tu(e){return(e.mode&1)!==0&&(e.flags&128)===0}function su(e){if(Le){var t=Ht;if(t){var s=t;if(!Kh(e,t)){if(tu(e))throw Error(H(418));t=Nr(s.nextSibling);var n=Qt;t&&Kh(e,t)?Bp(n,s):(e.flags=e.flags&-4097|2,Le=!1,Qt=e)}}else{if(tu(e))throw Error(H(418));e.flags=e.flags&-4097|2,Le=!1,Qt=e}}}function Wh(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Qt=e}function il(e){if(e!==Qt)return!1;if(!Le)return Wh(e),Le=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Yc(e.type,e.memoizedProps)),t&&(t=Ht)){if(tu(e))throw Kp(),Error(H(418));for(;t;)Bp(e,t),t=Nr(t.nextSibling)}if(Wh(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(H(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var s=e.data;if(s==="/$"){if(t===0){Ht=Nr(e.nextSibling);break e}t--}else s!=="$"&&s!=="$!"&&s!=="$?"||t++}e=e.nextSibling}Ht=null}}else Ht=Qt?Nr(e.stateNode.nextSibling):null;return!0}function Kp(){for(var e=Ht;e;)e=Nr(e.nextSibling)}function xa(){Ht=Qt=null,Le=!1}function vd(e){xs===null?xs=[e]:xs.push(e)}var Hv=Js.ReactCurrentBatchConfig;function Ma(e,t,s){if(e=s.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(H(309));var n=s.stateNode}if(!n)throw Error(H(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(l){var o=a.refs;l===null?delete o[i]:o[i]=l},t._stringRef=i,t)}if(typeof e!="string")throw Error(H(284));if(!s._owner)throw Error(H(290,e))}return e}function ll(e,t){throw e=Object.prototype.toString.call(t),Error(H(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Vh(e){var t=e._init;return t(e._payload)}function Wp(e){function t(x,p){if(e){var y=x.deletions;y===null?(x.deletions=[p],x.flags|=16):y.push(p)}}function s(x,p){if(!e)return null;for(;p!==null;)t(x,p),p=p.sibling;return null}function n(x,p){for(x=new Map;p!==null;)p.key!==null?x.set(p.key,p):x.set(p.index,p),p=p.sibling;return x}function a(x,p){return x=Er(x,p),x.index=0,x.sibling=null,x}function i(x,p,y){return x.index=y,e?(y=x.alternate,y!==null?(y=y.index,y<p?(x.flags|=2,p):y):(x.flags|=2,p)):(x.flags|=1048576,p)}function l(x){return e&&x.alternate===null&&(x.flags|=2),x}function o(x,p,y,j){return p===null||p.tag!==6?(p=hc(y,x.mode,j),p.return=x,p):(p=a(p,y),p.return=x,p)}function c(x,p,y,j){var b=y.type;return b===$n?d(x,p,y.props.children,j,y.key):p!==null&&(p.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===rr&&Vh(b)===p.type)?(j=a(p,y.props),j.ref=Ma(x,p,y),j.return=x,j):(j=Rl(y.type,y.key,y.props,null,x.mode,j),j.ref=Ma(x,p,y),j.return=x,j)}function u(x,p,y,j){return p===null||p.tag!==4||p.stateNode.containerInfo!==y.containerInfo||p.stateNode.implementation!==y.implementation?(p=mc(y,x.mode,j),p.return=x,p):(p=a(p,y.children||[]),p.return=x,p)}function d(x,p,y,j,b){return p===null||p.tag!==7?(p=cn(y,x.mode,j,b),p.return=x,p):(p=a(p,y),p.return=x,p)}function m(x,p,y){if(typeof p=="string"&&p!==""||typeof p=="number")return p=hc(""+p,x.mode,y),p.return=x,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case Ji:return y=Rl(p.type,p.key,p.props,null,x.mode,y),y.ref=Ma(x,null,p),y.return=x,y;case In:return p=mc(p,x.mode,y),p.return=x,p;case rr:var j=p._init;return m(x,j(p._payload),y)}if(Ba(p)||Oa(p))return p=cn(p,x.mode,y,null),p.return=x,p;ll(x,p)}return null}function f(x,p,y,j){var b=p!==null?p.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return b!==null?null:o(x,p,""+y,j);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ji:return y.key===b?c(x,p,y,j):null;case In:return y.key===b?u(x,p,y,j):null;case rr:return b=y._init,f(x,p,b(y._payload),j)}if(Ba(y)||Oa(y))return b!==null?null:d(x,p,y,j,null);ll(x,y)}return null}function v(x,p,y,j,b){if(typeof j=="string"&&j!==""||typeof j=="number")return x=x.get(y)||null,o(p,x,""+j,b);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case Ji:return x=x.get(j.key===null?y:j.key)||null,c(p,x,j,b);case In:return x=x.get(j.key===null?y:j.key)||null,u(p,x,j,b);case rr:var N=j._init;return v(x,p,y,N(j._payload),b)}if(Ba(j)||Oa(j))return x=x.get(y)||null,d(p,x,j,b,null);ll(p,j)}return null}function g(x,p,y,j){for(var b=null,N=null,T=p,h=p=0,R=null;T!==null&&h<y.length;h++){T.index>h?(R=T,T=null):R=T.sibling;var P=f(x,T,y[h],j);if(P===null){T===null&&(T=R);break}e&&T&&P.alternate===null&&t(x,T),p=i(P,p,h),N===null?b=P:N.sibling=P,N=P,T=R}if(h===y.length)return s(x,T),Le&&zr(x,h),b;if(T===null){for(;h<y.length;h++)T=m(x,y[h],j),T!==null&&(p=i(T,p,h),N===null?b=T:N.sibling=T,N=T);return Le&&zr(x,h),b}for(T=n(x,T);h<y.length;h++)R=v(T,x,h,y[h],j),R!==null&&(e&&R.alternate!==null&&T.delete(R.key===null?h:R.key),p=i(R,p,h),N===null?b=R:N.sibling=R,N=R);return e&&T.forEach(function(U){return t(x,U)}),Le&&zr(x,h),b}function w(x,p,y,j){var b=Oa(y);if(typeof b!="function")throw Error(H(150));if(y=b.call(y),y==null)throw Error(H(151));for(var N=b=null,T=p,h=p=0,R=null,P=y.next();T!==null&&!P.done;h++,P=y.next()){T.index>h?(R=T,T=null):R=T.sibling;var U=f(x,T,P.value,j);if(U===null){T===null&&(T=R);break}e&&T&&U.alternate===null&&t(x,T),p=i(U,p,h),N===null?b=U:N.sibling=U,N=U,T=R}if(P.done)return s(x,T),Le&&zr(x,h),b;if(T===null){for(;!P.done;h++,P=y.next())P=m(x,P.value,j),P!==null&&(p=i(P,p,h),N===null?b=P:N.sibling=P,N=P);return Le&&zr(x,h),b}for(T=n(x,T);!P.done;h++,P=y.next())P=v(T,x,h,P.value,j),P!==null&&(e&&P.alternate!==null&&T.delete(P.key===null?h:P.key),p=i(P,p,h),N===null?b=P:N.sibling=P,N=P);return e&&T.forEach(function(W){return t(x,W)}),Le&&zr(x,h),b}function _(x,p,y,j){if(typeof y=="object"&&y!==null&&y.type===$n&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Ji:e:{for(var b=y.key,N=p;N!==null;){if(N.key===b){if(b=y.type,b===$n){if(N.tag===7){s(x,N.sibling),p=a(N,y.props.children),p.return=x,x=p;break e}}else if(N.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===rr&&Vh(b)===N.type){s(x,N.sibling),p=a(N,y.props),p.ref=Ma(x,N,y),p.return=x,x=p;break e}s(x,N);break}else t(x,N);N=N.sibling}y.type===$n?(p=cn(y.props.children,x.mode,j,y.key),p.return=x,x=p):(j=Rl(y.type,y.key,y.props,null,x.mode,j),j.ref=Ma(x,p,y),j.return=x,x=j)}return l(x);case In:e:{for(N=y.key;p!==null;){if(p.key===N)if(p.tag===4&&p.stateNode.containerInfo===y.containerInfo&&p.stateNode.implementation===y.implementation){s(x,p.sibling),p=a(p,y.children||[]),p.return=x,x=p;break e}else{s(x,p);break}else t(x,p);p=p.sibling}p=mc(y,x.mode,j),p.return=x,x=p}return l(x);case rr:return N=y._init,_(x,p,N(y._payload),j)}if(Ba(y))return g(x,p,y,j);if(Oa(y))return w(x,p,y,j);ll(x,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,p!==null&&p.tag===6?(s(x,p.sibling),p=a(p,y),p.return=x,x=p):(s(x,p),p=hc(y,x.mode,j),p.return=x,x=p),l(x)):s(x,p)}return _}var ga=Wp(!0),Vp=Wp(!1),Vl=qr(null),Hl=null,Bn=null,jd=null;function wd(){jd=Bn=Hl=null}function _d(e){var t=Vl.current;qe(Vl),e._currentValue=t}function ru(e,t,s){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===s)break;e=e.return}}function Yn(e,t){Hl=e,jd=Bn=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(qt=!0),e.firstContext=null)}function ns(e){var t=e._currentValue;if(jd!==e)if(e={context:e,memoizedValue:t,next:null},Bn===null){if(Hl===null)throw Error(H(308));Bn=e,Hl.dependencies={lanes:0,firstContext:e}}else Bn=Bn.next=e;return t}var Qr=null;function bd(e){Qr===null?Qr=[e]:Qr.push(e)}function Hp(e,t,s,n){var a=t.interleaved;return a===null?(s.next=s,bd(t)):(s.next=a.next,a.next=s),t.interleaved=s,Qs(e,n)}function Qs(e,t){e.lanes|=t;var s=e.alternate;for(s!==null&&(s.lanes|=t),s=e,e=e.return;e!==null;)e.childLanes|=t,s=e.alternate,s!==null&&(s.childLanes|=t),s=e,e=e.return;return s.tag===3?s.stateNode:null}var nr=!1;function Nd(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Qp(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ks(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function kr(e,t,s){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ne&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Qs(e,s)}return a=n.interleaved,a===null?(t.next=t,bd(n)):(t.next=a.next,a.next=t),n.interleaved=t,Qs(e,s)}function kl(e,t,s){if(t=t.updateQueue,t!==null&&(t=t.shared,(s&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,s|=n,t.lanes=s,cd(e,s)}}function Hh(e,t){var s=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,s===n)){var a=null,i=null;if(s=s.firstBaseUpdate,s!==null){do{var l={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};i===null?a=i=l:i=i.next=l,s=s.next}while(s!==null);i===null?a=i=t:i=i.next=t}else a=i=t;s={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=t:e.next=t,s.lastBaseUpdate=t}function Ql(e,t,s,n){var a=e.updateQueue;nr=!1;var i=a.firstBaseUpdate,l=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var c=o,u=c.next;c.next=null,l===null?i=u:l.next=u,l=c;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==l&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=c))}if(i!==null){var m=a.baseState;l=0,d=u=c=null,o=i;do{var f=o.lane,v=o.eventTime;if((n&f)===f){d!==null&&(d=d.next={eventTime:v,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=e,w=o;switch(f=t,v=s,w.tag){case 1:if(g=w.payload,typeof g=="function"){m=g.call(v,m,f);break e}m=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=w.payload,f=typeof g=="function"?g.call(v,m,f):g,f==null)break e;m=Be({},m,f);break e;case 2:nr=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,f=a.effects,f===null?a.effects=[o]:f.push(o))}else v={eventTime:v,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=v,c=m):d=d.next=v,l|=f;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;f=o,o=f.next,f.next=null,a.lastBaseUpdate=f,a.shared.pending=null}}while(!0);if(d===null&&(c=m),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=d,t=a.shared.interleaved,t!==null){a=t;do l|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);mn|=l,e.lanes=l,e.memoizedState=m}}function Qh(e,t,s){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=s,typeof a!="function")throw Error(H(191,a));a.call(n)}}}var Wi={},Ts=qr(Wi),yi=qr(Wi),vi=qr(Wi);function Gr(e){if(e===Wi)throw Error(H(174));return e}function kd(e,t){switch(Ae(vi,t),Ae(yi,e),Ae(Ts,Wi),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Mc(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Mc(t,e)}qe(Ts),Ae(Ts,t)}function ya(){qe(Ts),qe(yi),qe(vi)}function Gp(e){Gr(vi.current);var t=Gr(Ts.current),s=Mc(t,e.type);t!==s&&(Ae(yi,e),Ae(Ts,s))}function Sd(e){yi.current===e&&(qe(Ts),qe(yi))}var Ue=qr(0);function Gl(e){for(var t=e;t!==null;){if(t.tag===13){var s=t.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ic=[];function Cd(){for(var e=0;e<ic.length;e++)ic[e]._workInProgressVersionPrimary=null;ic.length=0}var Sl=Js.ReactCurrentDispatcher,lc=Js.ReactCurrentBatchConfig,hn=0,ze=null,rt=null,ct=null,Jl=!1,ti=!1,ji=0,Qv=0;function jt(){throw Error(H(321))}function Ed(e,t){if(t===null)return!1;for(var s=0;s<t.length&&s<e.length;s++)if(!vs(e[s],t[s]))return!1;return!0}function Pd(e,t,s,n,a,i){if(hn=i,ze=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Sl.current=e===null||e.memoizedState===null?Xv:Zv,e=s(n,a),ti){i=0;do{if(ti=!1,ji=0,25<=i)throw Error(H(301));i+=1,ct=rt=null,t.updateQueue=null,Sl.current=e0,e=s(n,a)}while(ti)}if(Sl.current=Yl,t=rt!==null&&rt.next!==null,hn=0,ct=rt=ze=null,Jl=!1,t)throw Error(H(300));return e}function Td(){var e=ji!==0;return ji=0,e}function Ns(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ct===null?ze.memoizedState=ct=e:ct=ct.next=e,ct}function as(){if(rt===null){var e=ze.alternate;e=e!==null?e.memoizedState:null}else e=rt.next;var t=ct===null?ze.memoizedState:ct.next;if(t!==null)ct=t,rt=e;else{if(e===null)throw Error(H(310));rt=e,e={memoizedState:rt.memoizedState,baseState:rt.baseState,baseQueue:rt.baseQueue,queue:rt.queue,next:null},ct===null?ze.memoizedState=ct=e:ct=ct.next=e}return ct}function wi(e,t){return typeof t=="function"?t(e):t}function oc(e){var t=as(),s=t.queue;if(s===null)throw Error(H(311));s.lastRenderedReducer=e;var n=rt,a=n.baseQueue,i=s.pending;if(i!==null){if(a!==null){var l=a.next;a.next=i.next,i.next=l}n.baseQueue=a=i,s.pending=null}if(a!==null){i=a.next,n=n.baseState;var o=l=null,c=null,u=i;do{var d=u.lane;if((hn&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var m={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(o=c=m,l=n):c=c.next=m,ze.lanes|=d,mn|=d}u=u.next}while(u!==null&&u!==i);c===null?l=n:c.next=o,vs(n,t.memoizedState)||(qt=!0),t.memoizedState=n,t.baseState=l,t.baseQueue=c,s.lastRenderedState=n}if(e=s.interleaved,e!==null){a=e;do i=a.lane,ze.lanes|=i,mn|=i,a=a.next;while(a!==e)}else a===null&&(s.lanes=0);return[t.memoizedState,s.dispatch]}function cc(e){var t=as(),s=t.queue;if(s===null)throw Error(H(311));s.lastRenderedReducer=e;var n=s.dispatch,a=s.pending,i=t.memoizedState;if(a!==null){s.pending=null;var l=a=a.next;do i=e(i,l.action),l=l.next;while(l!==a);vs(i,t.memoizedState)||(qt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),s.lastRenderedState=i}return[i,n]}function Jp(){}function Yp(e,t){var s=ze,n=as(),a=t(),i=!vs(n.memoizedState,a);if(i&&(n.memoizedState=a,qt=!0),n=n.queue,Rd(ex.bind(null,s,n,e),[e]),n.getSnapshot!==t||i||ct!==null&&ct.memoizedState.tag&1){if(s.flags|=2048,_i(9,Zp.bind(null,s,n,a,t),void 0,null),ut===null)throw Error(H(349));hn&30||Xp(s,t,a)}return a}function Xp(e,t,s){e.flags|=16384,e={getSnapshot:t,value:s},t=ze.updateQueue,t===null?(t={lastEffect:null,stores:null},ze.updateQueue=t,t.stores=[e]):(s=t.stores,s===null?t.stores=[e]:s.push(e))}function Zp(e,t,s,n){t.value=s,t.getSnapshot=n,tx(t)&&sx(e)}function ex(e,t,s){return s(function(){tx(t)&&sx(e)})}function tx(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!vs(e,s)}catch{return!0}}function sx(e){var t=Qs(e,1);t!==null&&ys(t,e,1,-1)}function Gh(e){var t=Ns();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wi,lastRenderedState:e},t.queue=e,e=e.dispatch=Yv.bind(null,ze,e),[t.memoizedState,e]}function _i(e,t,s,n){return e={tag:e,create:t,destroy:s,deps:n,next:null},t=ze.updateQueue,t===null?(t={lastEffect:null,stores:null},ze.updateQueue=t,t.lastEffect=e.next=e):(s=t.lastEffect,s===null?t.lastEffect=e.next=e:(n=s.next,s.next=e,e.next=n,t.lastEffect=e)),e}function rx(){return as().memoizedState}function Cl(e,t,s,n){var a=Ns();ze.flags|=e,a.memoizedState=_i(1|t,s,void 0,n===void 0?null:n)}function _o(e,t,s,n){var a=as();n=n===void 0?null:n;var i=void 0;if(rt!==null){var l=rt.memoizedState;if(i=l.destroy,n!==null&&Ed(n,l.deps)){a.memoizedState=_i(t,s,i,n);return}}ze.flags|=e,a.memoizedState=_i(1|t,s,i,n)}function Jh(e,t){return Cl(8390656,8,e,t)}function Rd(e,t){return _o(2048,8,e,t)}function nx(e,t){return _o(4,2,e,t)}function ax(e,t){return _o(4,4,e,t)}function ix(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function lx(e,t,s){return s=s!=null?s.concat([e]):null,_o(4,4,ix.bind(null,t,e),s)}function Od(){}function ox(e,t){var s=as();t=t===void 0?null:t;var n=s.memoizedState;return n!==null&&t!==null&&Ed(t,n[1])?n[0]:(s.memoizedState=[e,t],e)}function cx(e,t){var s=as();t=t===void 0?null:t;var n=s.memoizedState;return n!==null&&t!==null&&Ed(t,n[1])?n[0]:(e=e(),s.memoizedState=[e,t],e)}function ux(e,t,s){return hn&21?(vs(s,t)||(s=pp(),ze.lanes|=s,mn|=s,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,qt=!0),e.memoizedState=s)}function Gv(e,t){var s=Te;Te=s!==0&&4>s?s:4,e(!0);var n=lc.transition;lc.transition={};try{e(!1),t()}finally{Te=s,lc.transition=n}}function dx(){return as().memoizedState}function Jv(e,t,s){var n=Cr(e);if(s={lane:n,action:s,hasEagerState:!1,eagerState:null,next:null},hx(e))mx(t,s);else if(s=Hp(e,t,s,n),s!==null){var a=Pt();ys(s,e,n,a),fx(s,t,n)}}function Yv(e,t,s){var n=Cr(e),a={lane:n,action:s,hasEagerState:!1,eagerState:null,next:null};if(hx(e))mx(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var l=t.lastRenderedState,o=i(l,s);if(a.hasEagerState=!0,a.eagerState=o,vs(o,l)){var c=t.interleaved;c===null?(a.next=a,bd(t)):(a.next=c.next,c.next=a),t.interleaved=a;return}}catch{}finally{}s=Hp(e,t,a,n),s!==null&&(a=Pt(),ys(s,e,n,a),fx(s,t,n))}}function hx(e){var t=e.alternate;return e===ze||t!==null&&t===ze}function mx(e,t){ti=Jl=!0;var s=e.pending;s===null?t.next=t:(t.next=s.next,s.next=t),e.pending=t}function fx(e,t,s){if(s&4194240){var n=t.lanes;n&=e.pendingLanes,s|=n,t.lanes=s,cd(e,s)}}var Yl={readContext:ns,useCallback:jt,useContext:jt,useEffect:jt,useImperativeHandle:jt,useInsertionEffect:jt,useLayoutEffect:jt,useMemo:jt,useReducer:jt,useRef:jt,useState:jt,useDebugValue:jt,useDeferredValue:jt,useTransition:jt,useMutableSource:jt,useSyncExternalStore:jt,useId:jt,unstable_isNewReconciler:!1},Xv={readContext:ns,useCallback:function(e,t){return Ns().memoizedState=[e,t===void 0?null:t],e},useContext:ns,useEffect:Jh,useImperativeHandle:function(e,t,s){return s=s!=null?s.concat([e]):null,Cl(4194308,4,ix.bind(null,t,e),s)},useLayoutEffect:function(e,t){return Cl(4194308,4,e,t)},useInsertionEffect:function(e,t){return Cl(4,2,e,t)},useMemo:function(e,t){var s=Ns();return t=t===void 0?null:t,e=e(),s.memoizedState=[e,t],e},useReducer:function(e,t,s){var n=Ns();return t=s!==void 0?s(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Jv.bind(null,ze,e),[n.memoizedState,e]},useRef:function(e){var t=Ns();return e={current:e},t.memoizedState=e},useState:Gh,useDebugValue:Od,useDeferredValue:function(e){return Ns().memoizedState=e},useTransition:function(){var e=Gh(!1),t=e[0];return e=Gv.bind(null,e[1]),Ns().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,s){var n=ze,a=Ns();if(Le){if(s===void 0)throw Error(H(407));s=s()}else{if(s=t(),ut===null)throw Error(H(349));hn&30||Xp(n,t,s)}a.memoizedState=s;var i={value:s,getSnapshot:t};return a.queue=i,Jh(ex.bind(null,n,i,e),[e]),n.flags|=2048,_i(9,Zp.bind(null,n,i,s,t),void 0,null),s},useId:function(){var e=Ns(),t=ut.identifierPrefix;if(Le){var s=Bs,n=zs;s=(n&~(1<<32-gs(n)-1)).toString(32)+s,t=":"+t+"R"+s,s=ji++,0<s&&(t+="H"+s.toString(32)),t+=":"}else s=Qv++,t=":"+t+"r"+s.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Zv={readContext:ns,useCallback:ox,useContext:ns,useEffect:Rd,useImperativeHandle:lx,useInsertionEffect:nx,useLayoutEffect:ax,useMemo:cx,useReducer:oc,useRef:rx,useState:function(){return oc(wi)},useDebugValue:Od,useDeferredValue:function(e){var t=as();return ux(t,rt.memoizedState,e)},useTransition:function(){var e=oc(wi)[0],t=as().memoizedState;return[e,t]},useMutableSource:Jp,useSyncExternalStore:Yp,useId:dx,unstable_isNewReconciler:!1},e0={readContext:ns,useCallback:ox,useContext:ns,useEffect:Rd,useImperativeHandle:lx,useInsertionEffect:nx,useLayoutEffect:ax,useMemo:cx,useReducer:cc,useRef:rx,useState:function(){return cc(wi)},useDebugValue:Od,useDeferredValue:function(e){var t=as();return rt===null?t.memoizedState=e:ux(t,rt.memoizedState,e)},useTransition:function(){var e=cc(wi)[0],t=as().memoizedState;return[e,t]},useMutableSource:Jp,useSyncExternalStore:Yp,useId:dx,unstable_isNewReconciler:!1};function us(e,t){if(e&&e.defaultProps){t=Be({},t),e=e.defaultProps;for(var s in e)t[s]===void 0&&(t[s]=e[s]);return t}return t}function nu(e,t,s,n){t=e.memoizedState,s=s(n,t),s=s==null?t:Be({},t,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var bo={isMounted:function(e){return(e=e._reactInternals)?jn(e)===e:!1},enqueueSetState:function(e,t,s){e=e._reactInternals;var n=Pt(),a=Cr(e),i=Ks(n,a);i.payload=t,s!=null&&(i.callback=s),t=kr(e,i,a),t!==null&&(ys(t,e,a,n),kl(t,e,a))},enqueueReplaceState:function(e,t,s){e=e._reactInternals;var n=Pt(),a=Cr(e),i=Ks(n,a);i.tag=1,i.payload=t,s!=null&&(i.callback=s),t=kr(e,i,a),t!==null&&(ys(t,e,a,n),kl(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var s=Pt(),n=Cr(e),a=Ks(s,n);a.tag=2,t!=null&&(a.callback=t),t=kr(e,a,n),t!==null&&(ys(t,e,n,s),kl(t,e,n))}};function Yh(e,t,s,n,a,i,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,l):t.prototype&&t.prototype.isPureReactComponent?!fi(s,n)||!fi(a,i):!0}function px(e,t,s){var n=!1,a=Ar,i=t.contextType;return typeof i=="object"&&i!==null?i=ns(i):(a=Dt(t)?un:bt.current,n=t.contextTypes,i=(n=n!=null)?pa(e,a):Ar),t=new t(s,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=bo,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function Xh(e,t,s,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(s,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(s,n),t.state!==e&&bo.enqueueReplaceState(t,t.state,null)}function au(e,t,s,n){var a=e.stateNode;a.props=s,a.state=e.memoizedState,a.refs={},Nd(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=ns(i):(i=Dt(t)?un:bt.current,a.context=pa(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(nu(e,t,i,s),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&bo.enqueueReplaceState(a,a.state,null),Ql(e,s,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function va(e,t){try{var s="",n=t;do s+=Ey(n),n=n.return;while(n);var a=s}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function uc(e,t,s){return{value:e,source:null,stack:s??null,digest:t??null}}function iu(e,t){try{console.error(t.value)}catch(s){setTimeout(function(){throw s})}}var t0=typeof WeakMap=="function"?WeakMap:Map;function xx(e,t,s){s=Ks(-1,s),s.tag=3,s.payload={element:null};var n=t.value;return s.callback=function(){Zl||(Zl=!0,xu=n),iu(e,t)},s}function gx(e,t,s){s=Ks(-1,s),s.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;s.payload=function(){return n(a)},s.callback=function(){iu(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(s.callback=function(){iu(e,t),typeof n!="function"&&(Sr===null?Sr=new Set([this]):Sr.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),s}function Zh(e,t,s){var n=e.pingCache;if(n===null){n=e.pingCache=new t0;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(s)||(a.add(s),e=p0.bind(null,e,t,s),t.then(e,e))}function em(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function tm(e,t,s,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(t=Ks(-1,1),t.tag=2,kr(s,t,1))),s.lanes|=1),e)}var s0=Js.ReactCurrentOwner,qt=!1;function Ct(e,t,s,n){t.child=e===null?Vp(t,null,s,n):ga(t,e.child,s,n)}function sm(e,t,s,n,a){s=s.render;var i=t.ref;return Yn(t,a),n=Pd(e,t,s,n,i,a),s=Td(),e!==null&&!qt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Gs(e,t,a)):(Le&&s&&gd(t),t.flags|=1,Ct(e,t,n,a),t.child)}function rm(e,t,s,n,a){if(e===null){var i=s.type;return typeof i=="function"&&!Fd(i)&&i.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(t.tag=15,t.type=i,yx(e,t,i,n,a)):(e=Rl(s.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var l=i.memoizedProps;if(s=s.compare,s=s!==null?s:fi,s(l,n)&&e.ref===t.ref)return Gs(e,t,a)}return t.flags|=1,e=Er(i,n),e.ref=t.ref,e.return=t,t.child=e}function yx(e,t,s,n,a){if(e!==null){var i=e.memoizedProps;if(fi(i,n)&&e.ref===t.ref)if(qt=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(qt=!0);else return t.lanes=e.lanes,Gs(e,t,a)}return lu(e,t,s,n,a)}function vx(e,t,s){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ae(Wn,Kt),Kt|=s;else{if(!(s&1073741824))return e=i!==null?i.baseLanes|s:s,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ae(Wn,Kt),Kt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:s,Ae(Wn,Kt),Kt|=n}else i!==null?(n=i.baseLanes|s,t.memoizedState=null):n=s,Ae(Wn,Kt),Kt|=n;return Ct(e,t,a,s),t.child}function jx(e,t){var s=t.ref;(e===null&&s!==null||e!==null&&e.ref!==s)&&(t.flags|=512,t.flags|=2097152)}function lu(e,t,s,n,a){var i=Dt(s)?un:bt.current;return i=pa(t,i),Yn(t,a),s=Pd(e,t,s,n,i,a),n=Td(),e!==null&&!qt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Gs(e,t,a)):(Le&&n&&gd(t),t.flags|=1,Ct(e,t,s,a),t.child)}function nm(e,t,s,n,a){if(Dt(s)){var i=!0;Bl(t)}else i=!1;if(Yn(t,a),t.stateNode===null)El(e,t),px(t,s,n),au(t,s,n,a),n=!0;else if(e===null){var l=t.stateNode,o=t.memoizedProps;l.props=o;var c=l.context,u=s.contextType;typeof u=="object"&&u!==null?u=ns(u):(u=Dt(s)?un:bt.current,u=pa(t,u));var d=s.getDerivedStateFromProps,m=typeof d=="function"||typeof l.getSnapshotBeforeUpdate=="function";m||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==n||c!==u)&&Xh(t,l,n,u),nr=!1;var f=t.memoizedState;l.state=f,Ql(t,n,l,a),c=t.memoizedState,o!==n||f!==c||Lt.current||nr?(typeof d=="function"&&(nu(t,s,d,n),c=t.memoizedState),(o=nr||Yh(t,s,o,n,f,c,u))?(m||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),l.props=n,l.state=c,l.context=u,n=o):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{l=t.stateNode,Qp(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:us(t.type,o),l.props=u,m=t.pendingProps,f=l.context,c=s.contextType,typeof c=="object"&&c!==null?c=ns(c):(c=Dt(s)?un:bt.current,c=pa(t,c));var v=s.getDerivedStateFromProps;(d=typeof v=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==m||f!==c)&&Xh(t,l,n,c),nr=!1,f=t.memoizedState,l.state=f,Ql(t,n,l,a);var g=t.memoizedState;o!==m||f!==g||Lt.current||nr?(typeof v=="function"&&(nu(t,s,v,n),g=t.memoizedState),(u=nr||Yh(t,s,u,n,f,g,c)||!1)?(d||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(n,g,c),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(n,g,c)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),l.props=n,l.state=g,l.context=c,n=u):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),n=!1)}return ou(e,t,s,n,i,a)}function ou(e,t,s,n,a,i){jx(e,t);var l=(t.flags&128)!==0;if(!n&&!l)return a&&Bh(t,s,!1),Gs(e,t,i);n=t.stateNode,s0.current=t;var o=l&&typeof s.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&l?(t.child=ga(t,e.child,null,i),t.child=ga(t,null,o,i)):Ct(e,t,o,i),t.memoizedState=n.state,a&&Bh(t,s,!0),t.child}function wx(e){var t=e.stateNode;t.pendingContext?zh(e,t.pendingContext,t.pendingContext!==t.context):t.context&&zh(e,t.context,!1),kd(e,t.containerInfo)}function am(e,t,s,n,a){return xa(),vd(a),t.flags|=256,Ct(e,t,s,n),t.child}var cu={dehydrated:null,treeContext:null,retryLane:0};function uu(e){return{baseLanes:e,cachePool:null,transitions:null}}function _x(e,t,s){var n=t.pendingProps,a=Ue.current,i=!1,l=(t.flags&128)!==0,o;if((o=l)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Ae(Ue,a&1),e===null)return su(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=n.children,e=n.fallback,i?(n=t.mode,i=t.child,l={mode:"hidden",children:l},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=l):i=So(l,n,0,null),e=cn(e,n,s,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=uu(s),t.memoizedState=cu,e):Ad(t,l));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return r0(e,t,l,n,o,a,s);if(i){i=n.fallback,l=t.mode,a=e.child,o=a.sibling;var c={mode:"hidden",children:n.children};return!(l&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Er(a,c),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?i=Er(o,i):(i=cn(i,l,s,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,l=e.child.memoizedState,l=l===null?uu(s):{baseLanes:l.baseLanes|s,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~s,t.memoizedState=cu,n}return i=e.child,e=i.sibling,n=Er(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=s),n.return=t,n.sibling=null,e!==null&&(s=t.deletions,s===null?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=n,t.memoizedState=null,n}function Ad(e,t){return t=So({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function ol(e,t,s,n){return n!==null&&vd(n),ga(t,e.child,null,s),e=Ad(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function r0(e,t,s,n,a,i,l){if(s)return t.flags&256?(t.flags&=-257,n=uc(Error(H(422))),ol(e,t,l,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=So({mode:"visible",children:n.children},a,0,null),i=cn(i,a,l,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&ga(t,e.child,null,l),t.child.memoizedState=uu(l),t.memoizedState=cu,i);if(!(t.mode&1))return ol(e,t,l,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(H(419)),n=uc(i,n,void 0),ol(e,t,l,n)}if(o=(l&e.childLanes)!==0,qt||o){if(n=ut,n!==null){switch(l&-l){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|l)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,Qs(e,a),ys(n,e,a,-1))}return Dd(),n=uc(Error(H(421))),ol(e,t,l,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=x0.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,Ht=Nr(a.nextSibling),Qt=t,Le=!0,xs=null,e!==null&&(es[ts++]=zs,es[ts++]=Bs,es[ts++]=dn,zs=e.id,Bs=e.overflow,dn=t),t=Ad(t,n.children),t.flags|=4096,t)}function im(e,t,s){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),ru(e.return,t,s)}function dc(e,t,s,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:s,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=s,i.tailMode=a)}function bx(e,t,s){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(Ct(e,t,n.children,s),n=Ue.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&im(e,s,t);else if(e.tag===19)im(e,s,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Ae(Ue,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(s=t.child,a=null;s!==null;)e=s.alternate,e!==null&&Gl(e)===null&&(a=s),s=s.sibling;s=a,s===null?(a=t.child,t.child=null):(a=s.sibling,s.sibling=null),dc(t,!1,a,s,i);break;case"backwards":for(s=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Gl(e)===null){t.child=a;break}e=a.sibling,a.sibling=s,s=a,a=e}dc(t,!0,s,null,i);break;case"together":dc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function El(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Gs(e,t,s){if(e!==null&&(t.dependencies=e.dependencies),mn|=t.lanes,!(s&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(H(153));if(t.child!==null){for(e=t.child,s=Er(e,e.pendingProps),t.child=s,s.return=t;e.sibling!==null;)e=e.sibling,s=s.sibling=Er(e,e.pendingProps),s.return=t;s.sibling=null}return t.child}function n0(e,t,s){switch(t.tag){case 3:wx(t),xa();break;case 5:Gp(t);break;case 1:Dt(t.type)&&Bl(t);break;case 4:kd(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Ae(Vl,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Ae(Ue,Ue.current&1),t.flags|=128,null):s&t.child.childLanes?_x(e,t,s):(Ae(Ue,Ue.current&1),e=Gs(e,t,s),e!==null?e.sibling:null);Ae(Ue,Ue.current&1);break;case 19:if(n=(s&t.childLanes)!==0,e.flags&128){if(n)return bx(e,t,s);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ae(Ue,Ue.current),n)break;return null;case 22:case 23:return t.lanes=0,vx(e,t,s)}return Gs(e,t,s)}var Nx,du,kx,Sx;Nx=function(e,t){for(var s=t.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};du=function(){};kx=function(e,t,s,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Gr(Ts.current);var i=null;switch(s){case"input":a=Ac(e,a),n=Ac(e,n),i=[];break;case"select":a=Be({},a,{value:void 0}),n=Be({},n,{value:void 0}),i=[];break;case"textarea":a=qc(e,a),n=qc(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Ul)}Lc(s,n);var l;s=null;for(u in a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var o=a[u];for(l in o)o.hasOwnProperty(l)&&(s||(s={}),s[l]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(li.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in n){var c=n[u];if(o=a!=null?a[u]:void 0,n.hasOwnProperty(u)&&c!==o&&(c!=null||o!=null))if(u==="style")if(o){for(l in o)!o.hasOwnProperty(l)||c&&c.hasOwnProperty(l)||(s||(s={}),s[l]="");for(l in c)c.hasOwnProperty(l)&&o[l]!==c[l]&&(s||(s={}),s[l]=c[l])}else s||(i||(i=[]),i.push(u,s)),s=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(li.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&$e("scroll",e),i||o===c||(i=[])):(i=i||[]).push(u,c))}s&&(i=i||[]).push("style",s);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};Sx=function(e,t,s,n){s!==n&&(t.flags|=4)};function La(e,t){if(!Le)switch(e.tailMode){case"hidden":t=e.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var n=null;s!==null;)s.alternate!==null&&(n=s),s=s.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function wt(e){var t=e.alternate!==null&&e.alternate.child===e.child,s=0,n=0;if(t)for(var a=e.child;a!==null;)s|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)s|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=s,t}function a0(e,t,s){var n=t.pendingProps;switch(yd(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return wt(t),null;case 1:return Dt(t.type)&&zl(),wt(t),null;case 3:return n=t.stateNode,ya(),qe(Lt),qe(bt),Cd(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(il(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,xs!==null&&(vu(xs),xs=null))),du(e,t),wt(t),null;case 5:Sd(t);var a=Gr(vi.current);if(s=t.type,e!==null&&t.stateNode!=null)kx(e,t,s,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(H(166));return wt(t),null}if(e=Gr(Ts.current),il(t)){n=t.stateNode,s=t.type;var i=t.memoizedProps;switch(n[Es]=t,n[gi]=i,e=(t.mode&1)!==0,s){case"dialog":$e("cancel",n),$e("close",n);break;case"iframe":case"object":case"embed":$e("load",n);break;case"video":case"audio":for(a=0;a<Wa.length;a++)$e(Wa[a],n);break;case"source":$e("error",n);break;case"img":case"image":case"link":$e("error",n),$e("load",n);break;case"details":$e("toggle",n);break;case"input":ph(n,i),$e("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},$e("invalid",n);break;case"textarea":gh(n,i),$e("invalid",n)}Lc(s,i),a=null;for(var l in i)if(i.hasOwnProperty(l)){var o=i[l];l==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&al(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&al(n.textContent,o,e),a=["children",""+o]):li.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&$e("scroll",n)}switch(s){case"input":Yi(n),xh(n,i,!0);break;case"textarea":Yi(n),yh(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Ul)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{l=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=ep(s)),e==="http://www.w3.org/1999/xhtml"?s==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=l.createElement(s,{is:n.is}):(e=l.createElement(s),s==="select"&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,s),e[Es]=t,e[gi]=n,Nx(e,t,!1,!1),t.stateNode=e;e:{switch(l=Dc(s,n),s){case"dialog":$e("cancel",e),$e("close",e),a=n;break;case"iframe":case"object":case"embed":$e("load",e),a=n;break;case"video":case"audio":for(a=0;a<Wa.length;a++)$e(Wa[a],e);a=n;break;case"source":$e("error",e),a=n;break;case"img":case"image":case"link":$e("error",e),$e("load",e),a=n;break;case"details":$e("toggle",e),a=n;break;case"input":ph(e,n),a=Ac(e,n),$e("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Be({},n,{value:void 0}),$e("invalid",e);break;case"textarea":gh(e,n),a=qc(e,n),$e("invalid",e);break;default:a=n}Lc(s,a),o=a;for(i in o)if(o.hasOwnProperty(i)){var c=o[i];i==="style"?rp(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&tp(e,c)):i==="children"?typeof c=="string"?(s!=="textarea"||c!=="")&&oi(e,c):typeof c=="number"&&oi(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(li.hasOwnProperty(i)?c!=null&&i==="onScroll"&&$e("scroll",e):c!=null&&rd(e,i,c,l))}switch(s){case"input":Yi(e),xh(e,n,!1);break;case"textarea":Yi(e),yh(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Or(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Hn(e,!!n.multiple,i,!1):n.defaultValue!=null&&Hn(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Ul)}switch(s){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return wt(t),null;case 6:if(e&&t.stateNode!=null)Sx(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(H(166));if(s=Gr(vi.current),Gr(Ts.current),il(t)){if(n=t.stateNode,s=t.memoizedProps,n[Es]=t,(i=n.nodeValue!==s)&&(e=Qt,e!==null))switch(e.tag){case 3:al(n.nodeValue,s,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&al(n.nodeValue,s,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(s.nodeType===9?s:s.ownerDocument).createTextNode(n),n[Es]=t,t.stateNode=n}return wt(t),null;case 13:if(qe(Ue),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Le&&Ht!==null&&t.mode&1&&!(t.flags&128))Kp(),xa(),t.flags|=98560,i=!1;else if(i=il(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(H(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(H(317));i[Es]=t}else xa(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;wt(t),i=!1}else xs!==null&&(vu(xs),xs=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=s,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Ue.current&1?at===0&&(at=3):Dd())),t.updateQueue!==null&&(t.flags|=4),wt(t),null);case 4:return ya(),du(e,t),e===null&&pi(t.stateNode.containerInfo),wt(t),null;case 10:return _d(t.type._context),wt(t),null;case 17:return Dt(t.type)&&zl(),wt(t),null;case 19:if(qe(Ue),i=t.memoizedState,i===null)return wt(t),null;if(n=(t.flags&128)!==0,l=i.rendering,l===null)if(n)La(i,!1);else{if(at!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=Gl(e),l!==null){for(t.flags|=128,La(i,!1),n=l.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=s,s=t.child;s!==null;)i=s,e=n,i.flags&=14680066,l=i.alternate,l===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return Ae(Ue,Ue.current&1|2),t.child}e=e.sibling}i.tail!==null&&Je()>ja&&(t.flags|=128,n=!0,La(i,!1),t.lanes=4194304)}else{if(!n)if(e=Gl(l),e!==null){if(t.flags|=128,n=!0,s=e.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),La(i,!0),i.tail===null&&i.tailMode==="hidden"&&!l.alternate&&!Le)return wt(t),null}else 2*Je()-i.renderingStartTime>ja&&s!==1073741824&&(t.flags|=128,n=!0,La(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(s=i.last,s!==null?s.sibling=l:t.child=l,i.last=l)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Je(),t.sibling=null,s=Ue.current,Ae(Ue,n?s&1|2:s&1),t):(wt(t),null);case 22:case 23:return Ld(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Kt&1073741824&&(wt(t),t.subtreeFlags&6&&(t.flags|=8192)):wt(t),null;case 24:return null;case 25:return null}throw Error(H(156,t.tag))}function i0(e,t){switch(yd(t),t.tag){case 1:return Dt(t.type)&&zl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ya(),qe(Lt),qe(bt),Cd(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Sd(t),null;case 13:if(qe(Ue),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(H(340));xa()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return qe(Ue),null;case 4:return ya(),null;case 10:return _d(t.type._context),null;case 22:case 23:return Ld(),null;case 24:return null;default:return null}}var cl=!1,_t=!1,l0=typeof WeakSet=="function"?WeakSet:Set,te=null;function Kn(e,t){var s=e.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(n){Qe(e,t,n)}else s.current=null}function hu(e,t,s){try{s()}catch(n){Qe(e,t,n)}}var lm=!1;function o0(e,t){if(Gc=Ll,e=Rp(),xd(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{s=(s=e.ownerDocument)&&s.defaultView||window;var n=s.getSelection&&s.getSelection();if(n&&n.rangeCount!==0){s=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{s.nodeType,i.nodeType}catch{s=null;break e}var l=0,o=-1,c=-1,u=0,d=0,m=e,f=null;t:for(;;){for(var v;m!==s||a!==0&&m.nodeType!==3||(o=l+a),m!==i||n!==0&&m.nodeType!==3||(c=l+n),m.nodeType===3&&(l+=m.nodeValue.length),(v=m.firstChild)!==null;)f=m,m=v;for(;;){if(m===e)break t;if(f===s&&++u===a&&(o=l),f===i&&++d===n&&(c=l),(v=m.nextSibling)!==null)break;m=f,f=m.parentNode}m=v}s=o===-1||c===-1?null:{start:o,end:c}}else s=null}s=s||{start:0,end:0}}else s=null;for(Jc={focusedElem:e,selectionRange:s},Ll=!1,te=t;te!==null;)if(t=te,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,te=e;else for(;te!==null;){t=te;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var w=g.memoizedProps,_=g.memoizedState,x=t.stateNode,p=x.getSnapshotBeforeUpdate(t.elementType===t.type?w:us(t.type,w),_);x.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(H(163))}}catch(j){Qe(t,t.return,j)}if(e=t.sibling,e!==null){e.return=t.return,te=e;break}te=t.return}return g=lm,lm=!1,g}function si(e,t,s){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&hu(t,s,i)}a=a.next}while(a!==n)}}function No(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var s=t=t.next;do{if((s.tag&e)===e){var n=s.create;s.destroy=n()}s=s.next}while(s!==t)}}function mu(e){var t=e.ref;if(t!==null){var s=e.stateNode;switch(e.tag){case 5:e=s;break;default:e=s}typeof t=="function"?t(e):t.current=e}}function Cx(e){var t=e.alternate;t!==null&&(e.alternate=null,Cx(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Es],delete t[gi],delete t[Zc],delete t[Kv],delete t[Wv])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Ex(e){return e.tag===5||e.tag===3||e.tag===4}function om(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Ex(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function fu(e,t,s){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?s.nodeType===8?s.parentNode.insertBefore(e,t):s.insertBefore(e,t):(s.nodeType===8?(t=s.parentNode,t.insertBefore(e,s)):(t=s,t.appendChild(e)),s=s._reactRootContainer,s!=null||t.onclick!==null||(t.onclick=Ul));else if(n!==4&&(e=e.child,e!==null))for(fu(e,t,s),e=e.sibling;e!==null;)fu(e,t,s),e=e.sibling}function pu(e,t,s){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?s.insertBefore(e,t):s.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(pu(e,t,s),e=e.sibling;e!==null;)pu(e,t,s),e=e.sibling}var pt=null,fs=!1;function Zs(e,t,s){for(s=s.child;s!==null;)Px(e,t,s),s=s.sibling}function Px(e,t,s){if(Ps&&typeof Ps.onCommitFiberUnmount=="function")try{Ps.onCommitFiberUnmount(xo,s)}catch{}switch(s.tag){case 5:_t||Kn(s,t);case 6:var n=pt,a=fs;pt=null,Zs(e,t,s),pt=n,fs=a,pt!==null&&(fs?(e=pt,s=s.stateNode,e.nodeType===8?e.parentNode.removeChild(s):e.removeChild(s)):pt.removeChild(s.stateNode));break;case 18:pt!==null&&(fs?(e=pt,s=s.stateNode,e.nodeType===8?nc(e.parentNode,s):e.nodeType===1&&nc(e,s),hi(e)):nc(pt,s.stateNode));break;case 4:n=pt,a=fs,pt=s.stateNode.containerInfo,fs=!0,Zs(e,t,s),pt=n,fs=a;break;case 0:case 11:case 14:case 15:if(!_t&&(n=s.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,l=i.destroy;i=i.tag,l!==void 0&&(i&2||i&4)&&hu(s,t,l),a=a.next}while(a!==n)}Zs(e,t,s);break;case 1:if(!_t&&(Kn(s,t),n=s.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=s.memoizedProps,n.state=s.memoizedState,n.componentWillUnmount()}catch(o){Qe(s,t,o)}Zs(e,t,s);break;case 21:Zs(e,t,s);break;case 22:s.mode&1?(_t=(n=_t)||s.memoizedState!==null,Zs(e,t,s),_t=n):Zs(e,t,s);break;default:Zs(e,t,s)}}function cm(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var s=e.stateNode;s===null&&(s=e.stateNode=new l0),t.forEach(function(n){var a=g0.bind(null,e,n);s.has(n)||(s.add(n),n.then(a,a))})}}function os(e,t){var s=t.deletions;if(s!==null)for(var n=0;n<s.length;n++){var a=s[n];try{var i=e,l=t,o=l;e:for(;o!==null;){switch(o.tag){case 5:pt=o.stateNode,fs=!1;break e;case 3:pt=o.stateNode.containerInfo,fs=!0;break e;case 4:pt=o.stateNode.containerInfo,fs=!0;break e}o=o.return}if(pt===null)throw Error(H(160));Px(i,l,a),pt=null,fs=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(u){Qe(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Tx(t,e),t=t.sibling}function Tx(e,t){var s=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(os(t,e),bs(e),n&4){try{si(3,e,e.return),No(3,e)}catch(w){Qe(e,e.return,w)}try{si(5,e,e.return)}catch(w){Qe(e,e.return,w)}}break;case 1:os(t,e),bs(e),n&512&&s!==null&&Kn(s,s.return);break;case 5:if(os(t,e),bs(e),n&512&&s!==null&&Kn(s,s.return),e.flags&32){var a=e.stateNode;try{oi(a,"")}catch(w){Qe(e,e.return,w)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,l=s!==null?s.memoizedProps:i,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&Xf(a,i),Dc(o,l);var u=Dc(o,i);for(l=0;l<c.length;l+=2){var d=c[l],m=c[l+1];d==="style"?rp(a,m):d==="dangerouslySetInnerHTML"?tp(a,m):d==="children"?oi(a,m):rd(a,d,m,u)}switch(o){case"input":Ic(a,i);break;case"textarea":Zf(a,i);break;case"select":var f=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var v=i.value;v!=null?Hn(a,!!i.multiple,v,!1):f!==!!i.multiple&&(i.defaultValue!=null?Hn(a,!!i.multiple,i.defaultValue,!0):Hn(a,!!i.multiple,i.multiple?[]:"",!1))}a[gi]=i}catch(w){Qe(e,e.return,w)}}break;case 6:if(os(t,e),bs(e),n&4){if(e.stateNode===null)throw Error(H(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(w){Qe(e,e.return,w)}}break;case 3:if(os(t,e),bs(e),n&4&&s!==null&&s.memoizedState.isDehydrated)try{hi(t.containerInfo)}catch(w){Qe(e,e.return,w)}break;case 4:os(t,e),bs(e);break;case 13:os(t,e),bs(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(qd=Je())),n&4&&cm(e);break;case 22:if(d=s!==null&&s.memoizedState!==null,e.mode&1?(_t=(u=_t)||d,os(t,e),_t=u):os(t,e),bs(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(te=e,d=e.child;d!==null;){for(m=te=d;te!==null;){switch(f=te,v=f.child,f.tag){case 0:case 11:case 14:case 15:si(4,f,f.return);break;case 1:Kn(f,f.return);var g=f.stateNode;if(typeof g.componentWillUnmount=="function"){n=f,s=f.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(w){Qe(n,s,w)}}break;case 5:Kn(f,f.return);break;case 22:if(f.memoizedState!==null){dm(m);continue}}v!==null?(v.return=f,te=v):dm(m)}d=d.sibling}e:for(d=null,m=e;;){if(m.tag===5){if(d===null){d=m;try{a=m.stateNode,u?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=m.stateNode,c=m.memoizedProps.style,l=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=sp("display",l))}catch(w){Qe(e,e.return,w)}}}else if(m.tag===6){if(d===null)try{m.stateNode.nodeValue=u?"":m.memoizedProps}catch(w){Qe(e,e.return,w)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===e)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;m.sibling===null;){if(m.return===null||m.return===e)break e;d===m&&(d=null),m=m.return}d===m&&(d=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:os(t,e),bs(e),n&4&&cm(e);break;case 21:break;default:os(t,e),bs(e)}}function bs(e){var t=e.flags;if(t&2){try{e:{for(var s=e.return;s!==null;){if(Ex(s)){var n=s;break e}s=s.return}throw Error(H(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(oi(a,""),n.flags&=-33);var i=om(e);pu(e,i,a);break;case 3:case 4:var l=n.stateNode.containerInfo,o=om(e);fu(e,o,l);break;default:throw Error(H(161))}}catch(c){Qe(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function c0(e,t,s){te=e,Rx(e)}function Rx(e,t,s){for(var n=(e.mode&1)!==0;te!==null;){var a=te,i=a.child;if(a.tag===22&&n){var l=a.memoizedState!==null||cl;if(!l){var o=a.alternate,c=o!==null&&o.memoizedState!==null||_t;o=cl;var u=_t;if(cl=l,(_t=c)&&!u)for(te=a;te!==null;)l=te,c=l.child,l.tag===22&&l.memoizedState!==null?hm(a):c!==null?(c.return=l,te=c):hm(a);for(;i!==null;)te=i,Rx(i),i=i.sibling;te=a,cl=o,_t=u}um(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,te=i):um(e)}}function um(e){for(;te!==null;){var t=te;if(t.flags&8772){var s=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:_t||No(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!_t)if(s===null)n.componentDidMount();else{var a=t.elementType===t.type?s.memoizedProps:us(t.type,s.memoizedProps);n.componentDidUpdate(a,s.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Qh(t,i,n);break;case 3:var l=t.updateQueue;if(l!==null){if(s=null,t.child!==null)switch(t.child.tag){case 5:s=t.child.stateNode;break;case 1:s=t.child.stateNode}Qh(t,l,s)}break;case 5:var o=t.stateNode;if(s===null&&t.flags&4){s=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&s.focus();break;case"img":c.src&&(s.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var m=d.dehydrated;m!==null&&hi(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(H(163))}_t||t.flags&512&&mu(t)}catch(f){Qe(t,t.return,f)}}if(t===e){te=null;break}if(s=t.sibling,s!==null){s.return=t.return,te=s;break}te=t.return}}function dm(e){for(;te!==null;){var t=te;if(t===e){te=null;break}var s=t.sibling;if(s!==null){s.return=t.return,te=s;break}te=t.return}}function hm(e){for(;te!==null;){var t=te;try{switch(t.tag){case 0:case 11:case 15:var s=t.return;try{No(4,t)}catch(c){Qe(t,s,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(c){Qe(t,a,c)}}var i=t.return;try{mu(t)}catch(c){Qe(t,i,c)}break;case 5:var l=t.return;try{mu(t)}catch(c){Qe(t,l,c)}}}catch(c){Qe(t,t.return,c)}if(t===e){te=null;break}var o=t.sibling;if(o!==null){o.return=t.return,te=o;break}te=t.return}}var u0=Math.ceil,Xl=Js.ReactCurrentDispatcher,Id=Js.ReactCurrentOwner,rs=Js.ReactCurrentBatchConfig,Ne=0,ut=null,Ze=null,xt=0,Kt=0,Wn=qr(0),at=0,bi=null,mn=0,ko=0,$d=0,ri=null,$t=null,qd=0,ja=1/0,$s=null,Zl=!1,xu=null,Sr=null,ul=!1,vr=null,eo=0,ni=0,gu=null,Pl=-1,Tl=0;function Pt(){return Ne&6?Je():Pl!==-1?Pl:Pl=Je()}function Cr(e){return e.mode&1?Ne&2&&xt!==0?xt&-xt:Hv.transition!==null?(Tl===0&&(Tl=pp()),Tl):(e=Te,e!==0||(e=window.event,e=e===void 0?16:_p(e.type)),e):1}function ys(e,t,s,n){if(50<ni)throw ni=0,gu=null,Error(H(185));zi(e,s,n),(!(Ne&2)||e!==ut)&&(e===ut&&(!(Ne&2)&&(ko|=s),at===4&&lr(e,xt)),Ft(e,n),s===1&&Ne===0&&!(t.mode&1)&&(ja=Je()+500,wo&&Mr()))}function Ft(e,t){var s=e.callbackNode;Hy(e,t);var n=Ml(e,e===ut?xt:0);if(n===0)s!==null&&wh(s),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(s!=null&&wh(s),t===1)e.tag===0?Vv(mm.bind(null,e)):Up(mm.bind(null,e)),zv(function(){!(Ne&6)&&Mr()}),s=null;else{switch(xp(n)){case 1:s=od;break;case 4:s=mp;break;case 16:s=ql;break;case 536870912:s=fp;break;default:s=ql}s=Dx(s,Ox.bind(null,e))}e.callbackPriority=t,e.callbackNode=s}}function Ox(e,t){if(Pl=-1,Tl=0,Ne&6)throw Error(H(327));var s=e.callbackNode;if(Xn()&&e.callbackNode!==s)return null;var n=Ml(e,e===ut?xt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=to(e,n);else{t=n;var a=Ne;Ne|=2;var i=Ix();(ut!==e||xt!==t)&&($s=null,ja=Je()+500,on(e,t));do try{m0();break}catch(o){Ax(e,o)}while(!0);wd(),Xl.current=i,Ne=a,Ze!==null?t=0:(ut=null,xt=0,t=at)}if(t!==0){if(t===2&&(a=Kc(e),a!==0&&(n=a,t=yu(e,a))),t===1)throw s=bi,on(e,0),lr(e,n),Ft(e,Je()),s;if(t===6)lr(e,n);else{if(a=e.current.alternate,!(n&30)&&!d0(a)&&(t=to(e,n),t===2&&(i=Kc(e),i!==0&&(n=i,t=yu(e,i))),t===1))throw s=bi,on(e,0),lr(e,n),Ft(e,Je()),s;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(H(345));case 2:Br(e,$t,$s);break;case 3:if(lr(e,n),(n&130023424)===n&&(t=qd+500-Je(),10<t)){if(Ml(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){Pt(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Xc(Br.bind(null,e,$t,$s),t);break}Br(e,$t,$s);break;case 4:if(lr(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var l=31-gs(n);i=1<<l,l=t[l],l>a&&(a=l),n&=~i}if(n=a,n=Je()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*u0(n/1960))-n,10<n){e.timeoutHandle=Xc(Br.bind(null,e,$t,$s),n);break}Br(e,$t,$s);break;case 5:Br(e,$t,$s);break;default:throw Error(H(329))}}}return Ft(e,Je()),e.callbackNode===s?Ox.bind(null,e):null}function yu(e,t){var s=ri;return e.current.memoizedState.isDehydrated&&(on(e,t).flags|=256),e=to(e,t),e!==2&&(t=$t,$t=s,t!==null&&vu(t)),e}function vu(e){$t===null?$t=e:$t.push.apply($t,e)}function d0(e){for(var t=e;;){if(t.flags&16384){var s=t.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var n=0;n<s.length;n++){var a=s[n],i=a.getSnapshot;a=a.value;try{if(!vs(i(),a))return!1}catch{return!1}}}if(s=t.child,t.subtreeFlags&16384&&s!==null)s.return=t,t=s;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function lr(e,t){for(t&=~$d,t&=~ko,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var s=31-gs(t),n=1<<s;e[s]=-1,t&=~n}}function mm(e){if(Ne&6)throw Error(H(327));Xn();var t=Ml(e,0);if(!(t&1))return Ft(e,Je()),null;var s=to(e,t);if(e.tag!==0&&s===2){var n=Kc(e);n!==0&&(t=n,s=yu(e,n))}if(s===1)throw s=bi,on(e,0),lr(e,t),Ft(e,Je()),s;if(s===6)throw Error(H(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Br(e,$t,$s),Ft(e,Je()),null}function Md(e,t){var s=Ne;Ne|=1;try{return e(t)}finally{Ne=s,Ne===0&&(ja=Je()+500,wo&&Mr())}}function fn(e){vr!==null&&vr.tag===0&&!(Ne&6)&&Xn();var t=Ne;Ne|=1;var s=rs.transition,n=Te;try{if(rs.transition=null,Te=1,e)return e()}finally{Te=n,rs.transition=s,Ne=t,!(Ne&6)&&Mr()}}function Ld(){Kt=Wn.current,qe(Wn)}function on(e,t){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(s!==-1&&(e.timeoutHandle=-1,Uv(s)),Ze!==null)for(s=Ze.return;s!==null;){var n=s;switch(yd(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&zl();break;case 3:ya(),qe(Lt),qe(bt),Cd();break;case 5:Sd(n);break;case 4:ya();break;case 13:qe(Ue);break;case 19:qe(Ue);break;case 10:_d(n.type._context);break;case 22:case 23:Ld()}s=s.return}if(ut=e,Ze=e=Er(e.current,null),xt=Kt=t,at=0,bi=null,$d=ko=mn=0,$t=ri=null,Qr!==null){for(t=0;t<Qr.length;t++)if(s=Qr[t],n=s.interleaved,n!==null){s.interleaved=null;var a=n.next,i=s.pending;if(i!==null){var l=i.next;i.next=a,n.next=l}s.pending=n}Qr=null}return e}function Ax(e,t){do{var s=Ze;try{if(wd(),Sl.current=Yl,Jl){for(var n=ze.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Jl=!1}if(hn=0,ct=rt=ze=null,ti=!1,ji=0,Id.current=null,s===null||s.return===null){at=1,bi=t,Ze=null;break}e:{var i=e,l=s.return,o=s,c=t;if(t=xt,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=o,m=d.tag;if(!(d.mode&1)&&(m===0||m===11||m===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var v=em(l);if(v!==null){v.flags&=-257,tm(v,l,o,i,t),v.mode&1&&Zh(i,u,t),t=v,c=u;var g=t.updateQueue;if(g===null){var w=new Set;w.add(c),t.updateQueue=w}else g.add(c);break e}else{if(!(t&1)){Zh(i,u,t),Dd();break e}c=Error(H(426))}}else if(Le&&o.mode&1){var _=em(l);if(_!==null){!(_.flags&65536)&&(_.flags|=256),tm(_,l,o,i,t),vd(va(c,o));break e}}i=c=va(c,o),at!==4&&(at=2),ri===null?ri=[i]:ri.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var x=xx(i,c,t);Hh(i,x);break e;case 1:o=c;var p=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof p.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Sr===null||!Sr.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t;var j=gx(i,o,t);Hh(i,j);break e}}i=i.return}while(i!==null)}qx(s)}catch(b){t=b,Ze===s&&s!==null&&(Ze=s=s.return);continue}break}while(!0)}function Ix(){var e=Xl.current;return Xl.current=Yl,e===null?Yl:e}function Dd(){(at===0||at===3||at===2)&&(at=4),ut===null||!(mn&268435455)&&!(ko&268435455)||lr(ut,xt)}function to(e,t){var s=Ne;Ne|=2;var n=Ix();(ut!==e||xt!==t)&&($s=null,on(e,t));do try{h0();break}catch(a){Ax(e,a)}while(!0);if(wd(),Ne=s,Xl.current=n,Ze!==null)throw Error(H(261));return ut=null,xt=0,at}function h0(){for(;Ze!==null;)$x(Ze)}function m0(){for(;Ze!==null&&!Ly();)$x(Ze)}function $x(e){var t=Lx(e.alternate,e,Kt);e.memoizedProps=e.pendingProps,t===null?qx(e):Ze=t,Id.current=null}function qx(e){var t=e;do{var s=t.alternate;if(e=t.return,t.flags&32768){if(s=i0(s,t),s!==null){s.flags&=32767,Ze=s;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{at=6,Ze=null;return}}else if(s=a0(s,t,Kt),s!==null){Ze=s;return}if(t=t.sibling,t!==null){Ze=t;return}Ze=t=e}while(t!==null);at===0&&(at=5)}function Br(e,t,s){var n=Te,a=rs.transition;try{rs.transition=null,Te=1,f0(e,t,s,n)}finally{rs.transition=a,Te=n}return null}function f0(e,t,s,n){do Xn();while(vr!==null);if(Ne&6)throw Error(H(327));s=e.finishedWork;var a=e.finishedLanes;if(s===null)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(H(177));e.callbackNode=null,e.callbackPriority=0;var i=s.lanes|s.childLanes;if(Qy(e,i),e===ut&&(Ze=ut=null,xt=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||ul||(ul=!0,Dx(ql,function(){return Xn(),null})),i=(s.flags&15990)!==0,s.subtreeFlags&15990||i){i=rs.transition,rs.transition=null;var l=Te;Te=1;var o=Ne;Ne|=4,Id.current=null,o0(e,s),Tx(s,e),Iv(Jc),Ll=!!Gc,Jc=Gc=null,e.current=s,c0(s),Dy(),Ne=o,Te=l,rs.transition=i}else e.current=s;if(ul&&(ul=!1,vr=e,eo=a),i=e.pendingLanes,i===0&&(Sr=null),zy(s.stateNode),Ft(e,Je()),t!==null)for(n=e.onRecoverableError,s=0;s<t.length;s++)a=t[s],n(a.value,{componentStack:a.stack,digest:a.digest});if(Zl)throw Zl=!1,e=xu,xu=null,e;return eo&1&&e.tag!==0&&Xn(),i=e.pendingLanes,i&1?e===gu?ni++:(ni=0,gu=e):ni=0,Mr(),null}function Xn(){if(vr!==null){var e=xp(eo),t=rs.transition,s=Te;try{if(rs.transition=null,Te=16>e?16:e,vr===null)var n=!1;else{if(e=vr,vr=null,eo=0,Ne&6)throw Error(H(331));var a=Ne;for(Ne|=4,te=e.current;te!==null;){var i=te,l=i.child;if(te.flags&16){var o=i.deletions;if(o!==null){for(var c=0;c<o.length;c++){var u=o[c];for(te=u;te!==null;){var d=te;switch(d.tag){case 0:case 11:case 15:si(8,d,i)}var m=d.child;if(m!==null)m.return=d,te=m;else for(;te!==null;){d=te;var f=d.sibling,v=d.return;if(Cx(d),d===u){te=null;break}if(f!==null){f.return=v,te=f;break}te=v}}}var g=i.alternate;if(g!==null){var w=g.child;if(w!==null){g.child=null;do{var _=w.sibling;w.sibling=null,w=_}while(w!==null)}}te=i}}if(i.subtreeFlags&2064&&l!==null)l.return=i,te=l;else e:for(;te!==null;){if(i=te,i.flags&2048)switch(i.tag){case 0:case 11:case 15:si(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,te=x;break e}te=i.return}}var p=e.current;for(te=p;te!==null;){l=te;var y=l.child;if(l.subtreeFlags&2064&&y!==null)y.return=l,te=y;else e:for(l=p;te!==null;){if(o=te,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:No(9,o)}}catch(b){Qe(o,o.return,b)}if(o===l){te=null;break e}var j=o.sibling;if(j!==null){j.return=o.return,te=j;break e}te=o.return}}if(Ne=a,Mr(),Ps&&typeof Ps.onPostCommitFiberRoot=="function")try{Ps.onPostCommitFiberRoot(xo,e)}catch{}n=!0}return n}finally{Te=s,rs.transition=t}}return!1}function fm(e,t,s){t=va(s,t),t=xx(e,t,1),e=kr(e,t,1),t=Pt(),e!==null&&(zi(e,1,t),Ft(e,t))}function Qe(e,t,s){if(e.tag===3)fm(e,e,s);else for(;t!==null;){if(t.tag===3){fm(t,e,s);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Sr===null||!Sr.has(n))){e=va(s,e),e=gx(t,e,1),t=kr(t,e,1),e=Pt(),t!==null&&(zi(t,1,e),Ft(t,e));break}}t=t.return}}function p0(e,t,s){var n=e.pingCache;n!==null&&n.delete(t),t=Pt(),e.pingedLanes|=e.suspendedLanes&s,ut===e&&(xt&s)===s&&(at===4||at===3&&(xt&130023424)===xt&&500>Je()-qd?on(e,0):$d|=s),Ft(e,t)}function Mx(e,t){t===0&&(e.mode&1?(t=el,el<<=1,!(el&130023424)&&(el=4194304)):t=1);var s=Pt();e=Qs(e,t),e!==null&&(zi(e,t,s),Ft(e,s))}function x0(e){var t=e.memoizedState,s=0;t!==null&&(s=t.retryLane),Mx(e,s)}function g0(e,t){var s=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(s=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(H(314))}n!==null&&n.delete(t),Mx(e,s)}var Lx;Lx=function(e,t,s){if(e!==null)if(e.memoizedProps!==t.pendingProps||Lt.current)qt=!0;else{if(!(e.lanes&s)&&!(t.flags&128))return qt=!1,n0(e,t,s);qt=!!(e.flags&131072)}else qt=!1,Le&&t.flags&1048576&&zp(t,Wl,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;El(e,t),e=t.pendingProps;var a=pa(t,bt.current);Yn(t,s),a=Pd(null,t,n,e,a,s);var i=Td();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Dt(n)?(i=!0,Bl(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Nd(t),a.updater=bo,t.stateNode=a,a._reactInternals=t,au(t,n,e,s),t=ou(null,t,n,!0,i,s)):(t.tag=0,Le&&i&&gd(t),Ct(null,t,a,s),t=t.child),t;case 16:n=t.elementType;e:{switch(El(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=v0(n),e=us(n,e),a){case 0:t=lu(null,t,n,e,s);break e;case 1:t=nm(null,t,n,e,s);break e;case 11:t=sm(null,t,n,e,s);break e;case 14:t=rm(null,t,n,us(n.type,e),s);break e}throw Error(H(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:us(n,a),lu(e,t,n,a,s);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:us(n,a),nm(e,t,n,a,s);case 3:e:{if(wx(t),e===null)throw Error(H(387));n=t.pendingProps,i=t.memoizedState,a=i.element,Qp(e,t),Ql(t,n,null,s);var l=t.memoizedState;if(n=l.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=va(Error(H(423)),t),t=am(e,t,n,s,a);break e}else if(n!==a){a=va(Error(H(424)),t),t=am(e,t,n,s,a);break e}else for(Ht=Nr(t.stateNode.containerInfo.firstChild),Qt=t,Le=!0,xs=null,s=Vp(t,null,n,s),t.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(xa(),n===a){t=Gs(e,t,s);break e}Ct(e,t,n,s)}t=t.child}return t;case 5:return Gp(t),e===null&&su(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,l=a.children,Yc(n,a)?l=null:i!==null&&Yc(n,i)&&(t.flags|=32),jx(e,t),Ct(e,t,l,s),t.child;case 6:return e===null&&su(t),null;case 13:return _x(e,t,s);case 4:return kd(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=ga(t,null,n,s):Ct(e,t,n,s),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:us(n,a),sm(e,t,n,a,s);case 7:return Ct(e,t,t.pendingProps,s),t.child;case 8:return Ct(e,t,t.pendingProps.children,s),t.child;case 12:return Ct(e,t,t.pendingProps.children,s),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,l=a.value,Ae(Vl,n._currentValue),n._currentValue=l,i!==null)if(vs(i.value,l)){if(i.children===a.children&&!Lt.current){t=Gs(e,t,s);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){l=i.child;for(var c=o.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=Ks(-1,s&-s),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=s,c=i.alternate,c!==null&&(c.lanes|=s),ru(i.return,s,t),o.lanes|=s;break}c=c.next}}else if(i.tag===10)l=i.type===t.type?null:i.child;else if(i.tag===18){if(l=i.return,l===null)throw Error(H(341));l.lanes|=s,o=l.alternate,o!==null&&(o.lanes|=s),ru(l,s,t),l=i.sibling}else l=i.child;if(l!==null)l.return=i;else for(l=i;l!==null;){if(l===t){l=null;break}if(i=l.sibling,i!==null){i.return=l.return,l=i;break}l=l.return}i=l}Ct(e,t,a.children,s),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,Yn(t,s),a=ns(a),n=n(a),t.flags|=1,Ct(e,t,n,s),t.child;case 14:return n=t.type,a=us(n,t.pendingProps),a=us(n.type,a),rm(e,t,n,a,s);case 15:return yx(e,t,t.type,t.pendingProps,s);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:us(n,a),El(e,t),t.tag=1,Dt(n)?(e=!0,Bl(t)):e=!1,Yn(t,s),px(t,n,a),au(t,n,a,s),ou(null,t,n,!0,e,s);case 19:return bx(e,t,s);case 22:return vx(e,t,s)}throw Error(H(156,t.tag))};function Dx(e,t){return hp(e,t)}function y0(e,t,s,n){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ss(e,t,s,n){return new y0(e,t,s,n)}function Fd(e){return e=e.prototype,!(!e||!e.isReactComponent)}function v0(e){if(typeof e=="function")return Fd(e)?1:0;if(e!=null){if(e=e.$$typeof,e===ad)return 11;if(e===id)return 14}return 2}function Er(e,t){var s=e.alternate;return s===null?(s=ss(e.tag,t,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=t,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&14680064,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,t=e.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function Rl(e,t,s,n,a,i){var l=2;if(n=e,typeof e=="function")Fd(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case $n:return cn(s.children,a,i,t);case nd:l=8,a|=8;break;case Pc:return e=ss(12,s,t,a|2),e.elementType=Pc,e.lanes=i,e;case Tc:return e=ss(13,s,t,a),e.elementType=Tc,e.lanes=i,e;case Rc:return e=ss(19,s,t,a),e.elementType=Rc,e.lanes=i,e;case Gf:return So(s,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Hf:l=10;break e;case Qf:l=9;break e;case ad:l=11;break e;case id:l=14;break e;case rr:l=16,n=null;break e}throw Error(H(130,e==null?e:typeof e,""))}return t=ss(l,s,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function cn(e,t,s,n){return e=ss(7,e,n,t),e.lanes=s,e}function So(e,t,s,n){return e=ss(22,e,n,t),e.elementType=Gf,e.lanes=s,e.stateNode={isHidden:!1},e}function hc(e,t,s){return e=ss(6,e,null,t),e.lanes=s,e}function mc(e,t,s){return t=ss(4,e.children!==null?e.children:[],e.key,t),t.lanes=s,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function j0(e,t,s,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ho(0),this.expirationTimes=Ho(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ho(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Ud(e,t,s,n,a,i,l,o,c){return e=new j0(e,t,s,o,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=ss(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},Nd(i),e}function w0(e,t,s){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:In,key:n==null?null:""+n,children:e,containerInfo:t,implementation:s}}function Fx(e){if(!e)return Ar;e=e._reactInternals;e:{if(jn(e)!==e||e.tag!==1)throw Error(H(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Dt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(H(171))}if(e.tag===1){var s=e.type;if(Dt(s))return Fp(e,s,t)}return t}function Ux(e,t,s,n,a,i,l,o,c){return e=Ud(s,n,!0,e,a,i,l,o,c),e.context=Fx(null),s=e.current,n=Pt(),a=Cr(s),i=Ks(n,a),i.callback=t??null,kr(s,i,a),e.current.lanes=a,zi(e,a,n),Ft(e,n),e}function Co(e,t,s,n){var a=t.current,i=Pt(),l=Cr(a);return s=Fx(s),t.context===null?t.context=s:t.pendingContext=s,t=Ks(i,l),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=kr(a,t,l),e!==null&&(ys(e,a,l,i),kl(e,a,l)),l}function so(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function pm(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<t?s:t}}function zd(e,t){pm(e,t),(e=e.alternate)&&pm(e,t)}function _0(){return null}var zx=typeof reportError=="function"?reportError:function(e){console.error(e)};function Bd(e){this._internalRoot=e}Eo.prototype.render=Bd.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(H(409));Co(e,t,null,null)};Eo.prototype.unmount=Bd.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;fn(function(){Co(null,e,null,null)}),t[Hs]=null}};function Eo(e){this._internalRoot=e}Eo.prototype.unstable_scheduleHydration=function(e){if(e){var t=vp();e={blockedOn:null,target:e,priority:t};for(var s=0;s<ir.length&&t!==0&&t<ir[s].priority;s++);ir.splice(s,0,e),s===0&&wp(e)}};function Kd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Po(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function xm(){}function b0(e,t,s,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var u=so(l);i.call(u)}}var l=Ux(t,n,e,0,null,!1,!1,"",xm);return e._reactRootContainer=l,e[Hs]=l.current,pi(e.nodeType===8?e.parentNode:e),fn(),l}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var u=so(c);o.call(u)}}var c=Ud(e,0,!1,null,null,!1,!1,"",xm);return e._reactRootContainer=c,e[Hs]=c.current,pi(e.nodeType===8?e.parentNode:e),fn(function(){Co(t,c,s,n)}),c}function To(e,t,s,n,a){var i=s._reactRootContainer;if(i){var l=i;if(typeof a=="function"){var o=a;a=function(){var c=so(l);o.call(c)}}Co(t,l,e,a)}else l=b0(s,t,e,a,n);return so(l)}gp=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var s=Ka(t.pendingLanes);s!==0&&(cd(t,s|1),Ft(t,Je()),!(Ne&6)&&(ja=Je()+500,Mr()))}break;case 13:fn(function(){var n=Qs(e,1);if(n!==null){var a=Pt();ys(n,e,1,a)}}),zd(e,1)}};ud=function(e){if(e.tag===13){var t=Qs(e,134217728);if(t!==null){var s=Pt();ys(t,e,134217728,s)}zd(e,134217728)}};yp=function(e){if(e.tag===13){var t=Cr(e),s=Qs(e,t);if(s!==null){var n=Pt();ys(s,e,t,n)}zd(e,t)}};vp=function(){return Te};jp=function(e,t){var s=Te;try{return Te=e,t()}finally{Te=s}};Uc=function(e,t,s){switch(t){case"input":if(Ic(e,s),t=s.name,s.type==="radio"&&t!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<s.length;t++){var n=s[t];if(n!==e&&n.form===e.form){var a=jo(n);if(!a)throw Error(H(90));Yf(n),Ic(n,a)}}}break;case"textarea":Zf(e,s);break;case"select":t=s.value,t!=null&&Hn(e,!!s.multiple,t,!1)}};ip=Md;lp=fn;var N0={usingClientEntryPoint:!1,Events:[Ki,Dn,jo,np,ap,Md]},Da={findFiberByHostInstance:Hr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},k0={bundleType:Da.bundleType,version:Da.version,rendererPackageName:Da.rendererPackageName,rendererConfig:Da.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Js.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=up(e),e===null?null:e.stateNode},findFiberByHostInstance:Da.findFiberByHostInstance||_0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var dl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!dl.isDisabled&&dl.supportsFiber)try{xo=dl.inject(k0),Ps=dl}catch{}}Jt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=N0;Jt.createPortal=function(e,t){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Kd(t))throw Error(H(200));return w0(e,t,null,s)};Jt.createRoot=function(e,t){if(!Kd(e))throw Error(H(299));var s=!1,n="",a=zx;return t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=Ud(e,1,!1,null,null,s,!1,n,a),e[Hs]=t.current,pi(e.nodeType===8?e.parentNode:e),new Bd(t)};Jt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(H(188)):(e=Object.keys(e).join(","),Error(H(268,e)));return e=up(t),e=e===null?null:e.stateNode,e};Jt.flushSync=function(e){return fn(e)};Jt.hydrate=function(e,t,s){if(!Po(t))throw Error(H(200));return To(null,e,t,!0,s)};Jt.hydrateRoot=function(e,t,s){if(!Kd(e))throw Error(H(405));var n=s!=null&&s.hydratedSources||null,a=!1,i="",l=zx;if(s!=null&&(s.unstable_strictMode===!0&&(a=!0),s.identifierPrefix!==void 0&&(i=s.identifierPrefix),s.onRecoverableError!==void 0&&(l=s.onRecoverableError)),t=Ux(t,null,e,1,s??null,a,!1,i,l),e[Hs]=t.current,pi(e),n)for(e=0;e<n.length;e++)s=n[e],a=s._getVersion,a=a(s._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[s,a]:t.mutableSourceEagerHydrationData.push(s,a);return new Eo(t)};Jt.render=function(e,t,s){if(!Po(t))throw Error(H(200));return To(null,e,t,!1,s)};Jt.unmountComponentAtNode=function(e){if(!Po(e))throw Error(H(40));return e._reactRootContainer?(fn(function(){To(null,null,e,!1,function(){e._reactRootContainer=null,e[Hs]=null})}),!0):!1};Jt.unstable_batchedUpdates=Md;Jt.unstable_renderSubtreeIntoContainer=function(e,t,s,n){if(!Po(s))throw Error(H(200));if(e==null||e._reactInternals===void 0)throw Error(H(38));return To(e,t,s,!1,n)};Jt.version="18.3.1-next-f1338f8080-20240426";function Bx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Bx)}catch(e){console.error(e)}}Bx(),Bf.exports=Jt;var Kx=Bf.exports,gm=Kx;Cc.createRoot=gm.createRoot,Cc.hydrateRoot=gm.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ni(){return Ni=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},Ni.apply(this,arguments)}var jr;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(jr||(jr={}));const ym="popstate";function S0(e){e===void 0&&(e={});function t(a,i){let{pathname:l="/",search:o="",hash:c=""}=wn(a.location.hash.substr(1));return!l.startsWith("/")&&!l.startsWith(".")&&(l="/"+l),ju("",{pathname:l,search:o,hash:c},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function s(a,i){let l=a.document.querySelector("base"),o="";if(l&&l.getAttribute("href")){let c=a.location.href,u=c.indexOf("#");o=u===-1?c:c.slice(0,u)}return o+"#"+(typeof i=="string"?i:ro(i))}function n(a,i){Ro(a.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(i)+")")}return E0(t,s,n,e)}function Ye(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Ro(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function C0(){return Math.random().toString(36).substr(2,8)}function vm(e,t){return{usr:e.state,key:e.key,idx:t}}function ju(e,t,s,n){return s===void 0&&(s=null),Ni({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?wn(t):t,{state:s,key:t&&t.key||n||C0()})}function ro(e){let{pathname:t="/",search:s="",hash:n=""}=e;return s&&s!=="?"&&(t+=s.charAt(0)==="?"?s:"?"+s),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function wn(e){let t={};if(e){let s=e.indexOf("#");s>=0&&(t.hash=e.substr(s),e=e.substr(0,s));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function E0(e,t,s,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:i=!1}=n,l=a.history,o=jr.Pop,c=null,u=d();u==null&&(u=0,l.replaceState(Ni({},l.state,{idx:u}),""));function d(){return(l.state||{idx:null}).idx}function m(){o=jr.Pop;let _=d(),x=_==null?null:_-u;u=_,c&&c({action:o,location:w.location,delta:x})}function f(_,x){o=jr.Push;let p=ju(w.location,_,x);s&&s(p,_),u=d()+1;let y=vm(p,u),j=w.createHref(p);try{l.pushState(y,"",j)}catch(b){if(b instanceof DOMException&&b.name==="DataCloneError")throw b;a.location.assign(j)}i&&c&&c({action:o,location:w.location,delta:1})}function v(_,x){o=jr.Replace;let p=ju(w.location,_,x);s&&s(p,_),u=d();let y=vm(p,u),j=w.createHref(p);l.replaceState(y,"",j),i&&c&&c({action:o,location:w.location,delta:0})}function g(_){let x=a.location.origin!=="null"?a.location.origin:a.location.href,p=typeof _=="string"?_:ro(_);return p=p.replace(/ $/,"%20"),Ye(x,"No window.location.(origin|href) available to create URL for href: "+p),new URL(p,x)}let w={get action(){return o},get location(){return e(a,l)},listen(_){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(ym,m),c=_,()=>{a.removeEventListener(ym,m),c=null}},createHref(_){return t(a,_)},createURL:g,encodeLocation(_){let x=g(_);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:f,replace:v,go(_){return l.go(_)}};return w}var jm;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(jm||(jm={}));function P0(e,t,s){return s===void 0&&(s="/"),T0(e,t,s)}function T0(e,t,s,n){let a=typeof t=="string"?wn(t):t,i=Wd(a.pathname||"/",s);if(i==null)return null;let l=Wx(e);R0(l);let o=null;for(let c=0;o==null&&c<l.length;++c){let u=B0(i);o=F0(l[c],u)}return o}function Wx(e,t,s,n){t===void 0&&(t=[]),s===void 0&&(s=[]),n===void 0&&(n="");let a=(i,l,o)=>{let c={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:l,route:i};c.relativePath.startsWith("/")&&(Ye(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=Pr([n,c.relativePath]),d=s.concat(c);i.children&&i.children.length>0&&(Ye(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),Wx(i.children,t,d,u)),!(i.path==null&&!i.index)&&t.push({path:u,score:L0(u,i.index),routesMeta:d})};return e.forEach((i,l)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))a(i,l);else for(let c of Vx(i.path))a(i,l,c)}),t}function Vx(e){let t=e.split("/");if(t.length===0)return[];let[s,...n]=t,a=s.endsWith("?"),i=s.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let l=Vx(n.join("/")),o=[];return o.push(...l.map(c=>c===""?i:[i,c].join("/"))),a&&o.push(...l),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function R0(e){e.sort((t,s)=>t.score!==s.score?s.score-t.score:D0(t.routesMeta.map(n=>n.childrenIndex),s.routesMeta.map(n=>n.childrenIndex)))}const O0=/^:[\w-]+$/,A0=3,I0=2,$0=1,q0=10,M0=-2,wm=e=>e==="*";function L0(e,t){let s=e.split("/"),n=s.length;return s.some(wm)&&(n+=M0),t&&(n+=I0),s.filter(a=>!wm(a)).reduce((a,i)=>a+(O0.test(i)?A0:i===""?$0:q0),n)}function D0(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function F0(e,t,s){let{routesMeta:n}=e,a={},i="/",l=[];for(let o=0;o<n.length;++o){let c=n[o],u=o===n.length-1,d=i==="/"?t:t.slice(i.length)||"/",m=U0({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),f=c.route;if(!m)return null;Object.assign(a,m.params),l.push({params:a,pathname:Pr([i,m.pathname]),pathnameBase:Q0(Pr([i,m.pathnameBase])),route:f}),m.pathnameBase!=="/"&&(i=Pr([i,m.pathnameBase]))}return l}function U0(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[s,n]=z0(e.path,e.caseSensitive,e.end),a=t.match(s);if(!a)return null;let i=a[0],l=i.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:n.reduce((u,d,m)=>{let{paramName:f,isOptional:v}=d;if(f==="*"){let w=o[m]||"";l=i.slice(0,i.length-w.length).replace(/(.)\/+$/,"$1")}const g=o[m];return v&&!g?u[f]=void 0:u[f]=(g||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:l,pattern:e}}function z0(e,t,s){t===void 0&&(t=!1),s===void 0&&(s=!0),Ro(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function B0(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Ro(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Wd(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let s=t.endsWith("/")?t.length-1:t.length,n=e.charAt(s);return n&&n!=="/"?null:e.slice(s)||"/"}const K0=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,W0=e=>K0.test(e);function V0(e,t){t===void 0&&(t="/");let{pathname:s,search:n="",hash:a=""}=typeof e=="string"?wn(e):e,i;if(s)if(W0(s))i=s;else{if(s.includes("//")){let l=s;s=s.replace(/\/\/+/g,"/"),Ro(!1,"Pathnames cannot have embedded double slashes - normalizing "+(l+" -> "+s))}s.startsWith("/")?i=_m(s.substring(1),"/"):i=_m(s,t)}else i=t;return{pathname:i,search:G0(n),hash:J0(a)}}function _m(e,t){let s=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?s.length>1&&s.pop():a!=="."&&s.push(a)}),s.length>1?s.join("/"):"/"}function fc(e,t,s,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+s+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function H0(e){return e.filter((t,s)=>s===0||t.route.path&&t.route.path.length>0)}function Vd(e,t){let s=H0(e);return t?s.map((n,a)=>a===s.length-1?n.pathname:n.pathnameBase):s.map(n=>n.pathnameBase)}function Hd(e,t,s,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=wn(e):(a=Ni({},e),Ye(!a.pathname||!a.pathname.includes("?"),fc("?","pathname","search",a)),Ye(!a.pathname||!a.pathname.includes("#"),fc("#","pathname","hash",a)),Ye(!a.search||!a.search.includes("#"),fc("#","search","hash",a)));let i=e===""||a.pathname==="",l=i?"/":a.pathname,o;if(l==null)o=s;else{let m=t.length-1;if(!n&&l.startsWith("..")){let f=l.split("/");for(;f[0]==="..";)f.shift(),m-=1;a.pathname=f.join("/")}o=m>=0?t[m]:"/"}let c=V0(a,o),u=l&&l!=="/"&&l.endsWith("/"),d=(i||l===".")&&s.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const Pr=e=>e.join("/").replace(/\/\/+/g,"/"),Q0=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),G0=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,J0=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function Y0(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Hx=["post","put","patch","delete"];new Set(Hx);const X0=["get",...Hx];new Set(X0);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ki(){return ki=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},ki.apply(this,arguments)}const Qd=S.createContext(null),Z0=S.createContext(null),Lr=S.createContext(null),Oo=S.createContext(null),Ys=S.createContext({outlet:null,matches:[],isDataRoute:!1}),Qx=S.createContext(null);function ej(e,t){let{relative:s}=t===void 0?{}:t;Sa()||Ye(!1);let{basename:n,navigator:a}=S.useContext(Lr),{hash:i,pathname:l,search:o}=Jx(e,{relative:s}),c=l;return n!=="/"&&(c=l==="/"?n:Pr([n,l])),a.createHref({pathname:c,search:o,hash:i})}function Sa(){return S.useContext(Oo)!=null}function Ca(){return Sa()||Ye(!1),S.useContext(Oo).location}function Gx(e){S.useContext(Lr).static||S.useLayoutEffect(e)}function Ea(){let{isDataRoute:e}=S.useContext(Ys);return e?pj():tj()}function tj(){Sa()||Ye(!1);let e=S.useContext(Qd),{basename:t,future:s,navigator:n}=S.useContext(Lr),{matches:a}=S.useContext(Ys),{pathname:i}=Ca(),l=JSON.stringify(Vd(a,s.v7_relativeSplatPath)),o=S.useRef(!1);return Gx(()=>{o.current=!0}),S.useCallback(function(u,d){if(d===void 0&&(d={}),!o.current)return;if(typeof u=="number"){n.go(u);return}let m=Hd(u,JSON.parse(l),i,d.relative==="path");e==null&&t!=="/"&&(m.pathname=m.pathname==="/"?t:Pr([t,m.pathname])),(d.replace?n.replace:n.push)(m,d.state,d)},[t,n,l,i,e])}const sj=S.createContext(null);function rj(e){let t=S.useContext(Ys).outlet;return t&&S.createElement(sj.Provider,{value:e},t)}function Jx(e,t){let{relative:s}=t===void 0?{}:t,{future:n}=S.useContext(Lr),{matches:a}=S.useContext(Ys),{pathname:i}=Ca(),l=JSON.stringify(Vd(a,n.v7_relativeSplatPath));return S.useMemo(()=>Hd(e,JSON.parse(l),i,s==="path"),[e,l,i,s])}function nj(e,t){return aj(e,t)}function aj(e,t,s,n){Sa()||Ye(!1);let{navigator:a}=S.useContext(Lr),{matches:i}=S.useContext(Ys),l=i[i.length-1],o=l?l.params:{};l&&l.pathname;let c=l?l.pathnameBase:"/";l&&l.route;let u=Ca(),d;if(t){var m;let _=typeof t=="string"?wn(t):t;c==="/"||(m=_.pathname)!=null&&m.startsWith(c)||Ye(!1),d=_}else d=u;let f=d.pathname||"/",v=f;if(c!=="/"){let _=c.replace(/^\//,"").split("/");v="/"+f.replace(/^\//,"").split("/").slice(_.length).join("/")}let g=P0(e,{pathname:v}),w=uj(g&&g.map(_=>Object.assign({},_,{params:Object.assign({},o,_.params),pathname:Pr([c,a.encodeLocation?a.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?c:Pr([c,a.encodeLocation?a.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),i,s,n);return t&&w?S.createElement(Oo.Provider,{value:{location:ki({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:jr.Pop}},w):w}function ij(){let e=fj(),t=Y0(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),s=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return S.createElement(S.Fragment,null,S.createElement("h2",null,"Unexpected Application Error!"),S.createElement("h3",{style:{fontStyle:"italic"}},t),s?S.createElement("pre",{style:a},s):null,null)}const lj=S.createElement(ij,null);class oj extends S.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,s){return s.location!==t.location||s.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:s.error,location:s.location,revalidation:t.revalidation||s.revalidation}}componentDidCatch(t,s){console.error("React Router caught the following error during render",t,s)}render(){return this.state.error!==void 0?S.createElement(Ys.Provider,{value:this.props.routeContext},S.createElement(Qx.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function cj(e){let{routeContext:t,match:s,children:n}=e,a=S.useContext(Qd);return a&&a.static&&a.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=s.route.id),S.createElement(Ys.Provider,{value:t},n)}function uj(e,t,s,n){var a;if(t===void 0&&(t=[]),s===void 0&&(s=null),n===void 0&&(n=null),e==null){var i;if(!s)return null;if(s.errors)e=s.matches;else if((i=n)!=null&&i.v7_partialHydration&&t.length===0&&!s.initialized&&s.matches.length>0)e=s.matches;else return null}let l=e,o=(a=s)==null?void 0:a.errors;if(o!=null){let d=l.findIndex(m=>m.route.id&&(o==null?void 0:o[m.route.id])!==void 0);d>=0||Ye(!1),l=l.slice(0,Math.min(l.length,d+1))}let c=!1,u=-1;if(s&&n&&n.v7_partialHydration)for(let d=0;d<l.length;d++){let m=l[d];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(u=d),m.route.id){let{loaderData:f,errors:v}=s,g=m.route.loader&&f[m.route.id]===void 0&&(!v||v[m.route.id]===void 0);if(m.route.lazy||g){c=!0,u>=0?l=l.slice(0,u+1):l=[l[0]];break}}}return l.reduceRight((d,m,f)=>{let v,g=!1,w=null,_=null;s&&(v=o&&m.route.id?o[m.route.id]:void 0,w=m.route.errorElement||lj,c&&(u<0&&f===0?(xj("route-fallback"),g=!0,_=null):u===f&&(g=!0,_=m.route.hydrateFallbackElement||null)));let x=t.concat(l.slice(0,f+1)),p=()=>{let y;return v?y=w:g?y=_:m.route.Component?y=S.createElement(m.route.Component,null):m.route.element?y=m.route.element:y=d,S.createElement(cj,{match:m,routeContext:{outlet:d,matches:x,isDataRoute:s!=null},children:y})};return s&&(m.route.ErrorBoundary||m.route.errorElement||f===0)?S.createElement(oj,{location:s.location,revalidation:s.revalidation,component:w,error:v,children:p(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):p()},null)}var Yx=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Yx||{}),Xx=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Xx||{});function dj(e){let t=S.useContext(Qd);return t||Ye(!1),t}function hj(e){let t=S.useContext(Z0);return t||Ye(!1),t}function mj(e){let t=S.useContext(Ys);return t||Ye(!1),t}function Zx(e){let t=mj(),s=t.matches[t.matches.length-1];return s.route.id||Ye(!1),s.route.id}function fj(){var e;let t=S.useContext(Qx),s=hj(),n=Zx();return t!==void 0?t:(e=s.errors)==null?void 0:e[n]}function pj(){let{router:e}=dj(Yx.UseNavigateStable),t=Zx(Xx.UseNavigateStable),s=S.useRef(!1);return Gx(()=>{s.current=!0}),S.useCallback(function(a,i){i===void 0&&(i={}),s.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,ki({fromRouteId:t},i)))},[e,t])}const bm={};function xj(e,t,s){bm[e]||(bm[e]=!0)}function gj(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function eg(e){let{to:t,replace:s,state:n,relative:a}=e;Sa()||Ye(!1);let{future:i,static:l}=S.useContext(Lr),{matches:o}=S.useContext(Ys),{pathname:c}=Ca(),u=Ea(),d=Hd(t,Vd(o,i.v7_relativeSplatPath),c,a==="path"),m=JSON.stringify(d);return S.useEffect(()=>u(JSON.parse(m),{replace:s,state:n,relative:a}),[u,m,a,s,n]),null}function yj(e){return rj(e.context)}function We(e){Ye(!1)}function vj(e){let{basename:t="/",children:s=null,location:n,navigationType:a=jr.Pop,navigator:i,static:l=!1,future:o}=e;Sa()&&Ye(!1);let c=t.replace(/^\/*/,"/"),u=S.useMemo(()=>({basename:c,navigator:i,static:l,future:ki({v7_relativeSplatPath:!1},o)}),[c,o,i,l]);typeof n=="string"&&(n=wn(n));let{pathname:d="/",search:m="",hash:f="",state:v=null,key:g="default"}=n,w=S.useMemo(()=>{let _=Wd(d,c);return _==null?null:{location:{pathname:_,search:m,hash:f,state:v,key:g},navigationType:a}},[c,d,m,f,v,g,a]);return w==null?null:S.createElement(Lr.Provider,{value:u},S.createElement(Oo.Provider,{children:s,value:w}))}function jj(e){let{children:t,location:s}=e;return nj(wu(t),s)}new Promise(()=>{});function wu(e,t){t===void 0&&(t=[]);let s=[];return S.Children.forEach(e,(n,a)=>{if(!S.isValidElement(n))return;let i=[...t,a];if(n.type===S.Fragment){s.push.apply(s,wu(n.props.children,i));return}n.type!==We&&Ye(!1),!n.props.index||!n.props.children||Ye(!1);let l={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=wu(n.props.children,i)),s.push(l)}),s}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _u(){return _u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},_u.apply(this,arguments)}function wj(e,t){if(e==null)return{};var s={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(s[a]=e[a]);return s}function _j(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function bj(e,t){return e.button===0&&(!t||t==="_self")&&!_j(e)}const Nj=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],kj="6";try{window.__reactRouterVersion=kj}catch{}const Sj="startTransition",Nm=Uf[Sj];function Cj(e){let{basename:t,children:s,future:n,window:a}=e,i=S.useRef();i.current==null&&(i.current=S0({window:a,v5Compat:!0}));let l=i.current,[o,c]=S.useState({action:l.action,location:l.location}),{v7_startTransition:u}=n||{},d=S.useCallback(m=>{u&&Nm?Nm(()=>c(m)):c(m)},[c,u]);return S.useLayoutEffect(()=>l.listen(d),[l,d]),S.useEffect(()=>gj(n),[n]),S.createElement(vj,{basename:t,children:s,location:o.location,navigationType:o.action,navigator:l,future:n})}const Ej=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Pj=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Tj=S.forwardRef(function(t,s){let{onClick:n,relative:a,reloadDocument:i,replace:l,state:o,target:c,to:u,preventScrollReset:d,viewTransition:m}=t,f=wj(t,Nj),{basename:v}=S.useContext(Lr),g,w=!1;if(typeof u=="string"&&Pj.test(u)&&(g=u,Ej))try{let y=new URL(window.location.href),j=u.startsWith("//")?new URL(y.protocol+u):new URL(u),b=Wd(j.pathname,v);j.origin===y.origin&&b!=null?u=b+j.search+j.hash:w=!0}catch{}let _=ej(u,{relative:a}),x=Rj(u,{replace:l,state:o,target:c,preventScrollReset:d,relative:a,viewTransition:m});function p(y){n&&n(y),y.defaultPrevented||x(y)}return S.createElement("a",_u({},f,{href:g||_,onClick:w||i?n:p,ref:s,target:c}))});var km;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(km||(km={}));var Sm;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Sm||(Sm={}));function Rj(e,t){let{target:s,replace:n,state:a,preventScrollReset:i,relative:l,viewTransition:o}=t===void 0?{}:t,c=Ea(),u=Ca(),d=Jx(e,{relative:l});return S.useCallback(m=>{if(bj(m,s)){m.preventDefault();let f=n!==void 0?n:ro(u)===ro(d);c(e,{replace:f,state:a,preventScrollReset:i,relative:l,viewTransition:o})}},[u,c,d,n,a,s,e,i,l,o])}var Pa=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Oj={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},cr,Ju,vf,Aj=(vf=class{constructor(){ie(this,cr,Oj);ie(this,Ju,!1)}setTimeoutProvider(e){X(this,cr,e)}setTimeout(e,t){return E(this,cr).setTimeout(e,t)}clearTimeout(e){E(this,cr).clearTimeout(e)}setInterval(e,t){return E(this,cr).setInterval(e,t)}clearInterval(e){E(this,cr).clearInterval(e)}},cr=new WeakMap,Ju=new WeakMap,vf),Jr=new Aj;function Ij(e){setTimeout(e,0)}var pn=typeof window>"u"||"Deno"in globalThis;function Et(){}function $j(e,t){return typeof e=="function"?e(t):e}function bu(e){return typeof e=="number"&&e>=0&&e!==1/0}function tg(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Tr(e,t){return typeof e=="function"?e(t):e}function Zt(e,t){return typeof e=="function"?e(t):e}function Cm(e,t){const{type:s="all",exact:n,fetchStatus:a,predicate:i,queryKey:l,stale:o}=e;if(l){if(n){if(t.queryHash!==Gd(l,t.options))return!1}else if(!Si(t.queryKey,l))return!1}if(s!=="all"){const c=t.isActive();if(s==="active"&&!c||s==="inactive"&&c)return!1}return!(typeof o=="boolean"&&t.isStale()!==o||a&&a!==t.state.fetchStatus||i&&!i(t))}function Em(e,t){const{exact:s,status:n,predicate:a,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(s){if(xn(t.options.mutationKey)!==xn(i))return!1}else if(!Si(t.options.mutationKey,i))return!1}return!(n&&t.state.status!==n||a&&!a(t))}function Gd(e,t){return((t==null?void 0:t.queryKeyHashFn)||xn)(e)}function xn(e){return JSON.stringify(e,(t,s)=>Nu(s)?Object.keys(s).sort().reduce((n,a)=>(n[a]=s[a],n),{}):s)}function Si(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(s=>Si(e[s],t[s])):!1}var qj=Object.prototype.hasOwnProperty;function sg(e,t){if(e===t)return e;const s=Pm(e)&&Pm(t);if(!s&&!(Nu(e)&&Nu(t)))return t;const a=(s?e:Object.keys(e)).length,i=s?t:Object.keys(t),l=i.length,o=s?new Array(l):{};let c=0;for(let u=0;u<l;u++){const d=s?u:i[u],m=e[d],f=t[d];if(m===f){o[d]=m,(s?u<a:qj.call(e,d))&&c++;continue}if(m===null||f===null||typeof m!="object"||typeof f!="object"){o[d]=f;continue}const v=sg(m,f);o[d]=v,v===m&&c++}return a===l&&c===a?e:o}function no(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}function Pm(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Nu(e){if(!Tm(e))return!1;const t=e.constructor;if(t===void 0)return!0;const s=t.prototype;return!(!Tm(s)||!s.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function Tm(e){return Object.prototype.toString.call(e)==="[object Object]"}function Mj(e){return new Promise(t=>{Jr.setTimeout(t,e)})}function ku(e,t,s){return typeof s.structuralSharing=="function"?s.structuralSharing(e,t):s.structuralSharing!==!1?sg(e,t):t}function Lj(e,t,s=0){const n=[...e,t];return s&&n.length>s?n.slice(1):n}function Dj(e,t,s=0){const n=[t,...e];return s&&n.length>s?n.slice(0,-1):n}var Jd=Symbol();function rg(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===Jd?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function ng(e,t){return typeof e=="function"?e(...t):!!e}var Xr,ur,sa,jf,Fj=(jf=class extends Pa{constructor(){super();ie(this,Xr);ie(this,ur);ie(this,sa);X(this,sa,t=>{if(!pn&&window.addEventListener){const s=()=>t();return window.addEventListener("visibilitychange",s,!1),()=>{window.removeEventListener("visibilitychange",s)}}})}onSubscribe(){E(this,ur)||this.setEventListener(E(this,sa))}onUnsubscribe(){var t;this.hasListeners()||((t=E(this,ur))==null||t.call(this),X(this,ur,void 0))}setEventListener(t){var s;X(this,sa,t),(s=E(this,ur))==null||s.call(this),X(this,ur,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){E(this,Xr)!==t&&(X(this,Xr,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(s=>{s(t)})}isFocused(){var t;return typeof E(this,Xr)=="boolean"?E(this,Xr):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Xr=new WeakMap,ur=new WeakMap,sa=new WeakMap,jf),Yd=new Fj;function Su(){let e,t;const s=new Promise((a,i)=>{e=a,t=i});s.status="pending",s.catch(()=>{});function n(a){Object.assign(s,a),delete s.resolve,delete s.reject}return s.resolve=a=>{n({status:"fulfilled",value:a}),e(a)},s.reject=a=>{n({status:"rejected",reason:a}),t(a)},s}var Uj=Ij;function zj(){let e=[],t=0,s=o=>{o()},n=o=>{o()},a=Uj;const i=o=>{t?e.push(o):a(()=>{s(o)})},l=()=>{const o=e;e=[],o.length&&a(()=>{n(()=>{o.forEach(c=>{s(c)})})})};return{batch:o=>{let c;t++;try{c=o()}finally{t--,t||l()}return c},batchCalls:o=>(...c)=>{i(()=>{o(...c)})},schedule:i,setNotifyFunction:o=>{s=o},setBatchNotifyFunction:o=>{n=o},setScheduler:o=>{a=o}}}var nt=zj(),ra,dr,na,wf,Bj=(wf=class extends Pa{constructor(){super();ie(this,ra,!0);ie(this,dr);ie(this,na);X(this,na,t=>{if(!pn&&window.addEventListener){const s=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",s,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",n)}}})}onSubscribe(){E(this,dr)||this.setEventListener(E(this,na))}onUnsubscribe(){var t;this.hasListeners()||((t=E(this,dr))==null||t.call(this),X(this,dr,void 0))}setEventListener(t){var s;X(this,na,t),(s=E(this,dr))==null||s.call(this),X(this,dr,t(this.setOnline.bind(this)))}setOnline(t){E(this,ra)!==t&&(X(this,ra,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return E(this,ra)}},ra=new WeakMap,dr=new WeakMap,na=new WeakMap,wf),ao=new Bj;function Kj(e){return Math.min(1e3*2**e,3e4)}function ag(e){return(e??"online")==="online"?ao.isOnline():!0}var Cu=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function ig(e){let t=!1,s=0,n;const a=Su(),i=()=>a.status!=="pending",l=w=>{var _;if(!i()){const x=new Cu(w);f(x),(_=e.onCancel)==null||_.call(e,x)}},o=()=>{t=!0},c=()=>{t=!1},u=()=>Yd.isFocused()&&(e.networkMode==="always"||ao.isOnline())&&e.canRun(),d=()=>ag(e.networkMode)&&e.canRun(),m=w=>{i()||(n==null||n(),a.resolve(w))},f=w=>{i()||(n==null||n(),a.reject(w))},v=()=>new Promise(w=>{var _;n=x=>{(i()||u())&&w(x)},(_=e.onPause)==null||_.call(e)}).then(()=>{var w;n=void 0,i()||(w=e.onContinue)==null||w.call(e)}),g=()=>{if(i())return;let w;const _=s===0?e.initialPromise:void 0;try{w=_??e.fn()}catch(x){w=Promise.reject(x)}Promise.resolve(w).then(m).catch(x=>{var N;if(i())return;const p=e.retry??(pn?0:3),y=e.retryDelay??Kj,j=typeof y=="function"?y(s,x):y,b=p===!0||typeof p=="number"&&s<p||typeof p=="function"&&p(s,x);if(t||!b){f(x);return}s++,(N=e.onFail)==null||N.call(e,s,x),Mj(j).then(()=>u()?void 0:v()).then(()=>{t?f(x):g()})})};return{promise:a,status:()=>a.status,cancel:l,continue:()=>(n==null||n(),a),cancelRetry:o,continueRetry:c,canStart:d,start:()=>(d()?g():v().then(g),a)}}var Zr,_f,lg=(_f=class{constructor(){ie(this,Zr)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),bu(this.gcTime)&&X(this,Zr,Jr.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(pn?1/0:5*60*1e3))}clearGcTimeout(){E(this,Zr)&&(Jr.clearTimeout(E(this,Zr)),X(this,Zr,void 0))}},Zr=new WeakMap,_f),en,aa,Xt,tn,ot,qi,sn,hs,Is,bf,Wj=(bf=class extends lg{constructor(t){super();ie(this,hs);ie(this,en);ie(this,aa);ie(this,Xt);ie(this,tn);ie(this,ot);ie(this,qi);ie(this,sn);X(this,sn,!1),X(this,qi,t.defaultOptions),this.setOptions(t.options),this.observers=[],X(this,tn,t.client),X(this,Xt,E(this,tn).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,X(this,en,Om(this.options)),this.state=t.state??E(this,en),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=E(this,ot))==null?void 0:t.promise}setOptions(t){if(this.options={...E(this,qi),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const s=Om(this.options);s.data!==void 0&&(this.setState(Rm(s.data,s.dataUpdatedAt)),X(this,en,s))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&E(this,Xt).remove(this)}setData(t,s){const n=ku(this.state.data,t,this.options);return ve(this,hs,Is).call(this,{data:n,type:"success",dataUpdatedAt:s==null?void 0:s.updatedAt,manual:s==null?void 0:s.manual}),n}setState(t,s){ve(this,hs,Is).call(this,{type:"setState",state:t,setStateOptions:s})}cancel(t){var n,a;const s=(n=E(this,ot))==null?void 0:n.promise;return(a=E(this,ot))==null||a.cancel(t),s?s.then(Et).catch(Et):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(E(this,en))}isActive(){return this.observers.some(t=>Zt(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Jd||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Tr(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!tg(this.state.dataUpdatedAt,t)}onFocus(){var s;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(s=E(this,ot))==null||s.continue()}onOnline(){var s;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(s=E(this,ot))==null||s.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),E(this,Xt).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(s=>s!==t),this.observers.length||(E(this,ot)&&(E(this,sn)?E(this,ot).cancel({revert:!0}):E(this,ot).cancelRetry()),this.scheduleGc()),E(this,Xt).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||ve(this,hs,Is).call(this,{type:"invalidate"})}async fetch(t,s){var c,u,d,m,f,v,g,w,_,x,p,y;if(this.state.fetchStatus!=="idle"&&((c=E(this,ot))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(s!=null&&s.cancelRefetch))this.cancel({silent:!0});else if(E(this,ot))return E(this,ot).continueRetry(),E(this,ot).promise}if(t&&this.setOptions(t),!this.options.queryFn){const j=this.observers.find(b=>b.options.queryFn);j&&this.setOptions(j.options)}const n=new AbortController,a=j=>{Object.defineProperty(j,"signal",{enumerable:!0,get:()=>(X(this,sn,!0),n.signal)})},i=()=>{const j=rg(this.options,s),N=(()=>{const T={client:E(this,tn),queryKey:this.queryKey,meta:this.meta};return a(T),T})();return X(this,sn,!1),this.options.persister?this.options.persister(j,N,this):j(N)},o=(()=>{const j={fetchOptions:s,options:this.options,queryKey:this.queryKey,client:E(this,tn),state:this.state,fetchFn:i};return a(j),j})();(u=this.options.behavior)==null||u.onFetch(o,this),X(this,aa,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((d=o.fetchOptions)==null?void 0:d.meta))&&ve(this,hs,Is).call(this,{type:"fetch",meta:(m=o.fetchOptions)==null?void 0:m.meta}),X(this,ot,ig({initialPromise:s==null?void 0:s.initialPromise,fn:o.fetchFn,onCancel:j=>{j instanceof Cu&&j.revert&&this.setState({...E(this,aa),fetchStatus:"idle"}),n.abort()},onFail:(j,b)=>{ve(this,hs,Is).call(this,{type:"failed",failureCount:j,error:b})},onPause:()=>{ve(this,hs,Is).call(this,{type:"pause"})},onContinue:()=>{ve(this,hs,Is).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}));try{const j=await E(this,ot).start();if(j===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(j),(v=(f=E(this,Xt).config).onSuccess)==null||v.call(f,j,this),(w=(g=E(this,Xt).config).onSettled)==null||w.call(g,j,this.state.error,this),j}catch(j){if(j instanceof Cu){if(j.silent)return E(this,ot).promise;if(j.revert){if(this.state.data===void 0)throw j;return this.state.data}}throw ve(this,hs,Is).call(this,{type:"error",error:j}),(x=(_=E(this,Xt).config).onError)==null||x.call(_,j,this),(y=(p=E(this,Xt).config).onSettled)==null||y.call(p,this.state.data,j,this),j}finally{this.scheduleGc()}}},en=new WeakMap,aa=new WeakMap,Xt=new WeakMap,tn=new WeakMap,ot=new WeakMap,qi=new WeakMap,sn=new WeakMap,hs=new WeakSet,Is=function(t){const s=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...og(n.data,this.options),fetchMeta:t.meta??null};case"success":const a={...n,...Rm(t.data,t.dataUpdatedAt),dataUpdateCount:n.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return X(this,aa,t.manual?a:void 0),a;case"error":const i=t.error;return{...n,error:i,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=s(this.state),nt.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),E(this,Xt).notify({query:this,type:"updated",action:t})})},bf);function og(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:ag(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function Rm(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Om(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,s=t!==void 0,n=s?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:s?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}var At,_e,Mi,kt,rn,ia,Ls,hr,Li,la,oa,nn,an,mr,ca,Pe,Va,Eu,Pu,Tu,Ru,Ou,Au,Iu,cg,Nf,Vj=(Nf=class extends Pa{constructor(t,s){super();ie(this,Pe);ie(this,At);ie(this,_e);ie(this,Mi);ie(this,kt);ie(this,rn);ie(this,ia);ie(this,Ls);ie(this,hr);ie(this,Li);ie(this,la);ie(this,oa);ie(this,nn);ie(this,an);ie(this,mr);ie(this,ca,new Set);this.options=s,X(this,At,t),X(this,hr,null),X(this,Ls,Su()),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(E(this,_e).addObserver(this),Am(E(this,_e),this.options)?ve(this,Pe,Va).call(this):this.updateResult(),ve(this,Pe,Ru).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return $u(E(this,_e),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return $u(E(this,_e),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,ve(this,Pe,Ou).call(this),ve(this,Pe,Au).call(this),E(this,_e).removeObserver(this)}setOptions(t){const s=this.options,n=E(this,_e);if(this.options=E(this,At).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Zt(this.options.enabled,E(this,_e))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");ve(this,Pe,Iu).call(this),E(this,_e).setOptions(this.options),s._defaulted&&!no(this.options,s)&&E(this,At).getQueryCache().notify({type:"observerOptionsUpdated",query:E(this,_e),observer:this});const a=this.hasListeners();a&&Im(E(this,_e),n,this.options,s)&&ve(this,Pe,Va).call(this),this.updateResult(),a&&(E(this,_e)!==n||Zt(this.options.enabled,E(this,_e))!==Zt(s.enabled,E(this,_e))||Tr(this.options.staleTime,E(this,_e))!==Tr(s.staleTime,E(this,_e)))&&ve(this,Pe,Eu).call(this);const i=ve(this,Pe,Pu).call(this);a&&(E(this,_e)!==n||Zt(this.options.enabled,E(this,_e))!==Zt(s.enabled,E(this,_e))||i!==E(this,mr))&&ve(this,Pe,Tu).call(this,i)}getOptimisticResult(t){const s=E(this,At).getQueryCache().build(E(this,At),t),n=this.createResult(s,t);return Qj(this,n)&&(X(this,kt,n),X(this,ia,this.options),X(this,rn,E(this,_e).state)),n}getCurrentResult(){return E(this,kt)}trackResult(t,s){return new Proxy(t,{get:(n,a)=>(this.trackProp(a),s==null||s(a),a==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&E(this,Ls).status==="pending"&&E(this,Ls).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,a))})}trackProp(t){E(this,ca).add(t)}getCurrentQuery(){return E(this,_e)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const s=E(this,At).defaultQueryOptions(t),n=E(this,At).getQueryCache().build(E(this,At),s);return n.fetch().then(()=>this.createResult(n,s))}fetch(t){return ve(this,Pe,Va).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),E(this,kt)))}createResult(t,s){var R;const n=E(this,_e),a=this.options,i=E(this,kt),l=E(this,rn),o=E(this,ia),u=t!==n?t.state:E(this,Mi),{state:d}=t;let m={...d},f=!1,v;if(s._optimisticResults){const P=this.hasListeners(),U=!P&&Am(t,s),W=P&&Im(t,n,s,a);(U||W)&&(m={...m,...og(d.data,t.options)}),s._optimisticResults==="isRestoring"&&(m.fetchStatus="idle")}let{error:g,errorUpdatedAt:w,status:_}=m;v=m.data;let x=!1;if(s.placeholderData!==void 0&&v===void 0&&_==="pending"){let P;i!=null&&i.isPlaceholderData&&s.placeholderData===(o==null?void 0:o.placeholderData)?(P=i.data,x=!0):P=typeof s.placeholderData=="function"?s.placeholderData((R=E(this,oa))==null?void 0:R.state.data,E(this,oa)):s.placeholderData,P!==void 0&&(_="success",v=ku(i==null?void 0:i.data,P,s),f=!0)}if(s.select&&v!==void 0&&!x)if(i&&v===(l==null?void 0:l.data)&&s.select===E(this,Li))v=E(this,la);else try{X(this,Li,s.select),v=s.select(v),v=ku(i==null?void 0:i.data,v,s),X(this,la,v),X(this,hr,null)}catch(P){X(this,hr,P)}E(this,hr)&&(g=E(this,hr),v=E(this,la),w=Date.now(),_="error");const p=m.fetchStatus==="fetching",y=_==="pending",j=_==="error",b=y&&p,N=v!==void 0,h={status:_,fetchStatus:m.fetchStatus,isPending:y,isSuccess:_==="success",isError:j,isInitialLoading:b,isLoading:b,data:v,dataUpdatedAt:m.dataUpdatedAt,error:g,errorUpdatedAt:w,failureCount:m.fetchFailureCount,failureReason:m.fetchFailureReason,errorUpdateCount:m.errorUpdateCount,isFetched:m.dataUpdateCount>0||m.errorUpdateCount>0,isFetchedAfterMount:m.dataUpdateCount>u.dataUpdateCount||m.errorUpdateCount>u.errorUpdateCount,isFetching:p,isRefetching:p&&!y,isLoadingError:j&&!N,isPaused:m.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:j&&N,isStale:Xd(t,s),refetch:this.refetch,promise:E(this,Ls),isEnabled:Zt(s.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const P=ee=>{h.status==="error"?ee.reject(h.error):h.data!==void 0&&ee.resolve(h.data)},U=()=>{const ee=X(this,Ls,h.promise=Su());P(ee)},W=E(this,Ls);switch(W.status){case"pending":t.queryHash===n.queryHash&&P(W);break;case"fulfilled":(h.status==="error"||h.data!==W.value)&&U();break;case"rejected":(h.status!=="error"||h.error!==W.reason)&&U();break}}return h}updateResult(){const t=E(this,kt),s=this.createResult(E(this,_e),this.options);if(X(this,rn,E(this,_e).state),X(this,ia,this.options),E(this,rn).data!==void 0&&X(this,oa,E(this,_e)),no(s,t))return;X(this,kt,s);const n=()=>{if(!t)return!0;const{notifyOnChangeProps:a}=this.options,i=typeof a=="function"?a():a;if(i==="all"||!i&&!E(this,ca).size)return!0;const l=new Set(i??E(this,ca));return this.options.throwOnError&&l.add("error"),Object.keys(E(this,kt)).some(o=>{const c=o;return E(this,kt)[c]!==t[c]&&l.has(c)})};ve(this,Pe,cg).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&ve(this,Pe,Ru).call(this)}},At=new WeakMap,_e=new WeakMap,Mi=new WeakMap,kt=new WeakMap,rn=new WeakMap,ia=new WeakMap,Ls=new WeakMap,hr=new WeakMap,Li=new WeakMap,la=new WeakMap,oa=new WeakMap,nn=new WeakMap,an=new WeakMap,mr=new WeakMap,ca=new WeakMap,Pe=new WeakSet,Va=function(t){ve(this,Pe,Iu).call(this);let s=E(this,_e).fetch(this.options,t);return t!=null&&t.throwOnError||(s=s.catch(Et)),s},Eu=function(){ve(this,Pe,Ou).call(this);const t=Tr(this.options.staleTime,E(this,_e));if(pn||E(this,kt).isStale||!bu(t))return;const n=tg(E(this,kt).dataUpdatedAt,t)+1;X(this,nn,Jr.setTimeout(()=>{E(this,kt).isStale||this.updateResult()},n))},Pu=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(E(this,_e)):this.options.refetchInterval)??!1},Tu=function(t){ve(this,Pe,Au).call(this),X(this,mr,t),!(pn||Zt(this.options.enabled,E(this,_e))===!1||!bu(E(this,mr))||E(this,mr)===0)&&X(this,an,Jr.setInterval(()=>{(this.options.refetchIntervalInBackground||Yd.isFocused())&&ve(this,Pe,Va).call(this)},E(this,mr)))},Ru=function(){ve(this,Pe,Eu).call(this),ve(this,Pe,Tu).call(this,ve(this,Pe,Pu).call(this))},Ou=function(){E(this,nn)&&(Jr.clearTimeout(E(this,nn)),X(this,nn,void 0))},Au=function(){E(this,an)&&(Jr.clearInterval(E(this,an)),X(this,an,void 0))},Iu=function(){const t=E(this,At).getQueryCache().build(E(this,At),this.options);if(t===E(this,_e))return;const s=E(this,_e);X(this,_e,t),X(this,Mi,t.state),this.hasListeners()&&(s==null||s.removeObserver(this),t.addObserver(this))},cg=function(t){nt.batch(()=>{t.listeners&&this.listeners.forEach(s=>{s(E(this,kt))}),E(this,At).getQueryCache().notify({query:E(this,_e),type:"observerResultsUpdated"})})},Nf);function Hj(e,t){return Zt(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function Am(e,t){return Hj(e,t)||e.state.data!==void 0&&$u(e,t,t.refetchOnMount)}function $u(e,t,s){if(Zt(t.enabled,e)!==!1&&Tr(t.staleTime,e)!=="static"){const n=typeof s=="function"?s(e):s;return n==="always"||n!==!1&&Xd(e,t)}return!1}function Im(e,t,s,n){return(e!==t||Zt(n.enabled,e)===!1)&&(!s.suspense||e.state.status!=="error")&&Xd(e,s)}function Xd(e,t){return Zt(t.enabled,e)!==!1&&e.isStaleByTime(Tr(t.staleTime,e))}function Qj(e,t){return!no(e.getCurrentResult(),t)}function $m(e){return{onFetch:(t,s)=>{var d,m,f,v,g;const n=t.options,a=(f=(m=(d=t.fetchOptions)==null?void 0:d.meta)==null?void 0:m.fetchMore)==null?void 0:f.direction,i=((v=t.state.data)==null?void 0:v.pages)||[],l=((g=t.state.data)==null?void 0:g.pageParams)||[];let o={pages:[],pageParams:[]},c=0;const u=async()=>{let w=!1;const _=y=>{Object.defineProperty(y,"signal",{enumerable:!0,get:()=>(t.signal.aborted?w=!0:t.signal.addEventListener("abort",()=>{w=!0}),t.signal)})},x=rg(t.options,t.fetchOptions),p=async(y,j,b)=>{if(w)return Promise.reject();if(j==null&&y.pages.length)return Promise.resolve(y);const T=(()=>{const U={client:t.client,queryKey:t.queryKey,pageParam:j,direction:b?"backward":"forward",meta:t.options.meta};return _(U),U})(),h=await x(T),{maxPages:R}=t.options,P=b?Dj:Lj;return{pages:P(y.pages,h,R),pageParams:P(y.pageParams,j,R)}};if(a&&i.length){const y=a==="backward",j=y?Gj:qm,b={pages:i,pageParams:l},N=j(n,b);o=await p(b,N,y)}else{const y=e??i.length;do{const j=c===0?l[0]??n.initialPageParam:qm(n,o);if(c>0&&j==null)break;o=await p(o,j),c++}while(c<y)}return o};t.options.persister?t.fetchFn=()=>{var w,_;return(_=(w=t.options).persister)==null?void 0:_.call(w,u,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},s)}:t.fetchFn=u}}}function qm(e,{pages:t,pageParams:s}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,s[n],s):void 0}function Gj(e,{pages:t,pageParams:s}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,s[0],s):void 0}var Di,ks,St,ln,Ss,sr,kf,Jj=(kf=class extends lg{constructor(t){super();ie(this,Ss);ie(this,Di);ie(this,ks);ie(this,St);ie(this,ln);X(this,Di,t.client),this.mutationId=t.mutationId,X(this,St,t.mutationCache),X(this,ks,[]),this.state=t.state||ug(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){E(this,ks).includes(t)||(E(this,ks).push(t),this.clearGcTimeout(),E(this,St).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){X(this,ks,E(this,ks).filter(s=>s!==t)),this.scheduleGc(),E(this,St).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){E(this,ks).length||(this.state.status==="pending"?this.scheduleGc():E(this,St).remove(this))}continue(){var t;return((t=E(this,ln))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var l,o,c,u,d,m,f,v,g,w,_,x,p,y,j,b,N,T,h,R;const s=()=>{ve(this,Ss,sr).call(this,{type:"continue"})},n={client:E(this,Di),meta:this.options.meta,mutationKey:this.options.mutationKey};X(this,ln,ig({fn:()=>this.options.mutationFn?this.options.mutationFn(t,n):Promise.reject(new Error("No mutationFn found")),onFail:(P,U)=>{ve(this,Ss,sr).call(this,{type:"failed",failureCount:P,error:U})},onPause:()=>{ve(this,Ss,sr).call(this,{type:"pause"})},onContinue:s,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>E(this,St).canRun(this)}));const a=this.state.status==="pending",i=!E(this,ln).canStart();try{if(a)s();else{ve(this,Ss,sr).call(this,{type:"pending",variables:t,isPaused:i}),await((o=(l=E(this,St).config).onMutate)==null?void 0:o.call(l,t,this,n));const U=await((u=(c=this.options).onMutate)==null?void 0:u.call(c,t,n));U!==this.state.context&&ve(this,Ss,sr).call(this,{type:"pending",context:U,variables:t,isPaused:i})}const P=await E(this,ln).start();return await((m=(d=E(this,St).config).onSuccess)==null?void 0:m.call(d,P,t,this.state.context,this,n)),await((v=(f=this.options).onSuccess)==null?void 0:v.call(f,P,t,this.state.context,n)),await((w=(g=E(this,St).config).onSettled)==null?void 0:w.call(g,P,null,this.state.variables,this.state.context,this,n)),await((x=(_=this.options).onSettled)==null?void 0:x.call(_,P,null,t,this.state.context,n)),ve(this,Ss,sr).call(this,{type:"success",data:P}),P}catch(P){try{throw await((y=(p=E(this,St).config).onError)==null?void 0:y.call(p,P,t,this.state.context,this,n)),await((b=(j=this.options).onError)==null?void 0:b.call(j,P,t,this.state.context,n)),await((T=(N=E(this,St).config).onSettled)==null?void 0:T.call(N,void 0,P,this.state.variables,this.state.context,this,n)),await((R=(h=this.options).onSettled)==null?void 0:R.call(h,void 0,P,t,this.state.context,n)),P}finally{ve(this,Ss,sr).call(this,{type:"error",error:P})}}finally{E(this,St).runNext(this)}}},Di=new WeakMap,ks=new WeakMap,St=new WeakMap,ln=new WeakMap,Ss=new WeakSet,sr=function(t){const s=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=s(this.state),nt.batch(()=>{E(this,ks).forEach(n=>{n.onMutationUpdate(t)}),E(this,St).notify({mutation:this,type:"updated",action:t})})},kf);function ug(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Ds,ms,Fi,Sf,Yj=(Sf=class extends Pa{constructor(t={}){super();ie(this,Ds);ie(this,ms);ie(this,Fi);this.config=t,X(this,Ds,new Set),X(this,ms,new Map),X(this,Fi,0)}build(t,s,n){const a=new Jj({client:t,mutationCache:this,mutationId:++Qi(this,Fi)._,options:t.defaultMutationOptions(s),state:n});return this.add(a),a}add(t){E(this,Ds).add(t);const s=hl(t);if(typeof s=="string"){const n=E(this,ms).get(s);n?n.push(t):E(this,ms).set(s,[t])}this.notify({type:"added",mutation:t})}remove(t){if(E(this,Ds).delete(t)){const s=hl(t);if(typeof s=="string"){const n=E(this,ms).get(s);if(n)if(n.length>1){const a=n.indexOf(t);a!==-1&&n.splice(a,1)}else n[0]===t&&E(this,ms).delete(s)}}this.notify({type:"removed",mutation:t})}canRun(t){const s=hl(t);if(typeof s=="string"){const n=E(this,ms).get(s),a=n==null?void 0:n.find(i=>i.state.status==="pending");return!a||a===t}else return!0}runNext(t){var n;const s=hl(t);if(typeof s=="string"){const a=(n=E(this,ms).get(s))==null?void 0:n.find(i=>i!==t&&i.state.isPaused);return(a==null?void 0:a.continue())??Promise.resolve()}else return Promise.resolve()}clear(){nt.batch(()=>{E(this,Ds).forEach(t=>{this.notify({type:"removed",mutation:t})}),E(this,Ds).clear(),E(this,ms).clear()})}getAll(){return Array.from(E(this,Ds))}find(t){const s={exact:!0,...t};return this.getAll().find(n=>Em(s,n))}findAll(t={}){return this.getAll().filter(s=>Em(t,s))}notify(t){nt.batch(()=>{this.listeners.forEach(s=>{s(t)})})}resumePausedMutations(){const t=this.getAll().filter(s=>s.state.isPaused);return nt.batch(()=>Promise.all(t.map(s=>s.continue().catch(Et))))}},Ds=new WeakMap,ms=new WeakMap,Fi=new WeakMap,Sf);function hl(e){var t;return(t=e.options.scope)==null?void 0:t.id}var Fs,fr,It,Us,Ws,Ol,qu,Cf,Xj=(Cf=class extends Pa{constructor(s,n){super();ie(this,Ws);ie(this,Fs);ie(this,fr);ie(this,It);ie(this,Us);X(this,Fs,s),this.setOptions(n),this.bindMethods(),ve(this,Ws,Ol).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(s){var a;const n=this.options;this.options=E(this,Fs).defaultMutationOptions(s),no(this.options,n)||E(this,Fs).getMutationCache().notify({type:"observerOptionsUpdated",mutation:E(this,It),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&xn(n.mutationKey)!==xn(this.options.mutationKey)?this.reset():((a=E(this,It))==null?void 0:a.state.status)==="pending"&&E(this,It).setOptions(this.options)}onUnsubscribe(){var s;this.hasListeners()||(s=E(this,It))==null||s.removeObserver(this)}onMutationUpdate(s){ve(this,Ws,Ol).call(this),ve(this,Ws,qu).call(this,s)}getCurrentResult(){return E(this,fr)}reset(){var s;(s=E(this,It))==null||s.removeObserver(this),X(this,It,void 0),ve(this,Ws,Ol).call(this),ve(this,Ws,qu).call(this)}mutate(s,n){var a;return X(this,Us,n),(a=E(this,It))==null||a.removeObserver(this),X(this,It,E(this,Fs).getMutationCache().build(E(this,Fs),this.options)),E(this,It).addObserver(this),E(this,It).execute(s)}},Fs=new WeakMap,fr=new WeakMap,It=new WeakMap,Us=new WeakMap,Ws=new WeakSet,Ol=function(){var n;const s=((n=E(this,It))==null?void 0:n.state)??ug();X(this,fr,{...s,isPending:s.status==="pending",isSuccess:s.status==="success",isError:s.status==="error",isIdle:s.status==="idle",mutate:this.mutate,reset:this.reset})},qu=function(s){nt.batch(()=>{var n,a,i,l,o,c,u,d;if(E(this,Us)&&this.hasListeners()){const m=E(this,fr).variables,f=E(this,fr).context,v={client:E(this,Fs),meta:this.options.meta,mutationKey:this.options.mutationKey};(s==null?void 0:s.type)==="success"?((a=(n=E(this,Us)).onSuccess)==null||a.call(n,s.data,m,f,v),(l=(i=E(this,Us)).onSettled)==null||l.call(i,s.data,null,m,f,v)):(s==null?void 0:s.type)==="error"&&((c=(o=E(this,Us)).onError)==null||c.call(o,s.error,m,f,v),(d=(u=E(this,Us)).onSettled)==null||d.call(u,void 0,s.error,m,f,v))}this.listeners.forEach(m=>{m(E(this,fr))})})},Cf),Cs,Ef,Zj=(Ef=class extends Pa{constructor(t={}){super();ie(this,Cs);this.config=t,X(this,Cs,new Map)}build(t,s,n){const a=s.queryKey,i=s.queryHash??Gd(a,s);let l=this.get(i);return l||(l=new Wj({client:t,queryKey:a,queryHash:i,options:t.defaultQueryOptions(s),state:n,defaultOptions:t.getQueryDefaults(a)}),this.add(l)),l}add(t){E(this,Cs).has(t.queryHash)||(E(this,Cs).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const s=E(this,Cs).get(t.queryHash);s&&(t.destroy(),s===t&&E(this,Cs).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){nt.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return E(this,Cs).get(t)}getAll(){return[...E(this,Cs).values()]}find(t){const s={exact:!0,...t};return this.getAll().find(n=>Cm(s,n))}findAll(t={}){const s=this.getAll();return Object.keys(t).length>0?s.filter(n=>Cm(t,n)):s}notify(t){nt.batch(()=>{this.listeners.forEach(s=>{s(t)})})}onFocus(){nt.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){nt.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Cs=new WeakMap,Ef),Ve,pr,xr,ua,da,gr,ha,ma,Pf,ew=(Pf=class{constructor(e={}){ie(this,Ve);ie(this,pr);ie(this,xr);ie(this,ua);ie(this,da);ie(this,gr);ie(this,ha);ie(this,ma);X(this,Ve,e.queryCache||new Zj),X(this,pr,e.mutationCache||new Yj),X(this,xr,e.defaultOptions||{}),X(this,ua,new Map),X(this,da,new Map),X(this,gr,0)}mount(){Qi(this,gr)._++,E(this,gr)===1&&(X(this,ha,Yd.subscribe(async e=>{e&&(await this.resumePausedMutations(),E(this,Ve).onFocus())})),X(this,ma,ao.subscribe(async e=>{e&&(await this.resumePausedMutations(),E(this,Ve).onOnline())})))}unmount(){var e,t;Qi(this,gr)._--,E(this,gr)===0&&((e=E(this,ha))==null||e.call(this),X(this,ha,void 0),(t=E(this,ma))==null||t.call(this),X(this,ma,void 0))}isFetching(e){return E(this,Ve).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return E(this,pr).findAll({...e,status:"pending"}).length}getQueryData(e){var s;const t=this.defaultQueryOptions({queryKey:e});return(s=E(this,Ve).get(t.queryHash))==null?void 0:s.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),s=E(this,Ve).build(this,t),n=s.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&s.isStaleByTime(Tr(t.staleTime,s))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return E(this,Ve).findAll(e).map(({queryKey:t,state:s})=>{const n=s.data;return[t,n]})}setQueryData(e,t,s){const n=this.defaultQueryOptions({queryKey:e}),a=E(this,Ve).get(n.queryHash),i=a==null?void 0:a.state.data,l=$j(t,i);if(l!==void 0)return E(this,Ve).build(this,n).setData(l,{...s,manual:!0})}setQueriesData(e,t,s){return nt.batch(()=>E(this,Ve).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,s)]))}getQueryState(e){var s;const t=this.defaultQueryOptions({queryKey:e});return(s=E(this,Ve).get(t.queryHash))==null?void 0:s.state}removeQueries(e){const t=E(this,Ve);nt.batch(()=>{t.findAll(e).forEach(s=>{t.remove(s)})})}resetQueries(e,t){const s=E(this,Ve);return nt.batch(()=>(s.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const s={revert:!0,...t},n=nt.batch(()=>E(this,Ve).findAll(e).map(a=>a.cancel(s)));return Promise.all(n).then(Et).catch(Et)}invalidateQueries(e,t={}){return nt.batch(()=>(E(this,Ve).findAll(e).forEach(s=>{s.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const s={...t,cancelRefetch:t.cancelRefetch??!0},n=nt.batch(()=>E(this,Ve).findAll(e).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let i=a.fetch(void 0,s);return s.throwOnError||(i=i.catch(Et)),a.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(n).then(Et)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const s=E(this,Ve).build(this,t);return s.isStaleByTime(Tr(t.staleTime,s))?s.fetch(t):Promise.resolve(s.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Et).catch(Et)}fetchInfiniteQuery(e){return e.behavior=$m(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Et).catch(Et)}ensureInfiniteQueryData(e){return e.behavior=$m(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return ao.isOnline()?E(this,pr).resumePausedMutations():Promise.resolve()}getQueryCache(){return E(this,Ve)}getMutationCache(){return E(this,pr)}getDefaultOptions(){return E(this,xr)}setDefaultOptions(e){X(this,xr,e)}setQueryDefaults(e,t){E(this,ua).set(xn(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...E(this,ua).values()],s={};return t.forEach(n=>{Si(e,n.queryKey)&&Object.assign(s,n.defaultOptions)}),s}setMutationDefaults(e,t){E(this,da).set(xn(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...E(this,da).values()],s={};return t.forEach(n=>{Si(e,n.mutationKey)&&Object.assign(s,n.defaultOptions)}),s}defaultQueryOptions(e){if(e._defaulted)return e;const t={...E(this,xr).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=Gd(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Jd&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...E(this,xr).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){E(this,Ve).clear(),E(this,pr).clear()}},Ve=new WeakMap,pr=new WeakMap,xr=new WeakMap,ua=new WeakMap,da=new WeakMap,gr=new WeakMap,ha=new WeakMap,ma=new WeakMap,Pf),dg=S.createContext(void 0),ht=e=>{const t=S.useContext(dg);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},tw=({client:e,children:t})=>(S.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),r.jsx(dg.Provider,{value:e,children:t})),hg=S.createContext(!1),sw=()=>S.useContext(hg);hg.Provider;function rw(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var nw=S.createContext(rw()),aw=()=>S.useContext(nw),iw=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},lw=e=>{S.useEffect(()=>{e.clearReset()},[e])},ow=({result:e,errorResetBoundary:t,throwOnError:s,query:n,suspense:a})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&(a&&e.data===void 0||ng(s,[e.error,n])),cw=e=>{if(e.suspense){const s=a=>a==="static"?a:Math.max(a??1e3,1e3),n=e.staleTime;e.staleTime=typeof n=="function"?(...a)=>s(n(...a)):s(n),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},uw=(e,t)=>e.isLoading&&e.isFetching&&!t,dw=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,Mm=(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()});function hw(e,t,s){var m,f,v,g,w;const n=sw(),a=aw(),i=ht(),l=i.defaultQueryOptions(e);(f=(m=i.getDefaultOptions().queries)==null?void 0:m._experimental_beforeQuery)==null||f.call(m,l),l._optimisticResults=n?"isRestoring":"optimistic",cw(l),iw(l,a),lw(a);const o=!i.getQueryCache().get(l.queryHash),[c]=S.useState(()=>new t(i,l)),u=c.getOptimisticResult(l),d=!n&&e.subscribed!==!1;if(S.useSyncExternalStore(S.useCallback(_=>{const x=d?c.subscribe(nt.batchCalls(_)):Et;return c.updateResult(),x},[c,d]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),S.useEffect(()=>{c.setOptions(l)},[l,c]),dw(l,u))throw Mm(l,c,a);if(ow({result:u,errorResetBoundary:a,throwOnError:l.throwOnError,query:i.getQueryCache().get(l.queryHash),suspense:l.suspense}))throw u.error;if((g=(v=i.getDefaultOptions().queries)==null?void 0:v._experimental_afterQuery)==null||g.call(v,l,u),l.experimental_prefetchInRender&&!pn&&uw(u,n)){const _=o?Mm(l,c,a):(w=i.getQueryCache().get(l.queryHash))==null?void 0:w.promise;_==null||_.catch(Et).finally(()=>{c.updateResult()})}return l.notifyOnChangeProps?u:c.trackResult(u)}function se(e,t){return hw(e,Vj)}function dt(e,t){const s=ht(),[n]=S.useState(()=>new Xj(s,e));S.useEffect(()=>{n.setOptions(e)},[n,e]);const a=S.useSyncExternalStore(S.useCallback(l=>n.subscribe(nt.batchCalls(l)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),i=S.useCallback((l,o)=>{n.mutate(l,o).catch(Et)},[n]);if(a.error&&ng(n.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:i,mutateAsync:a.mutate}}const mw={},Lm=e=>{let t;const s=new Set,n=(d,m)=>{const f=typeof d=="function"?d(t):d;if(!Object.is(f,t)){const v=t;t=m??(typeof f!="object"||f===null)?f:Object.assign({},t,f),s.forEach(g=>g(t,v))}},a=()=>t,c={setState:n,getState:a,getInitialState:()=>u,subscribe:d=>(s.add(d),()=>s.delete(d)),destroy:()=>{(mw?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),s.clear()}},u=t=e(n,a,c);return c},fw=e=>e?Lm(e):Lm;var mg={exports:{}},fg={},pg={exports:{}},xg={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wa=S;function pw(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var xw=typeof Object.is=="function"?Object.is:pw,gw=wa.useState,yw=wa.useEffect,vw=wa.useLayoutEffect,jw=wa.useDebugValue;function ww(e,t){var s=t(),n=gw({inst:{value:s,getSnapshot:t}}),a=n[0].inst,i=n[1];return vw(function(){a.value=s,a.getSnapshot=t,pc(a)&&i({inst:a})},[e,s,t]),yw(function(){return pc(a)&&i({inst:a}),e(function(){pc(a)&&i({inst:a})})},[e]),jw(s),s}function pc(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!xw(e,s)}catch{return!0}}function _w(e,t){return t()}var bw=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?_w:ww;xg.useSyncExternalStore=wa.useSyncExternalStore!==void 0?wa.useSyncExternalStore:bw;pg.exports=xg;var Nw=pg.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ao=S,kw=Nw;function Sw(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Cw=typeof Object.is=="function"?Object.is:Sw,Ew=kw.useSyncExternalStore,Pw=Ao.useRef,Tw=Ao.useEffect,Rw=Ao.useMemo,Ow=Ao.useDebugValue;fg.useSyncExternalStoreWithSelector=function(e,t,s,n,a){var i=Pw(null);if(i.current===null){var l={hasValue:!1,value:null};i.current=l}else l=i.current;i=Rw(function(){function c(v){if(!u){if(u=!0,d=v,v=n(v),a!==void 0&&l.hasValue){var g=l.value;if(a(g,v))return m=g}return m=v}if(g=m,Cw(d,v))return g;var w=n(v);return a!==void 0&&a(g,w)?(d=v,g):(d=v,m=w)}var u=!1,d,m,f=s===void 0?null:s;return[function(){return c(t())},f===null?void 0:function(){return c(f())}]},[t,s,n,a]);var o=Ew(e,i[0],i[1]);return Tw(function(){l.hasValue=!0,l.value=o},[o]),Ow(o),o};mg.exports=fg;var Aw=mg.exports;const Iw=Tf(Aw),gg={},{useDebugValue:$w}=is,{useSyncExternalStoreWithSelector:qw}=Iw;let Dm=!1;const Mw=e=>e;function Lw(e,t=Mw,s){(gg?"production":void 0)!=="production"&&s&&!Dm&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Dm=!0);const n=qw(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,s);return $w(n),n}const Dw=e=>{(gg?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?fw(e):e,s=(n,a)=>Lw(t,n,a);return Object.assign(s,t),s},Fw=e=>Dw,Uw={};function zw(e,t){let s;try{s=e()}catch{return}return{getItem:a=>{var i;const l=c=>c===null?null:JSON.parse(c,void 0),o=(i=s.getItem(a))!=null?i:null;return o instanceof Promise?o.then(l):l(o)},setItem:(a,i)=>s.setItem(a,JSON.stringify(i,void 0)),removeItem:a=>s.removeItem(a)}}const Ci=e=>t=>{try{const s=e(t);return s instanceof Promise?s:{then(n){return Ci(n)(s)},catch(n){return this}}}catch(s){return{then(n){return this},catch(n){return Ci(n)(s)}}}},Bw=(e,t)=>(s,n,a)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:_=>_,version:0,merge:(_,x)=>({...x,..._}),...t},l=!1;const o=new Set,c=new Set;let u;try{u=i.getStorage()}catch{}if(!u)return e((..._)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),s(..._)},n,a);const d=Ci(i.serialize),m=()=>{const _=i.partialize({...n()});let x;const p=d({state:_,version:i.version}).then(y=>u.setItem(i.name,y)).catch(y=>{x=y});if(x)throw x;return p},f=a.setState;a.setState=(_,x)=>{f(_,x),m()};const v=e((..._)=>{s(..._),m()},n,a);let g;const w=()=>{var _;if(!u)return;l=!1,o.forEach(p=>p(n()));const x=((_=i.onRehydrateStorage)==null?void 0:_.call(i,n()))||void 0;return Ci(u.getItem.bind(u))(i.name).then(p=>{if(p)return i.deserialize(p)}).then(p=>{if(p)if(typeof p.version=="number"&&p.version!==i.version){if(i.migrate)return i.migrate(p.state,p.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return p.state}).then(p=>{var y;return g=i.merge(p,(y=n())!=null?y:v),s(g,!0),m()}).then(()=>{x==null||x(g,void 0),l=!0,c.forEach(p=>p(g))}).catch(p=>{x==null||x(void 0,p)})};return a.persist={setOptions:_=>{i={...i,..._},_.getStorage&&(u=_.getStorage())},clearStorage:()=>{u==null||u.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>w(),hasHydrated:()=>l,onHydrate:_=>(o.add(_),()=>{o.delete(_)}),onFinishHydration:_=>(c.add(_),()=>{c.delete(_)})},w(),g||v},Kw=(e,t)=>(s,n,a)=>{let i={storage:zw(()=>localStorage),partialize:w=>w,version:0,merge:(w,_)=>({..._,...w}),...t},l=!1;const o=new Set,c=new Set;let u=i.storage;if(!u)return e((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),s(...w)},n,a);const d=()=>{const w=i.partialize({...n()});return u.setItem(i.name,{state:w,version:i.version})},m=a.setState;a.setState=(w,_)=>{m(w,_),d()};const f=e((...w)=>{s(...w),d()},n,a);a.getInitialState=()=>f;let v;const g=()=>{var w,_;if(!u)return;l=!1,o.forEach(p=>{var y;return p((y=n())!=null?y:f)});const x=((_=i.onRehydrateStorage)==null?void 0:_.call(i,(w=n())!=null?w:f))||void 0;return Ci(u.getItem.bind(u))(i.name).then(p=>{if(p)if(typeof p.version=="number"&&p.version!==i.version){if(i.migrate)return[!0,i.migrate(p.state,p.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,p.state];return[!1,void 0]}).then(p=>{var y;const[j,b]=p;if(v=i.merge(b,(y=n())!=null?y:f),s(v,!0),j)return d()}).then(()=>{x==null||x(v,void 0),v=n(),l=!0,c.forEach(p=>p(v))}).catch(p=>{x==null||x(void 0,p)})};return a.persist={setOptions:w=>{i={...i,...w},w.storage&&(u=w.storage)},clearStorage:()=>{u==null||u.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>g(),hasHydrated:()=>l,onHydrate:w=>(o.add(w),()=>{o.delete(w)}),onFinishHydration:w=>(c.add(w),()=>{c.delete(w)})},i.skipHydration||g(),v||f},Ww=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((Uw?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Bw(e,t)):Kw(e,t),Vw=Ww,Zd=Fw()(Vw(e=>({user:null,isAuthenticated:!1,login:t=>e({user:t,isAuthenticated:!0}),logout:()=>e({user:null,isAuthenticated:!1})}),{name:"auth-storage"}));function yg(e){var t,s,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(s=yg(e[t]))&&(n&&(n+=" "),n+=s)}else for(s in e)e[s]&&(n&&(n+=" "),n+=s);return n}function vg(){for(var e,t,s=0,n="",a=arguments.length;s<a;s++)(e=arguments[s])&&(t=yg(e))&&(n&&(n+=" "),n+=t);return n}const eh="-",Hw=e=>{const t=Gw(e),{conflictingClassGroups:s,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:l=>{const o=l.split(eh);return o[0]===""&&o.length!==1&&o.shift(),jg(o,t)||Qw(l)},getConflictingClassGroupIds:(l,o)=>{const c=s[l]||[];return o&&n[l]?[...c,...n[l]]:c}}},jg=(e,t)=>{var l;if(e.length===0)return t.classGroupId;const s=e[0],n=t.nextPart.get(s),a=n?jg(e.slice(1),n):void 0;if(a)return a;if(t.validators.length===0)return;const i=e.join(eh);return(l=t.validators.find(({validator:o})=>o(i)))==null?void 0:l.classGroupId},Fm=/^\[(.+)\]$/,Qw=e=>{if(Fm.test(e)){const t=Fm.exec(e)[1],s=t==null?void 0:t.substring(0,t.indexOf(":"));if(s)return"arbitrary.."+s}},Gw=e=>{const{theme:t,prefix:s}=e,n={nextPart:new Map,validators:[]};return Yw(Object.entries(e.classGroups),s).forEach(([i,l])=>{Mu(l,n,i,t)}),n},Mu=(e,t,s,n)=>{e.forEach(a=>{if(typeof a=="string"){const i=a===""?t:Um(t,a);i.classGroupId=s;return}if(typeof a=="function"){if(Jw(a)){Mu(a(n),t,s,n);return}t.validators.push({validator:a,classGroupId:s});return}Object.entries(a).forEach(([i,l])=>{Mu(l,Um(t,i),s,n)})})},Um=(e,t)=>{let s=e;return t.split(eh).forEach(n=>{s.nextPart.has(n)||s.nextPart.set(n,{nextPart:new Map,validators:[]}),s=s.nextPart.get(n)}),s},Jw=e=>e.isThemeGetter,Yw=(e,t)=>t?e.map(([s,n])=>{const a=n.map(i=>typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([l,o])=>[t+l,o])):i);return[s,a]}):e,Xw=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,s=new Map,n=new Map;const a=(i,l)=>{s.set(i,l),t++,t>e&&(t=0,n=s,s=new Map)};return{get(i){let l=s.get(i);if(l!==void 0)return l;if((l=n.get(i))!==void 0)return a(i,l),l},set(i,l){s.has(i)?s.set(i,l):a(i,l)}}},wg="!",Zw=e=>{const{separator:t,experimentalParseClassName:s}=e,n=t.length===1,a=t[0],i=t.length,l=o=>{const c=[];let u=0,d=0,m;for(let _=0;_<o.length;_++){let x=o[_];if(u===0){if(x===a&&(n||o.slice(_,_+i)===t)){c.push(o.slice(d,_)),d=_+i;continue}if(x==="/"){m=_;continue}}x==="["?u++:x==="]"&&u--}const f=c.length===0?o:o.substring(d),v=f.startsWith(wg),g=v?f.substring(1):f,w=m&&m>d?m-d:void 0;return{modifiers:c,hasImportantModifier:v,baseClassName:g,maybePostfixModifierPosition:w}};return s?o=>s({className:o,parseClassName:l}):l},e_=e=>{if(e.length<=1)return e;const t=[];let s=[];return e.forEach(n=>{n[0]==="["?(t.push(...s.sort(),n),s=[]):s.push(n)}),t.push(...s.sort()),t},t_=e=>({cache:Xw(e.cacheSize),parseClassName:Zw(e),...Hw(e)}),s_=/\s+/,r_=(e,t)=>{const{parseClassName:s,getClassGroupId:n,getConflictingClassGroupIds:a}=t,i=[],l=e.trim().split(s_);let o="";for(let c=l.length-1;c>=0;c-=1){const u=l[c],{modifiers:d,hasImportantModifier:m,baseClassName:f,maybePostfixModifierPosition:v}=s(u);let g=!!v,w=n(g?f.substring(0,v):f);if(!w){if(!g){o=u+(o.length>0?" "+o:o);continue}if(w=n(f),!w){o=u+(o.length>0?" "+o:o);continue}g=!1}const _=e_(d).join(":"),x=m?_+wg:_,p=x+w;if(i.includes(p))continue;i.push(p);const y=a(w,g);for(let j=0;j<y.length;++j){const b=y[j];i.push(x+b)}o=u+(o.length>0?" "+o:o)}return o};function n_(){let e=0,t,s,n="";for(;e<arguments.length;)(t=arguments[e++])&&(s=_g(t))&&(n&&(n+=" "),n+=s);return n}const _g=e=>{if(typeof e=="string")return e;let t,s="";for(let n=0;n<e.length;n++)e[n]&&(t=_g(e[n]))&&(s&&(s+=" "),s+=t);return s};function a_(e,...t){let s,n,a,i=l;function l(c){const u=t.reduce((d,m)=>m(d),e());return s=t_(u),n=s.cache.get,a=s.cache.set,i=o,o(c)}function o(c){const u=n(c);if(u)return u;const d=r_(c,s);return a(c,d),d}return function(){return i(n_.apply(null,arguments))}}const Ie=e=>{const t=s=>s[e]||[];return t.isThemeGetter=!0,t},bg=/^\[(?:([a-z-]+):)?(.+)\]$/i,i_=/^\d+\/\d+$/,l_=new Set(["px","full","screen"]),o_=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,c_=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,u_=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,d_=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,h_=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,As=e=>Zn(e)||l_.has(e)||i_.test(e),er=e=>Ta(e,"length",j_),Zn=e=>!!e&&!Number.isNaN(Number(e)),xc=e=>Ta(e,"number",Zn),Fa=e=>!!e&&Number.isInteger(Number(e)),m_=e=>e.endsWith("%")&&Zn(e.slice(0,-1)),ye=e=>bg.test(e),tr=e=>o_.test(e),f_=new Set(["length","size","percentage"]),p_=e=>Ta(e,f_,Ng),x_=e=>Ta(e,"position",Ng),g_=new Set(["image","url"]),y_=e=>Ta(e,g_,__),v_=e=>Ta(e,"",w_),Ua=()=>!0,Ta=(e,t,s)=>{const n=bg.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):s(n[2]):!1},j_=e=>c_.test(e)&&!u_.test(e),Ng=()=>!1,w_=e=>d_.test(e),__=e=>h_.test(e),b_=()=>{const e=Ie("colors"),t=Ie("spacing"),s=Ie("blur"),n=Ie("brightness"),a=Ie("borderColor"),i=Ie("borderRadius"),l=Ie("borderSpacing"),o=Ie("borderWidth"),c=Ie("contrast"),u=Ie("grayscale"),d=Ie("hueRotate"),m=Ie("invert"),f=Ie("gap"),v=Ie("gradientColorStops"),g=Ie("gradientColorStopPositions"),w=Ie("inset"),_=Ie("margin"),x=Ie("opacity"),p=Ie("padding"),y=Ie("saturate"),j=Ie("scale"),b=Ie("sepia"),N=Ie("skew"),T=Ie("space"),h=Ie("translate"),R=()=>["auto","contain","none"],P=()=>["auto","hidden","clip","visible","scroll"],U=()=>["auto",ye,t],W=()=>[ye,t],ee=()=>["",As,er],oe=()=>["auto",Zn,ye],re=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],ue=()=>["solid","dashed","dotted","double","none"],me=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],V=()=>["start","end","center","between","around","evenly","stretch"],Y=()=>["","0",ye],Z=()=>["auto","avoid","all","avoid-page","page","left","right","column"],O=()=>[Zn,ye];return{cacheSize:500,separator:":",theme:{colors:[Ua],spacing:[As,er],blur:["none","",tr,ye],brightness:O(),borderColor:[e],borderRadius:["none","","full",tr,ye],borderSpacing:W(),borderWidth:ee(),contrast:O(),grayscale:Y(),hueRotate:O(),invert:Y(),gap:W(),gradientColorStops:[e],gradientColorStopPositions:[m_,er],inset:U(),margin:U(),opacity:O(),padding:W(),saturate:O(),scale:O(),sepia:Y(),skew:O(),space:W(),translate:W()},classGroups:{aspect:[{aspect:["auto","square","video",ye]}],container:["container"],columns:[{columns:[tr]}],"break-after":[{"break-after":Z()}],"break-before":[{"break-before":Z()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...re(),ye]}],overflow:[{overflow:P()}],"overflow-x":[{"overflow-x":P()}],"overflow-y":[{"overflow-y":P()}],overscroll:[{overscroll:R()}],"overscroll-x":[{"overscroll-x":R()}],"overscroll-y":[{"overscroll-y":R()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[w]}],"inset-x":[{"inset-x":[w]}],"inset-y":[{"inset-y":[w]}],start:[{start:[w]}],end:[{end:[w]}],top:[{top:[w]}],right:[{right:[w]}],bottom:[{bottom:[w]}],left:[{left:[w]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Fa,ye]}],basis:[{basis:U()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ye]}],grow:[{grow:Y()}],shrink:[{shrink:Y()}],order:[{order:["first","last","none",Fa,ye]}],"grid-cols":[{"grid-cols":[Ua]}],"col-start-end":[{col:["auto",{span:["full",Fa,ye]},ye]}],"col-start":[{"col-start":oe()}],"col-end":[{"col-end":oe()}],"grid-rows":[{"grid-rows":[Ua]}],"row-start-end":[{row:["auto",{span:[Fa,ye]},ye]}],"row-start":[{"row-start":oe()}],"row-end":[{"row-end":oe()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ye]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ye]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...V()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...V(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...V(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[p]}],px:[{px:[p]}],py:[{py:[p]}],ps:[{ps:[p]}],pe:[{pe:[p]}],pt:[{pt:[p]}],pr:[{pr:[p]}],pb:[{pb:[p]}],pl:[{pl:[p]}],m:[{m:[_]}],mx:[{mx:[_]}],my:[{my:[_]}],ms:[{ms:[_]}],me:[{me:[_]}],mt:[{mt:[_]}],mr:[{mr:[_]}],mb:[{mb:[_]}],ml:[{ml:[_]}],"space-x":[{"space-x":[T]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[T]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",ye,t]}],"min-w":[{"min-w":[ye,t,"min","max","fit"]}],"max-w":[{"max-w":[ye,t,"none","full","min","max","fit","prose",{screen:[tr]},tr]}],h:[{h:[ye,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[ye,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[ye,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[ye,t,"auto","min","max","fit"]}],"font-size":[{text:["base",tr,er]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",xc]}],"font-family":[{font:[Ua]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ye]}],"line-clamp":[{"line-clamp":["none",Zn,xc]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",As,ye]}],"list-image":[{"list-image":["none",ye]}],"list-style-type":[{list:["none","disc","decimal",ye]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ue(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",As,er]}],"underline-offset":[{"underline-offset":["auto",As,ye]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:W()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ye]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ye]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...re(),x_]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",p_]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},y_]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[v]}],"gradient-via":[{via:[v]}],"gradient-to":[{to:[v]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[...ue(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:ue()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...ue()]}],"outline-offset":[{"outline-offset":[As,ye]}],"outline-w":[{outline:[As,er]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:ee()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[As,er]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",tr,v_]}],"shadow-color":[{shadow:[Ua]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":[...me(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":me()}],filter:[{filter:["","none"]}],blur:[{blur:[s]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",tr,ye]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[m]}],saturate:[{saturate:[y]}],sepia:[{sepia:[b]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[s]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[m]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[y]}],"backdrop-sepia":[{"backdrop-sepia":[b]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[l]}],"border-spacing-x":[{"border-spacing-x":[l]}],"border-spacing-y":[{"border-spacing-y":[l]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ye]}],duration:[{duration:O()}],ease:[{ease:["linear","in","out","in-out",ye]}],delay:[{delay:O()}],animate:[{animate:["none","spin","ping","pulse","bounce",ye]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[j]}],"scale-x":[{"scale-x":[j]}],"scale-y":[{"scale-y":[j]}],rotate:[{rotate:[Fa,ye]}],"translate-x":[{"translate-x":[h]}],"translate-y":[{"translate-y":[h]}],"skew-x":[{"skew-x":[N]}],"skew-y":[{"skew-y":[N]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ye]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ye]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":W()}],"scroll-mx":[{"scroll-mx":W()}],"scroll-my":[{"scroll-my":W()}],"scroll-ms":[{"scroll-ms":W()}],"scroll-me":[{"scroll-me":W()}],"scroll-mt":[{"scroll-mt":W()}],"scroll-mr":[{"scroll-mr":W()}],"scroll-mb":[{"scroll-mb":W()}],"scroll-ml":[{"scroll-ml":W()}],"scroll-p":[{"scroll-p":W()}],"scroll-px":[{"scroll-px":W()}],"scroll-py":[{"scroll-py":W()}],"scroll-ps":[{"scroll-ps":W()}],"scroll-pe":[{"scroll-pe":W()}],"scroll-pt":[{"scroll-pt":W()}],"scroll-pr":[{"scroll-pr":W()}],"scroll-pb":[{"scroll-pb":W()}],"scroll-pl":[{"scroll-pl":W()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ye]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[As,er,xc]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},N_=a_(b_);function Ut(...e){return N_(vg(e))}function M(e){return new Intl.NumberFormat("ar-EG",{style:"currency",currency:"EGP"}).format(e)}function Ee(e){return new Intl.DateTimeFormat("ar-EG",{dateStyle:"short"}).format(new Date(e))}/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var k_={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S_=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),fe=(e,t)=>{const s=S.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:l,className:o="",children:c,...u},d)=>S.createElement("svg",{ref:d,...k_,width:a,height:a,stroke:n,strokeWidth:l?Number(i)*24/Number(a):i,className:["lucide",`lucide-${S_(e)}`,o].join(" "),...u},[...t.map(([m,f])=>S.createElement(m,f)),...Array.isArray(c)?c:[c]]));return s.displayName=`${e}`,s};/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gn=fe("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const io=fe("ArrowLeftRight",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C_=fe("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E_=fe("Barcode",[["path",{d:"M3 5v14",key:"1nt18q"}],["path",{d:"M8 5v14",key:"1ybrkv"}],["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"M17 5v14",key:"ycjyhj"}],["path",{d:"M21 5v14",key:"nzette"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P_=fe("Boxes",[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ir=fe("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lo=fe("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zm=fe("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T_=fe("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R_=fe("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=fe("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O_=fe("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=fe("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A_=fe("FileBarChart",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 18v-2",key:"qcmpov"}],["path",{d:"M12 18v-4",key:"q1q25u"}],["path",{d:"M16 18v-6",key:"15y0np"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kg=fe("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I_=fe("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $_=fe("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oo=fe("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q_=fe("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Io=fe("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M_=fe("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L_=fe("PackageCheck",[["path",{d:"m16 16 2 2 4-4",key:"gfu2re"}],["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $o=fe("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D_=fe("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const co=fe("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=fe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rr=fe("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F_=fe("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ei=fe("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U_=fe("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=fe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const th=fe("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bm=fe("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sg=fe("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yn=fe("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Km=fe("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cg=fe("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=fe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lu=fe("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z_=fe("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pi=fe("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _a=fe("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wm=fe("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sh=fe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),B_=[{icon:I_,label:" ",path:"/dashboard"},{icon:M_,label:" ",path:"/pos"},{icon:Sg,label:"",path:"/sales"},{icon:z_,label:"",path:"/purchases"},{icon:$o,label:"",path:"/products"},{icon:T_,label:"",path:"/inventory"},{icon:L_,label:" ",path:"/stock-count"},{icon:io,label:"",path:"/transfers"},{icon:Ei,label:"",path:"/returns"},{icon:gn,label:"",path:"/damaged"},{icon:_a,label:"",path:"/customers"},{icon:kg,label:"  ",path:"/customer-statement"},{icon:_a,label:"",path:"/suppliers"},{icon:F_,label:"",path:"/expenses"},{icon:ea,label:" ",path:"/partner-withdrawals"},{icon:A_,label:"",path:"/reports"},{icon:th,label:"",path:"/settings"}];function K_(){var i,l,o;const e=Ca(),{user:t,logout:s}=Zd(),[n,a]=S.useState(!1);return r.jsxs(r.Fragment,{children:[!n&&r.jsxs("div",{className:"lg:hidden fixed top-0 left-0 right-0 bg-white border-b z-40 p-3 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("img",{src:"/el-fagr/logo.jpg",alt:" ",className:"w-10 h-10 rounded-lg object-contain"}),r.jsx("h1",{className:"text-base font-bold text-primary",children:" "})]}),r.jsx("button",{onClick:()=>a(!0),className:"p-2 hover:bg-muted rounded-md",children:r.jsx(q_,{className:"h-6 w-6"})})]}),n&&r.jsx("div",{className:"lg:hidden fixed inset-0 bg-black/50 z-30",onClick:()=>a(!1)}),r.jsxs("aside",{className:Ut("w-64 bg-white border-l h-screen flex flex-col fixed lg:static z-40 transition-transform duration-300 right-0",n?"translate-x-0":"translate-x-full lg:translate-x-0"),children:[r.jsxs("div",{className:"p-4 border-b relative",children:[r.jsx("button",{onClick:()=>a(!1),className:"lg:hidden absolute top-4 left-4 p-1 hover:bg-muted rounded-md",children:r.jsx(sh,{className:"h-5 w-5"})}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("img",{src:"/el-fagr/logo.jpg",alt:" ",className:"w-12 h-12 rounded-lg object-contain"}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl font-bold text-primary",children:" "}),r.jsx("p",{className:"text-sm text-muted-foreground",children:((i=t==null?void 0:t.branch)==null?void 0:i.name_ar)||" "})]})]})]}),r.jsx("nav",{className:"flex-1 p-2 space-y-1 overflow-y-auto",children:B_.map(c=>r.jsxs(Tj,{to:c.path,onClick:()=>a(!1),className:Ut("flex items-center gap-3 px-3 py-2 rounded-md text-sm transition-colors",e.pathname===c.path?"bg-primary text-primary-foreground":"hover:bg-muted"),children:[r.jsx(c.icon,{className:"h-5 w-5"}),c.label]},c.path))}),r.jsxs("div",{className:"p-4 border-t",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center",children:r.jsx("span",{className:"text-primary font-medium",children:(l=t==null?void 0:t.full_name)==null?void 0:l[0]})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium",children:t==null?void 0:t.full_name}),r.jsx("p",{className:"text-xs text-muted-foreground",children:(o=t==null?void 0:t.role)==null?void 0:o.name_ar})]})]}),r.jsxs("button",{type:"button",onClick:s,className:"flex items-center gap-2 text-sm text-destructive hover:underline w-full",children:[r.jsx($_,{className:"h-4 w-4"})," "]})]})]})]})}function W_(){return Zd(t=>t.isAuthenticated)?r.jsxs("div",{className:"flex h-screen bg-gray-50",children:[r.jsx(K_,{}),r.jsx("main",{className:"flex-1 overflow-auto p-3 sm:p-4 md:p-6 w-full lg:w-auto",children:r.jsx("div",{className:"pt-16 lg:pt-0",children:r.jsx(yj,{})})})]}):r.jsx(eg,{to:"/login",replace:!0})}function Vm(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function V_(...e){return t=>{let s=!1;const n=e.map(a=>{const i=Vm(a,t);return!s&&typeof i=="function"&&(s=!0),i});if(s)return()=>{for(let a=0;a<n.length;a++){const i=n[a];typeof i=="function"?i():Vm(e[a],null)}}}}var H_=Symbol.for("react.lazy"),uo=Uf[" use ".trim().toString()];function Q_(e){return typeof e=="object"&&e!==null&&"then"in e}function Eg(e){return e!=null&&typeof e=="object"&&"$$typeof"in e&&e.$$typeof===H_&&"_payload"in e&&Q_(e._payload)}function G_(e){const t=Y_(e),s=S.forwardRef((n,a)=>{let{children:i,...l}=n;Eg(i)&&typeof uo=="function"&&(i=uo(i._payload));const o=S.Children.toArray(i),c=o.find(Z_);if(c){const u=c.props.children,d=o.map(m=>m===c?S.Children.count(u)>1?S.Children.only(null):S.isValidElement(u)?u.props.children:null:m);return r.jsx(t,{...l,ref:a,children:S.isValidElement(u)?S.cloneElement(u,void 0,d):null})}return r.jsx(t,{...l,ref:a,children:i})});return s.displayName=`${e}.Slot`,s}var J_=G_("Slot");function Y_(e){const t=S.forwardRef((s,n)=>{let{children:a,...i}=s;if(Eg(a)&&typeof uo=="function"&&(a=uo(a._payload)),S.isValidElement(a)){const l=tb(a),o=eb(i,a.props);return a.type!==S.Fragment&&(o.ref=n?V_(n,l):l),S.cloneElement(a,o)}return S.Children.count(a)>1?S.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var X_=Symbol("radix.slottable");function Z_(e){return S.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===X_}function eb(e,t){const s={...t};for(const n in t){const a=e[n],i=t[n];/^on[A-Z]/.test(n)?a&&i?s[n]=(...o)=>{const c=i(...o);return a(...o),c}:a&&(s[n]=a):n==="style"?s[n]={...a,...i}:n==="className"&&(s[n]=[a,i].filter(Boolean).join(" "))}return{...e,...s}}function tb(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,s=t&&"isReactWarning"in t&&t.isReactWarning;return s?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,s=t&&"isReactWarning"in t&&t.isReactWarning,s?e.props.ref:e.props.ref||e.ref)}const Hm=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,Qm=vg,sb=(e,t)=>s=>{var n;if((t==null?void 0:t.variants)==null)return Qm(e,s==null?void 0:s.class,s==null?void 0:s.className);const{variants:a,defaultVariants:i}=t,l=Object.keys(a).map(u=>{const d=s==null?void 0:s[u],m=i==null?void 0:i[u];if(d===null)return null;const f=Hm(d)||Hm(m);return a[u][f]}),o=s&&Object.entries(s).reduce((u,d)=>{let[m,f]=d;return f===void 0||(u[m]=f),u},{}),c=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((u,d)=>{let{class:m,className:f,...v}=d;return Object.entries(v).every(g=>{let[w,_]=g;return Array.isArray(_)?_.includes({...i,...o}[w]):{...i,...o}[w]===_})?[...u,m,f]:u},[]);return Qm(e,l,c,s==null?void 0:s.class,s==null?void 0:s.className)},rb=sb("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),L=S.forwardRef(({className:e,variant:t,size:s,asChild:n=!1,...a},i)=>{const l=n?J_:"button";return r.jsx(l,{className:Ut(rb({variant:t,size:s,className:e})),ref:i,...a})});L.displayName="Button";const G=S.forwardRef(({className:e,type:t,...s},n)=>r.jsx("input",{type:t,className:Ut("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...s}));G.displayName="Input";const le=S.forwardRef(({className:e,...t},s)=>r.jsx("div",{ref:s,className:Ut("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));le.displayName="Card";const Se=S.forwardRef(({className:e,...t},s)=>r.jsx("div",{ref:s,className:Ut("flex flex-col space-y-1.5 p-6",e),...t}));Se.displayName="CardHeader";const Ge=S.forwardRef(({className:e,...t},s)=>r.jsx("h3",{ref:s,className:Ut("text-2xl font-semibold leading-none tracking-tight",e),...t}));Ge.displayName="CardTitle";const Pg=S.forwardRef(({className:e,...t},s)=>r.jsx("p",{ref:s,className:Ut("text-sm text-muted-foreground",e),...t}));Pg.displayName="CardDescription";const Ce=S.forwardRef(({className:e,...t},s)=>r.jsx("div",{ref:s,className:Ut("p-6 pt-0",e),...t}));Ce.displayName="CardContent";const nb=S.forwardRef(({className:e,...t},s)=>r.jsx("div",{ref:s,className:Ut("flex items-center p-6 pt-0",e),...t}));nb.displayName="CardFooter";function qo(e,t){var s={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(s[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(s[n[a]]=e[n[a]]);return s}function ab(e,t,s,n){function a(i){return i instanceof s?i:new s(function(l){l(i)})}return new(s||(s=Promise))(function(i,l){function o(d){try{u(n.next(d))}catch(m){l(m)}}function c(d){try{u(n.throw(d))}catch(m){l(m)}}function u(d){d.done?i(d.value):a(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})}const ib=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class rh extends Error{constructor(t,s="FunctionsError",n){super(t),this.name=s,this.context=n}}class lb extends rh{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Gm extends rh{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Jm extends rh{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Du;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Du||(Du={}));class ob{constructor(t,{headers:s={},customFetch:n,region:a=Du.Any}={}){this.url=t,this.headers=s,this.region=a,this.fetch=ib(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return ab(this,arguments,void 0,function*(s,n={}){var a;let i,l;try{const{headers:o,method:c,body:u,signal:d,timeout:m}=n;let f={},{region:v}=n;v||(v=this.region);const g=new URL(`${this.url}/${s}`);v&&v!=="any"&&(f["x-region"]=v,g.searchParams.set("forceFunctionRegion",v));let w;u&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",w=u):typeof u=="string"?(f["Content-Type"]="text/plain",w=u):typeof FormData<"u"&&u instanceof FormData?w=u:(f["Content-Type"]="application/json",w=JSON.stringify(u)):w=u;let _=d;m&&(l=new AbortController,i=setTimeout(()=>l.abort(),m),d?(_=l.signal,d.addEventListener("abort",()=>l.abort())):_=l.signal);const x=yield this.fetch(g.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),o),body:w,signal:_}).catch(b=>{throw new lb(b)}),p=x.headers.get("x-relay-error");if(p&&p==="true")throw new Gm(x);if(!x.ok)throw new Jm(x);let y=((a=x.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),j;return y==="application/json"?j=yield x.json():y==="application/octet-stream"||y==="application/pdf"?j=yield x.blob():y==="text/event-stream"?j=x:y==="multipart/form-data"?j=yield x.formData():j=yield x.text(),{data:j,error:null,response:x}}catch(o){return{data:null,error:o,response:o instanceof Jm||o instanceof Gm?o.context:void 0}}finally{i&&clearTimeout(i)}})}}var cb=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},ub=class{constructor(e){var t,s;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(s=e.isMaybeSingle)!==null&&s!==void 0?s:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var s=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let l=null,o=null,c=null,u=i.status,d=i.statusText;if(i.ok){var m,f;if(s.method!=="HEAD"){var v;const x=await i.text();x===""||(s.headers.get("Accept")==="text/csv"||s.headers.get("Accept")&&(!((v=s.headers.get("Accept"))===null||v===void 0)&&v.includes("application/vnd.pgrst.plan+text"))?o=x:o=JSON.parse(x))}const w=(m=s.headers.get("Prefer"))===null||m===void 0?void 0:m.match(/count=(exact|planned|estimated)/),_=(f=i.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");w&&_&&_.length>1&&(c=parseInt(_[1])),s.isMaybeSingle&&s.method==="GET"&&Array.isArray(o)&&(o.length>1?(l={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,c=null,u=406,d="Not Acceptable"):o.length===1?o=o[0]:o=null)}else{var g;const w=await i.text();try{l=JSON.parse(w),Array.isArray(l)&&i.status===404&&(o=[],l=null,u=200,d="OK")}catch{i.status===404&&w===""?(u=204,d="No Content"):l={message:w}}if(l&&s.isMaybeSingle&&(!(l==null||(g=l.details)===null||g===void 0)&&g.includes("0 rows"))&&(l=null,u=200,d="OK"),l&&s.shouldThrowOnError)throw new cb(l)}return{error:l,data:o,count:c,status:u,statusText:d}});return this.shouldThrowOnError||(a=a.catch(i=>{var l;let o="";const c=i==null?void 0:i.cause;if(c){var u,d,m,f;const g=(u=c==null?void 0:c.message)!==null&&u!==void 0?u:"",w=(d=c==null?void 0:c.code)!==null&&d!==void 0?d:"";o=`${(m=i==null?void 0:i.name)!==null&&m!==void 0?m:"FetchError"}: ${i==null?void 0:i.message}`,o+=`

Caused by: ${(f=c==null?void 0:c.name)!==null&&f!==void 0?f:"Error"}: ${g}`,w&&(o+=` (${w})`),c!=null&&c.stack&&(o+=`
${c.stack}`)}else{var v;o=(v=i==null?void 0:i.stack)!==null&&v!==void 0?v:""}return{error:{message:`${(l=i==null?void 0:i.name)!==null&&l!==void 0?l:"FetchError"}: ${i==null?void 0:i.message}`,details:o,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),a.then(e,t)}returns(){return this}overrideTypes(){return this}},db=class extends ub{select(e){let t=!1;const s=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",s),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:n,referencedTable:a=n}={}){const i=a?`${a}.order`:"order",l=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${l?`${l},`:""}${e}.${t?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:s=t}={}){const n=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:s,referencedTable:n=s}={}){const a=typeof n>"u"?"offset":`${n}.offset`,i=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${e}`),this.url.searchParams.set(i,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:n=!1,wal:a=!1,format:i="text"}={}){var l;const o=[e?"analyze":null,t?"verbose":null,s?"settings":null,n?"buffers":null,a?"wal":null].filter(Boolean).join("|"),c=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${c}"; options=${o};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const Ym=new RegExp("[,()]");var Rn=class extends db{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const s=Array.from(new Set(t)).map(n=>typeof n=="string"&&Ym.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}notIn(e,t){const s=Array.from(new Set(t)).map(n=>typeof n=="string"&&Ym.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`not.in.(${s})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:n}={}){let a="";n==="plain"?a="pl":n==="phrase"?a="ph":n==="websearch"&&(a="w");const i=s===void 0?"":`(${s})`;return this.url.searchParams.append(e,`${a}fts${i}.${t}`),this}match(e){return Object.entries(e).forEach(([t,s])=>{this.url.searchParams.append(t,`eq.${s}`)}),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t,referencedTable:s=t}={}){const n=s?`${s}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}},hb=class{constructor(e,{headers:t={},schema:s,fetch:n}){this.url=e,this.headers=new Headers(t),this.schema=s,this.fetch=n}select(e,t){const{head:s=!1,count:n}=t??{},a=s?"HEAD":"GET";let i=!1;const l=(e??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",l),n&&this.headers.append("Prefer",`count=${n}`),new Rn({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:s=!0}={}){var n;const a="POST";if(t&&this.headers.append("Prefer",`count=${t}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const i=e.reduce((l,o)=>l.concat(Object.keys(o)),[]);if(i.length>0){const l=[...new Set(i)].map(o=>`"${o}"`);this.url.searchParams.set("columns",l.join(","))}}return new Rn({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:n,defaultToNull:a=!0}={}){var i;const l="POST";if(this.headers.append("Prefer",`resolution=${s?"ignore":"merge"}-duplicates`),t!==void 0&&this.url.searchParams.set("on_conflict",t),n&&this.headers.append("Prefer",`count=${n}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(o.length>0){const c=[...new Set(o)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new Rn({method:l,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(e,{count:t}={}){var s;const n="PATCH";return t&&this.headers.append("Prefer",`count=${t}`),new Rn({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}delete({count:e}={}){var t;const s="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new Rn({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},mb=class Tg{constructor(t,{headers:s={},schema:n,fetch:a}={}){this.url=t,this.headers=new Headers(s),this.schemaName=n,this.fetch=a}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new hb(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Tg(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,s={},{head:n=!1,get:a=!1,count:i}={}){var l;let o;const c=new URL(`${this.url}/rpc/${t}`);let u;n||a?(o=n?"HEAD":"GET",Object.entries(s).filter(([m,f])=>f!==void 0).map(([m,f])=>[m,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([m,f])=>{c.searchParams.append(m,f)})):(o="POST",u=s);const d=new Headers(this.headers);return i&&d.set("Prefer",`count=${i}`),new Rn({method:o,url:c,headers:d,schema:this.schemaName,body:u,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}};class fb{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const s=process.versions;if(s&&s.node){const n=s.node,a=parseInt(n.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let s=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(s+=`

Suggested solution: ${t.workaround}`),new Error(s)}static createWebSocket(t,s){const n=this.getWebSocketConstructor();return new n(t,s)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const pb="2.89.0",xb=`realtime-js/${pb}`,Rg="1.0.0",gb="2.0.0",Xm=Rg,Fu=1e4,yb=1e3,vb=100;var ar;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(ar||(ar={}));var st;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(st||(st={}));var ps;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(ps||(ps={}));var Uu;(function(e){e.websocket="websocket"})(Uu||(Uu={}));var Wr;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Wr||(Wr={}));class jb{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,s){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return s(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return s(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var s;return this._isArrayBuffer((s=t.payload)===null||s===void 0?void 0:s.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var s,n;const a=(n=(s=t.payload)===null||s===void 0?void 0:s.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(t){var s,n;const a=(n=(s=t.payload)===null||s===void 0?void 0:s.payload)!==null&&n!==void 0?n:{},l=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,l)}_encodeUserBroadcastPush(t,s,n){var a,i;const l=t.topic,o=(a=t.ref)!==null&&a!==void 0?a:"",c=(i=t.join_ref)!==null&&i!==void 0?i:"",u=t.payload.event,d=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},m=Object.keys(d).length===0?"":JSON.stringify(d);if(c.length>255)throw new Error(`joinRef length ${c.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`ref length ${o.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`topic length ${l.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`userEvent length ${u.length} exceeds maximum of 255`);if(m.length>255)throw new Error(`metadata length ${m.length} exceeds maximum of 255`);const f=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+o.length+l.length+u.length+m.length,v=new ArrayBuffer(this.HEADER_LENGTH+f);let g=new DataView(v),w=0;g.setUint8(w++,this.KINDS.userBroadcastPush),g.setUint8(w++,c.length),g.setUint8(w++,o.length),g.setUint8(w++,l.length),g.setUint8(w++,u.length),g.setUint8(w++,m.length),g.setUint8(w++,s),Array.from(c,x=>g.setUint8(w++,x.charCodeAt(0))),Array.from(o,x=>g.setUint8(w++,x.charCodeAt(0))),Array.from(l,x=>g.setUint8(w++,x.charCodeAt(0))),Array.from(u,x=>g.setUint8(w++,x.charCodeAt(0))),Array.from(m,x=>g.setUint8(w++,x.charCodeAt(0)));var _=new Uint8Array(v.byteLength+n.byteLength);return _.set(new Uint8Array(v),0),_.set(new Uint8Array(n),v.byteLength),_.buffer}decode(t,s){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return s(n)}if(typeof t=="string"){const n=JSON.parse(t),[a,i,l,o,c]=n;return s({join_ref:a,ref:i,topic:l,event:o,payload:c})}return s({})}_binaryDecode(t){const s=new DataView(t),n=s.getUint8(0),a=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,s,a)}}_decodeUserBroadcast(t,s,n){const a=s.getUint8(1),i=s.getUint8(2),l=s.getUint8(3),o=s.getUint8(4);let c=this.HEADER_LENGTH+4;const u=n.decode(t.slice(c,c+a));c=c+a;const d=n.decode(t.slice(c,c+i));c=c+i;const m=n.decode(t.slice(c,c+l));c=c+l;const f=t.slice(c,t.byteLength),v=o===this.JSON_ENCODING?JSON.parse(n.decode(f)):f,g={type:this.BROADCAST_EVENT,event:d,payload:v};return l>0&&(g.meta=JSON.parse(m)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST_EVENT,payload:g}}_isArrayBuffer(t){var s;return t instanceof ArrayBuffer||((s=t==null?void 0:t.constructor)===null||s===void 0?void 0:s.name)==="ArrayBuffer"}_pick(t,s){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([n])=>s.includes(n)))}}class Og{constructor(t,s){this.callback=t,this.timerCalc=s,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=s}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Oe;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Oe||(Oe={}));const Zm=(e,t,s={})=>{var n;const a=(n=s.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((i,l)=>(i[l]=wb(l,e,t,a),i),{}):{}},wb=(e,t,s,n)=>{const a=t.find(o=>o.name===e),i=a==null?void 0:a.type,l=s[e];return i&&!n.includes(i)?Ag(i,l):zu(l)},Ag=(e,t)=>{if(e.charAt(0)==="_"){const s=e.slice(1,e.length);return kb(t,s)}switch(e){case Oe.bool:return _b(t);case Oe.float4:case Oe.float8:case Oe.int2:case Oe.int4:case Oe.int8:case Oe.numeric:case Oe.oid:return bb(t);case Oe.json:case Oe.jsonb:return Nb(t);case Oe.timestamp:return Sb(t);case Oe.abstime:case Oe.date:case Oe.daterange:case Oe.int4range:case Oe.int8range:case Oe.money:case Oe.reltime:case Oe.text:case Oe.time:case Oe.timestamptz:case Oe.timetz:case Oe.tsrange:case Oe.tstzrange:return zu(t);default:return zu(t)}},zu=e=>e,_b=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},bb=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Nb=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},kb=(e,t)=>{if(typeof e!="string")return e;const s=e.length-1,n=e[s];if(e[0]==="{"&&n==="}"){let i;const l=e.slice(1,s);try{i=JSON.parse("["+l+"]")}catch{i=l?l.split(","):[]}return i.map(o=>Ag(t,o))}return e},Sb=e=>typeof e=="string"?e.replace(" ","T"):e,Ig=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class gc{constructor(t,s,n={},a=Fu){this.channel=t,this.event=s,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,s){var n;return this._hasReceived(t)&&s((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:s}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=s=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=s,this._matchReceive(s)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,s){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:s})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:s}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(s))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var ef;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(ef||(ef={}));class ai{constructor(t,s){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(s==null?void 0:s.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:i,onLeave:l,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ai.syncState(this.state,a,i,l),this.pendingDiffs.forEach(c=>{this.state=ai.syncDiff(this.state,c,i,l)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},a=>{const{onJoin:i,onLeave:l,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=ai.syncDiff(this.state,a,i,l),o())}),this.onJoin((a,i,l)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:l})}),this.onLeave((a,i,l)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,s,n,a){const i=this.cloneDeep(t),l=this.transformState(s),o={},c={};return this.map(i,(u,d)=>{l[u]||(c[u]=d)}),this.map(l,(u,d)=>{const m=i[u];if(m){const f=d.map(_=>_.presence_ref),v=m.map(_=>_.presence_ref),g=d.filter(_=>v.indexOf(_.presence_ref)<0),w=m.filter(_=>f.indexOf(_.presence_ref)<0);g.length>0&&(o[u]=g),w.length>0&&(c[u]=w)}else o[u]=d}),this.syncDiff(i,{joins:o,leaves:c},n,a)}static syncDiff(t,s,n,a){const{joins:i,leaves:l}={joins:this.transformState(s.joins),leaves:this.transformState(s.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(i,(o,c)=>{var u;const d=(u=t[o])!==null&&u!==void 0?u:[];if(t[o]=this.cloneDeep(c),d.length>0){const m=t[o].map(v=>v.presence_ref),f=d.filter(v=>m.indexOf(v.presence_ref)<0);t[o].unshift(...f)}n(o,d,c)}),this.map(l,(o,c)=>{let u=t[o];if(!u)return;const d=c.map(m=>m.presence_ref);u=u.filter(m=>d.indexOf(m.presence_ref)<0),t[o]=u,a(o,u,c),u.length===0&&delete t[o]}),t}static map(t,s){return Object.getOwnPropertyNames(t).map(n=>s(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((s,n)=>{const a=t[n];return"metas"in a?s[n]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):s[n]=a,s},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var tf;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(tf||(tf={}));var ii;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(ii||(ii={}));var qs;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(qs||(qs={}));class Vn{constructor(t,s={config:{}},n){var a,i;if(this.topic=t,this.params=s,this.socket=n,this.bindings={},this.state=st.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},s.config),this.timeout=this.socket.timeout,this.joinPush=new gc(this,ps.join,this.params,this.timeout),this.rejoinTimer=new Og(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=st.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(l=>l.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=st.closed,this.socket._remove(this)}),this._onError(l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=st.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=st.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=st.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ps.reply,{},(l,o)=>{this._trigger(this._replyEventName(o),l)}),this.presence=new ai(this),this.broadcastEndpointURL=Ig(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,s=this.timeout){var n,a,i;if(this.socket.isConnected()||this.socket.connect(),this.state==st.closed){const{config:{broadcast:l,presence:o,private:c}}=this.params,u=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(v=>v.filter))!==null&&a!==void 0?a:[],d=!!this.bindings[ii.PRESENCE]&&this.bindings[ii.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,m={},f={broadcast:l,presence:Object.assign(Object.assign({},o),{enabled:d}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(v=>t==null?void 0:t(qs.CHANNEL_ERROR,v)),this._onClose(()=>t==null?void 0:t(qs.CLOSED)),this.updateJoinPayload(Object.assign({config:f},m)),this.joinedOnce=!0,this._rejoin(s),this.joinPush.receive("ok",async({postgres_changes:v})=>{var g;if(this.socket._isManualToken()||this.socket.setAuth(),v===void 0){t==null||t(qs.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,_=(g=w==null?void 0:w.length)!==null&&g!==void 0?g:0,x=[];for(let p=0;p<_;p++){const y=w[p],{filter:{event:j,schema:b,table:N,filter:T}}=y,h=v&&v[p];if(h&&h.event===j&&Vn.isFilterValueEqual(h.schema,b)&&Vn.isFilterValueEqual(h.table,N)&&Vn.isFilterValueEqual(h.filter,T))x.push(Object.assign(Object.assign({},y),{id:h.id}));else{this.unsubscribe(),this.state=st.errored,t==null||t(qs.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,t&&t(qs.SUBSCRIBED);return}}).receive("error",v=>{this.state=st.errored,t==null||t(qs.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(v).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(qs.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,s={}){return await this.send({type:"presence",event:"track",payload:t},s.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,s,n){return this.state===st.joined&&t===ii.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,s,n)}async httpSend(t,s,n={}){var a;if(s==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:s,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(a=n.timeout)!==null&&a!==void 0?a:this.timeout);if(o.status===202)return{success:!0};let c=o.statusText;try{const u=await o.json();c=u.error||u.message||c}catch{}return Promise.reject(new Error(c))}async send(t,s={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:l}=t,o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:l,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=s.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=u.body)===null||a===void 0?void 0:a.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var l,o,c;const u=this._push(t.type,t,s.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(o=(l=this.params)===null||l===void 0?void 0:l.config)===null||o===void 0?void 0:o.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=st.leaving;const s=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ps.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new gc(this,ps.leave,{},t),n.receive("ok",()=>{s(),a("ok")}).receive("timeout",()=>{s(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=st.closed,this.bindings={}}async _fetchWithTimeout(t,s,n){const a=new AbortController,i=setTimeout(()=>a.abort(),n),l=await this.socket.fetch(t,Object.assign(Object.assign({},s),{signal:a.signal}));return clearTimeout(i),l}_push(t,s,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new gc(this,t,s,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>vb){const s=this.pushBuffer.shift();s&&(s.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${s.event}`,s.payload))}}_onMessage(t,s,n){return s}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,s,n){var a,i;const l=t.toLocaleLowerCase(),{close:o,error:c,leave:u,join:d}=ps;if(n&&[o,c,u,d].indexOf(l)>=0&&n!==this._joinRef())return;let f=this._onMessage(l,s,n);if(s&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(v=>{var g,w,_;return((g=v.filter)===null||g===void 0?void 0:g.event)==="*"||((_=(w=v.filter)===null||w===void 0?void 0:w.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===l}).map(v=>v.callback(f,n)):(i=this.bindings[l])===null||i===void 0||i.filter(v=>{var g,w,_,x,p,y;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in v){const j=v.id,b=(g=v.filter)===null||g===void 0?void 0:g.event;return j&&((w=s.ids)===null||w===void 0?void 0:w.includes(j))&&(b==="*"||(b==null?void 0:b.toLocaleLowerCase())===((_=s.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const j=(p=(x=v==null?void 0:v.filter)===null||x===void 0?void 0:x.event)===null||p===void 0?void 0:p.toLocaleLowerCase();return j==="*"||j===((y=s==null?void 0:s.event)===null||y===void 0?void 0:y.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===l}).map(v=>{if(typeof f=="object"&&"ids"in f){const g=f.data,{schema:w,table:_,commit_timestamp:x,type:p,errors:y}=g;f=Object.assign(Object.assign({},{schema:w,table:_,commit_timestamp:x,eventType:p,new:{},old:{},errors:y}),this._getPayloadRecords(g))}v.callback(f,n)})}_isClosed(){return this.state===st.closed}_isJoined(){return this.state===st.joined}_isJoining(){return this.state===st.joining}_isLeaving(){return this.state===st.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,s,n){const a=t.toLocaleLowerCase(),i={type:a,filter:s,callback:n};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(t,s){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&Vn.isEqual(a.filter,s))})),this}static isEqual(t,s){if(Object.keys(t).length!==Object.keys(s).length)return!1;for(const n in t)if(t[n]!==s[n])return!1;return!0}static isFilterValueEqual(t,s){return(t??void 0)===(s??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(ps.close,{},t)}_onError(t){this._on(ps.error,{},s=>t(s))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=st.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const s={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(s.new=Zm(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(s.old=Zm(t.columns,t.old_record)),s}}const yc=()=>{},ml={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Cb=[1e3,2e3,5e3,1e4],Eb=1e4,Pb=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Tb{constructor(t,s){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Fu,this.transport=null,this.heartbeatIntervalMs=ml.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=yc,this.ref=0,this.reconnectTimer=null,this.vsn=Xm,this.logger=yc,this.conn=null,this.sendBuffer=[],this.serializer=new jb,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>a?(...i)=>a(...i):(...i)=>fetch(...i),!(!((n=s==null?void 0:s.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=s.params.apikey,this.endPoint=`${t}/${Uu.websocket}`,this.httpEndpoint=Ig(t),this._initializeOptions(s),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(s==null?void 0:s.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=fb.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const s=t.message;throw s.includes("Node.js")?new Error(`${s}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${s}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,s){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,s??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const s=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),s}async removeAllChannels(){const t=await Promise.all(this.channels.map(s=>s.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,s,n){this.logger(t,s,n)}connectionState(){switch(this.conn&&this.conn.readyState){case ar.connecting:return Wr.Connecting;case ar.open:return Wr.Open;case ar.closing:return Wr.Closing;default:return Wr.Closed}}isConnected(){return this.connectionState()===Wr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,s={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(i=>i.topic===n);if(a)return a;{const i=new Vn(`realtime:${t}`,s,this);return this.channels.push(i),i}}push(t){const{topic:s,event:n,payload:a,ref:i}=t,l=()=>{this.encode(t,o=>{var c;(c=this.conn)===null||c===void 0||c.send(o)})};this.log("push",`${s} ${n} (${i})`,a),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(s){this.log("error","error in heartbeat callback",s)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(s){this.log("error","error in heartbeat callback",s)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(yb,"heartbeat timeout"),setTimeout(()=>{var s;this.isConnected()||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout()},ml.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(s){this.log("error","error in heartbeat callback",s)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let s=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));s&&(this.log("transport",`leaving duplicate topic "${t}"`),s.unsubscribe())}_remove(t){this.channels=this.channels.filter(s=>s.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,s=>{if(s.topic==="phoenix"&&s.event==="phx_reply")try{this.heartbeatCallback(s.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}s.ref&&s.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:i,ref:l}=s,o=l?`(${l})`:"",c=i.status||"";this.log("receive",`${c} ${n} ${a} ${o}`.trim(),i),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(a,i,l)),this._triggerStateCallbacks("message",s)})}_clearTimer(t){var s;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((s=this.reconnectTimer)===null||s===void 0||s.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===ar.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===ar.open||this.conn.readyState===ar.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(s=>{this.log("error","error waiting for auth on connect",s),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=s=>{this.log("worker","worker error",s.message),this._terminateWorker()},this.workerRef.onmessage=s=>{s.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var s;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(ps.error))}_appendParams(t,s){if(Object.keys(s).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(s);return`${t}${n}${a}`}_workerObjectUrl(t){let s;if(t)s=t;else{const n=new Blob([Pb],{type:"application/javascript"});s=URL.createObjectURL(n)}return s}_setConnectionState(t,s=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=s)}async _performAuth(t=null){let s,n=!1;if(t)s=t,n=!0;else if(this.accessToken)try{s=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),s=this.accessTokenValue}else s=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=s&&(this.accessTokenValue=s,this.channels.forEach(a=>{const i={access_token:s,version:xb};s&&a.updateJoinPayload(i),a.joinedOnce&&a._isJoined()&&a._push(ps.access_token,{access_token:s})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(s=>{this.log("error",`Error setting auth in ${t}`,s)})}_triggerStateCallbacks(t,s){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(s)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Og(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},ml.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var s,n,a,i,l,o,c,u,d,m,f,v;switch(this.transport=(s=t==null?void 0:t.transport)!==null&&s!==void 0?s:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:Fu,this.heartbeatIntervalMs=(a=t==null?void 0:t.heartbeatIntervalMs)!==null&&a!==void 0?a:ml.HEARTBEAT_INTERVAL,this.worker=(i=t==null?void 0:t.worker)!==null&&i!==void 0?i:!1,this.accessToken=(l=t==null?void 0:t.accessToken)!==null&&l!==void 0?l:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:yc,this.vsn=(c=t==null?void 0:t.vsn)!==null&&c!==void 0?c:Xm,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=t==null?void 0:t.reconnectAfterMs)!==null&&u!==void 0?u:g=>Cb[g-1]||Eb,this.vsn){case Rg:this.encode=(d=t==null?void 0:t.encode)!==null&&d!==void 0?d:(g,w)=>w(JSON.stringify(g)),this.decode=(m=t==null?void 0:t.decode)!==null&&m!==void 0?m:(g,w)=>w(JSON.parse(g));break;case gb:this.encode=(f=t==null?void 0:t.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(v=t==null?void 0:t.decode)!==null&&v!==void 0?v:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}var Ti=class extends Error{constructor(e,t){var s;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((s=t.icebergType)==null?void 0:s.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Rb(e,t,s){const n=new URL(t,e);if(s)for(const[a,i]of Object.entries(s))i!==void 0&&n.searchParams.set(a,i);return n.toString()}async function Ob(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function Ab(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:s,path:n,query:a,body:i,headers:l}){const o=Rb(e.baseUrl,n,a),c=await Ob(e.auth),u=await t(o,{method:s,headers:{...i?{"Content-Type":"application/json"}:{},...c,...l},body:i?JSON.stringify(i):void 0}),d=await u.text(),m=(u.headers.get("content-type")||"").includes("application/json"),f=m&&d?JSON.parse(d):d;if(!u.ok){const v=m?f:void 0,g=v==null?void 0:v.error;throw new Ti((g==null?void 0:g.message)??`Request failed with status ${u.status}`,{status:u.status,icebergType:g==null?void 0:g.type,icebergCode:g==null?void 0:g.code,details:v})}return{status:u.status,headers:u.headers,data:f}}}}function fl(e){return e.join("")}var Ib=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:fl(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,t){const s={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:s})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${fl(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${fl(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${fl(e.namespace)}`}),!0}catch(t){if(t instanceof Ti&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(s){if(s instanceof Ti&&s.status===409)return;throw s}}};function bn(e){return e.join("")}var $b=class{constructor(e,t="",s){this.client=e,this.prefix=t,this.accessDelegation=s}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${bn(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const s={};return this.accessDelegation&&(s["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${bn(e.namespace)}/tables`,body:t,headers:s})).data.metadata}async updateTable(e,t){const s=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${bn(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":s.data["metadata-location"],metadata:s.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${bn(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${bn(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${bn(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(s){if(s instanceof Ti&&s.status===404)return!1;throw s}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(s){if(s instanceof Ti&&s.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw s}}},qb=class{constructor(e){var n;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const s=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=Ab({baseUrl:s,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(n=e.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new Ib(this.client,t),this.tableOps=new $b(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},Mo=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function Fe(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var Mb=class extends Mo{constructor(e,t,s){super(e),this.name="StorageApiError",this.status=t,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Bu=class extends Mo{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const nh=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Lb=()=>Response,Ku=e=>{if(Array.isArray(e))return e.map(s=>Ku(s));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([s,n])=>{const a=s.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[a]=Ku(n)}),t},Db=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Fb=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function Ri(e){"@babel/helpers - typeof";return Ri=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ri(e)}function Ub(e,t){if(Ri(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var n=s.call(e,t);if(Ri(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zb(e){var t=Ub(e,"string");return Ri(t)=="symbol"?t:t+""}function Bb(e,t,s){return(t=zb(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function sf(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),s.push.apply(s,n)}return s}function he(e){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?arguments[t]:{};t%2?sf(Object(s),!0).forEach(function(n){Bb(e,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):sf(Object(s)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(s,n))})}return e}const vc=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},Kb=async(e,t,s)=>{e instanceof await Lb()&&!(s!=null&&s.noResolveJson)?e.json().then(n=>{const a=e.status||500,i=(n==null?void 0:n.statusCode)||a+"";t(new Mb(vc(n),a,i))}).catch(n=>{t(new Bu(vc(n),n))}):t(new Bu(vc(e),e))},Wb=(e,t,s,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?a:(Db(n)?(a.headers=he({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,t!=null&&t.duplex&&(a.duplex=t.duplex),he(he({},a),s))};async function Vi(e,t,s,n,a,i){return new Promise((l,o)=>{e(s,Wb(t,n,a,i)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>l(c)).catch(c=>Kb(c,o,n))})}async function Oi(e,t,s,n){return Vi(e,"GET",t,s,n)}async function ds(e,t,s,n,a){return Vi(e,"POST",t,n,a,s)}async function Wu(e,t,s,n,a){return Vi(e,"PUT",t,n,a,s)}async function Vb(e,t,s,n){return Vi(e,"HEAD",t,he(he({},s),{},{noResolveJson:!0}),n)}async function ah(e,t,s,n,a){return Vi(e,"DELETE",t,n,a,s)}var Hb=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Fe(t))return{data:null,error:t};throw t}}};let $g;$g=Symbol.toStringTag;var Qb=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[$g]="BlobDownloadBuilder",this.promise=null}asStream(){return new Hb(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Fe(t))return{data:null,error:t};throw t}}};const Gb={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},rf={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var Jb=class{constructor(e,t={},s,n){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=s,this.fetch=nh(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,s,n){var a=this;try{let i;const l=he(he({},rf),n);let o=he(he({},a.headers),e==="POST"&&{"x-upsert":String(l.upsert)});const c=l.metadata;typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",l.cacheControl),c&&i.append("metadata",a.encodeMetadata(c)),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.has("cacheControl")||i.append("cacheControl",l.cacheControl),c&&!i.has("metadata")&&i.append("metadata",a.encodeMetadata(c))):(i=s,o["cache-control"]=`max-age=${l.cacheControl}`,o["content-type"]=l.contentType,c&&(o["x-metadata"]=a.toBase64(a.encodeMetadata(c))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!l.duplex&&(l.duplex="half")),n!=null&&n.headers&&(o=he(he({},o),n.headers));const u=a._removeEmptyFolders(t),d=a._getFinalPath(u),m=await(e=="PUT"?Wu:ds)(a.fetch,`${a.url}/object/${d}`,i,he({headers:o},l!=null&&l.duplex?{duplex:l.duplex}:{}));return{data:{path:u,id:m.Id,fullPath:m.Key},error:null}}catch(i){if(a.shouldThrowOnError)throw i;if(Fe(i))return{data:null,error:i};throw i}}async upload(e,t,s){return this.uploadOrUpdate("POST",e,t,s)}async uploadToSignedUrl(e,t,s,n){var a=this;const i=a._removeEmptyFolders(e),l=a._getFinalPath(i),o=new URL(a.url+`/object/upload/sign/${l}`);o.searchParams.set("token",t);try{let c;const u=he({upsert:rf.upsert},n),d=he(he({},a.headers),{"x-upsert":String(u.upsert)});return typeof Blob<"u"&&s instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",s)):typeof FormData<"u"&&s instanceof FormData?(c=s,c.append("cacheControl",u.cacheControl)):(c=s,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType),{data:{path:i,fullPath:(await Wu(a.fetch,o.toString(),c,{headers:d})).Key},error:null}}catch(c){if(a.shouldThrowOnError)throw c;if(Fe(c))return{data:null,error:c};throw c}}async createSignedUploadUrl(e,t){var s=this;try{let n=s._getFinalPath(e);const a=he({},s.headers);t!=null&&t.upsert&&(a["x-upsert"]="true");const i=await ds(s.fetch,`${s.url}/object/upload/sign/${n}`,{},{headers:a}),l=new URL(s.url+i.url),o=l.searchParams.get("token");if(!o)throw new Mo("No token returned by API");return{data:{signedUrl:l.toString(),path:e,token:o},error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Fe(n))return{data:null,error:n};throw n}}async update(e,t,s){return this.uploadOrUpdate("PUT",e,t,s)}async move(e,t,s){var n=this;try{return{data:await ds(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:n.headers}),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Fe(a))return{data:null,error:a};throw a}}async copy(e,t,s){var n=this;try{return{data:{path:(await ds(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:n.headers})).Key},error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Fe(a))return{data:null,error:a};throw a}}async createSignedUrl(e,t,s){var n=this;try{let a=n._getFinalPath(e),i=await ds(n.fetch,`${n.url}/object/sign/${a}`,he({expiresIn:t},s!=null&&s.transform?{transform:s.transform}:{}),{headers:n.headers});const l=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return i={signedUrl:encodeURI(`${n.url}${i.signedURL}${l}`)},{data:i,error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Fe(a))return{data:null,error:a};throw a}}async createSignedUrls(e,t,s){var n=this;try{const a=await ds(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:t,paths:e},{headers:n.headers}),i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:a.map(l=>he(he({},l),{},{signedUrl:l.signedURL?encodeURI(`${n.url}${l.signedURL}${i}`):null})),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Fe(a))return{data:null,error:a};throw a}}download(e,t){const s=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=n?`?${n}`:"",i=this._getFinalPath(e),l=()=>Oi(this.fetch,`${this.url}/${s}/${i}${a}`,{headers:this.headers,noResolveJson:!0});return new Qb(l,this.shouldThrowOnError)}async info(e){var t=this;const s=t._getFinalPath(e);try{return{data:Ku(await Oi(t.fetch,`${t.url}/object/info/${s}`,{headers:t.headers})),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Fe(n))return{data:null,error:n};throw n}}async exists(e){var t=this;const s=t._getFinalPath(e);try{return await Vb(t.fetch,`${t.url}/object/${s}`,{headers:t.headers}),{data:!0,error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Fe(n)&&n instanceof Bu){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}}getPublicUrl(e,t){const s=this._getFinalPath(e),n=[],a=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&n.push(a);const i=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&n.push(l);let o=n.join("&");return o!==""&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${s}${o}`)}}}async remove(e){var t=this;try{return{data:await ah(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Fe(s))return{data:null,error:s};throw s}}async list(e,t,s){var n=this;try{const a=he(he(he({},Gb),t),{},{prefix:e||""});return{data:await ds(n.fetch,`${n.url}/object/list/${n.bucketId}`,a,{headers:n.headers},s),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Fe(a))return{data:null,error:a};throw a}}async listV2(e,t){var s=this;try{const n=he({},e);return{data:await ds(s.fetch,`${s.url}/object/list-v2/${s.bucketId}`,n,{headers:s.headers},t),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Fe(n))return{data:null,error:n};throw n}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const qg="2.89.0",Mg={"X-Client-Info":`storage-js/${qg}`};var Yb=class{constructor(e,t={},s,n){this.shouldThrowOnError=!1;const a=new URL(e);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=he(he({},Mg),t),this.fetch=nh(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const s=t.listBucketOptionsToQueryString(e);return{data:await Oi(t.fetch,`${t.url}/bucket${s}`,{headers:t.headers}),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Fe(s))return{data:null,error:s};throw s}}async getBucket(e){var t=this;try{return{data:await Oi(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Fe(s))return{data:null,error:s};throw s}}async createBucket(e,t={public:!1}){var s=this;try{return{data:await ds(s.fetch,`${s.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Fe(n))return{data:null,error:n};throw n}}async updateBucket(e,t){var s=this;try{return{data:await Wu(s.fetch,`${s.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Fe(n))return{data:null,error:n};throw n}}async emptyBucket(e){var t=this;try{return{data:await ds(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Fe(s))return{data:null,error:s};throw s}}async deleteBucket(e){var t=this;try{return{data:await ah(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Fe(s))return{data:null,error:s};throw s}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},Xb=class{constructor(e,t={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=he(he({},Mg),t),this.fetch=nh(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await ds(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Fe(s))return{data:null,error:s};throw s}}async listBuckets(e){var t=this;try{const s=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&s.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&s.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&s.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&s.set("sortOrder",e.sortOrder),e!=null&&e.search&&s.set("search",e.search);const n=s.toString(),a=n?`${t.url}/bucket?${n}`:`${t.url}/bucket`;return{data:await Oi(t.fetch,a,{headers:t.headers}),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Fe(s))return{data:null,error:s};throw s}}async deleteBucket(e){var t=this;try{return{data:await ah(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Fe(s))return{data:null,error:s};throw s}}from(e){var t=this;if(!Fb(e))throw new Mo("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const s=new qb({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(s,{get(a,i){const l=a[i];return typeof l!="function"?l:async(...o)=>{try{return{data:await l.apply(a,o),error:null}}catch(c){if(n)throw c;return{data:null,error:c}}}}})}};const ih={"X-Client-Info":`storage-js/${qg}`,"Content-Type":"application/json"};var Lg=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Wt(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}var jc=class extends Lg{constructor(e,t,s){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Zb=class extends Lg{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const lh=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),eN=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},nf=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),tN=async(e,t,s)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(s!=null&&s.noResolveJson)){const n=e.status||500,a=e;if(typeof a.json=="function")a.json().then(i=>{const l=(i==null?void 0:i.statusCode)||(i==null?void 0:i.code)||n+"";t(new jc(nf(i),n,l))}).catch(()=>{const i=n+"";t(new jc(a.statusText||`HTTP ${n} error`,n,i))});else{const i=n+"";t(new jc(a.statusText||`HTTP ${n} error`,n,i))}}else t(new Zb(nf(e),e))},sN=(e,t,s,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return n?(eN(n)?(a.headers=he({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,he(he({},a),s)):a};async function rN(e,t,s,n,a,i){return new Promise((l,o)=>{e(s,sN(t,n,a,i)).then(c=>{if(!c.ok)throw c;if(n!=null&&n.noResolveJson)return c;const u=c.headers.get("content-type");return!u||!u.includes("application/json")?{}:c.json()}).then(c=>l(c)).catch(c=>tN(c,o,n))})}async function Vt(e,t,s,n,a){return rN(e,"POST",t,n,a,s)}var nN=class{constructor(e,t={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=he(he({},ih),t),this.fetch=lh(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await Vt(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{},error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}}async getIndex(e,t){var s=this;try{return{data:await Vt(s.fetch,`${s.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Wt(n))return{data:null,error:n};throw n}}async listIndexes(e){var t=this;try{return{data:await Vt(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}}async deleteIndex(e,t){var s=this;try{return{data:await Vt(s.fetch,`${s.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:s.headers})||{},error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Wt(n))return{data:null,error:n};throw n}}},aN=class{constructor(e,t={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=he(he({},ih),t),this.fetch=lh(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Vt(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{},error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}}async getVectors(e){var t=this;try{return{data:await Vt(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}}async listVectors(e){var t=this;try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:await Vt(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}}async queryVectors(e){var t=this;try{return{data:await Vt(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Vt(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{},error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}}},iN=class{constructor(e,t={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=he(he({},ih),t),this.fetch=lh(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Vt(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}}async getBucket(e){var t=this;try{return{data:await Vt(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}}async listBuckets(e={}){var t=this;try{return{data:await Vt(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}}async deleteBucket(e){var t=this;try{return{data:await Vt(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}}},lN=class extends iN{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new oN(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,s=this;return t().call(s,e)}async getBucket(e){var t=()=>super.getBucket,s=this;return t().call(s,e)}async listBuckets(e={}){var t=()=>super.listBuckets,s=this;return t().call(s,e)}async deleteBucket(e){var t=()=>super.deleteBucket,s=this;return t().call(s,e)}},oN=class extends nN{constructor(e,t,s,n){super(e,t,n),this.vectorBucketName=s}async createIndex(e){var t=()=>super.createIndex,s=this;return t().call(s,he(he({},e),{},{vectorBucketName:s.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,s=this;return t().call(s,he(he({},e),{},{vectorBucketName:s.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,s=this;return t().call(s,s.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,s=this;return t().call(s,s.vectorBucketName,e)}index(e){return new cN(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},cN=class extends aN{constructor(e,t,s,n,a){super(e,t,a),this.vectorBucketName=s,this.indexName=n}async putVectors(e){var t=()=>super.putVectors,s=this;return t().call(s,he(he({},e),{},{vectorBucketName:s.vectorBucketName,indexName:s.indexName}))}async getVectors(e){var t=()=>super.getVectors,s=this;return t().call(s,he(he({},e),{},{vectorBucketName:s.vectorBucketName,indexName:s.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,s=this;return t().call(s,he(he({},e),{},{vectorBucketName:s.vectorBucketName,indexName:s.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,s=this;return t().call(s,he(he({},e),{},{vectorBucketName:s.vectorBucketName,indexName:s.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,s=this;return t().call(s,he(he({},e),{},{vectorBucketName:s.vectorBucketName,indexName:s.indexName}))}},uN=class extends Yb{constructor(e,t={},s,n){super(e,t,s,n)}from(e){return new Jb(this.url,this.headers,e,this.fetch)}get vectors(){return new lN(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Xb(this.url+"/iceberg",this.headers,this.fetch)}};const Dg="2.89.0",On=30*1e3,Vu=3,wc=Vu*On,dN="http://localhost:9999",hN="supabase.auth.token",mN={"X-Client-Info":`gotrue-js/${Dg}`},Hu="X-Supabase-Api-Version",Fg={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},fN=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,pN=10*60*1e3;class Ai extends Error{constructor(t,s,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=s,this.code=n}}function ne(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class xN extends Ai{constructor(t,s,n){super(t,s,n),this.name="AuthApiError",this.status=s,this.code=n}}function gN(e){return ne(e)&&e.name==="AuthApiError"}class Vr extends Ai{constructor(t,s){super(t),this.name="AuthUnknownError",this.originalError=s}}class Xs extends Ai{constructor(t,s,n,a){super(t,n,a),this.name=s,this.status=n}}class Bt extends Xs{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function yN(e){return ne(e)&&e.name==="AuthSessionMissingError"}class Nn extends Xs{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class pl extends Xs{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class xl extends Xs{constructor(t,s=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function vN(e){return ne(e)&&e.name==="AuthImplicitGrantRedirectError"}class af extends Xs{constructor(t,s=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class jN extends Xs{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Qu extends Xs{constructor(t,s){super(t,"AuthRetryableFetchError",s,void 0)}}function _c(e){return ne(e)&&e.name==="AuthRetryableFetchError"}class lf extends Xs{constructor(t,s,n){super(t,"AuthWeakPasswordError",s,"weak_password"),this.reasons=n}}class Gu extends Xs{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const ho="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),of=` 	
\r=`.split(""),wN=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<of.length;t+=1)e[of[t].charCodeAt(0)]=-2;for(let t=0;t<ho.length;t+=1)e[ho[t].charCodeAt(0)]=t;return e})();function cf(e,t,s){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;s(ho[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;s(ho[n]),t.queuedBits-=6}}function Ug(e,t,s){const n=wN[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)s(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function uf(e){const t=[],s=l=>{t.push(String.fromCodePoint(l))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=l=>{NN(l,n,s)};for(let l=0;l<e.length;l+=1)Ug(e.charCodeAt(l),a,i);return t.join("")}function _N(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function bN(e,t){for(let s=0;s<e.length;s+=1){let n=e.charCodeAt(s);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(s+1)-56320&65535|a)+65536,s+=1}_N(n,t)}}function NN(e,t,s){if(t.utf8seq===0){if(e<=127){s(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&s(t.codepoint)}}function ta(e){const t=[],s={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)Ug(e.charCodeAt(a),s,n);return new Uint8Array(t)}function kN(e){const t=[];return bN(e,s=>t.push(s)),new Uint8Array(t)}function Yr(e){const t=[],s={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>cf(a,s,n)),cf(null,s,n),t.join("")}function SN(e){return Math.round(Date.now()/1e3)+e}function CN(){return Symbol("auth-callback")}const ft=()=>typeof window<"u"&&typeof document<"u",Fr={tested:!1,writable:!1},zg=()=>{if(!ft())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Fr.tested)return Fr.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Fr.tested=!0,Fr.writable=!0}catch{Fr.tested=!0,Fr.writable=!1}return Fr.writable};function EN(e){const t={},s=new URL(e);if(s.hash&&s.hash[0]==="#")try{new URLSearchParams(s.hash.substring(1)).forEach((a,i)=>{t[i]=a})}catch{}return s.searchParams.forEach((n,a)=>{t[a]=n}),t}const Bg=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),PN=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",An=async(e,t,s)=>{await e.setItem(t,JSON.stringify(s))},Ur=async(e,t)=>{const s=await e.getItem(t);if(!s)return null;try{return JSON.parse(s)}catch{return s}},mt=async(e,t)=>{await e.removeItem(t)};class Lo{constructor(){this.promise=new Lo.promiseConstructor((t,s)=>{this.resolve=t,this.reject=s})}}Lo.promiseConstructor=Promise;function bc(e){const t=e.split(".");if(t.length!==3)throw new Gu("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!fN.test(t[n]))throw new Gu("JWT not in base64url format");return{header:JSON.parse(uf(t[0])),payload:JSON.parse(uf(t[1])),signature:ta(t[2]),raw:{header:t[0],payload:t[1]}}}async function TN(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function RN(e,t){return new Promise((n,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const l=await e(i);if(!t(i,null,l)){n(l);return}}catch(l){if(!t(i,l)){a(l);return}}})()})}function ON(e){return("0"+e.toString(16)).substr(-2)}function AN(){const t=new Uint32Array(56);if(typeof crypto>"u"){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=s.length;let a="";for(let i=0;i<56;i++)a+=s.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,ON).join("")}async function IN(e){const s=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",s),a=new Uint8Array(n);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function $N(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const s=await IN(e);return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function kn(e,t,s=!1){const n=AN();let a=n;s&&(a+="/PASSWORD_RECOVERY"),await An(e,`${t}-code-verifier`,a);const i=await $N(n);return[i,n===i?"plain":"s256"]}const qN=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function MN(e){const t=e.headers.get(Hu);if(!t||!t.match(qN))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function LN(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function DN(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const FN=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Sn(e){if(!FN.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Nc(){const e={};return new Proxy(e,{get:(t,s)=>{if(s==="__isUserNotAvailableProxy")return!0;if(typeof s=="symbol"){const n=s.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${s}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function UN(e,t){return new Proxy(e,{get:(s,n,a)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const i=n.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(s,n,a)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(s,n,a)}})}function df(e){return JSON.parse(JSON.stringify(e))}const Kr=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),zN=[502,503,504];async function hf(e){var t;if(!PN(e))throw new Qu(Kr(e),0);if(zN.includes(e.status))throw new Qu(Kr(e),e.status);let s;try{s=await e.json()}catch(i){throw new Vr(Kr(i),i)}let n;const a=MN(e);if(a&&a.getTime()>=Fg["2024-01-01"].timestamp&&typeof s=="object"&&s&&typeof s.code=="string"?n=s.code:typeof s=="object"&&s&&typeof s.error_code=="string"&&(n=s.error_code),n){if(n==="weak_password")throw new lf(Kr(s),e.status,((t=s.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Bt}else if(typeof s=="object"&&s&&typeof s.weak_password=="object"&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((i,l)=>i&&typeof l=="string",!0))throw new lf(Kr(s),e.status,s.weak_password.reasons);throw new xN(Kr(s),e.status||500,n)}const BN=(e,t,s,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),s))};async function de(e,t,s,n){var a;const i=Object.assign({},n==null?void 0:n.headers);i[Hu]||(i[Hu]=Fg["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const l=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(l.redirect_to=n.redirectTo);const o=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",c=await KN(e,t,s+o,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function KN(e,t,s,n,a,i){const l=BN(t,n,a,i);let o;try{o=await e(s,Object.assign({},l))}catch(c){throw console.error(c),new Qu(Kr(c),0)}if(o.ok||await hf(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(c){await hf(c)}}function cs(e){var t;let s=null;HN(e)&&(s=Object.assign({},e),e.expires_at||(s.expires_at=SN(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:s,user:n},error:null}}function mf(e){const t=cs(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((s,n)=>s&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function or(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function WN(e){return{data:e,error:null}}function VN(e){const{action_link:t,email_otp:s,hashed_token:n,redirect_to:a,verification_type:i}=e,l=qo(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:s,hashed_token:n,redirect_to:a,verification_type:i},c=Object.assign({},l);return{data:{properties:o,user:c},error:null}}function ff(e){return e}function HN(e){return e.access_token&&e.refresh_token&&e.expires_in}const kc=["global","local","others"];class QN{constructor({url:t="",headers:s={},fetch:n}){this.url=t,this.headers=s,this.fetch=Bg(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,s=kc[0]){if(kc.indexOf(s)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${kc.join(", ")}`);try{return await de(this.fetch,"POST",`${this.url}/logout?scope=${s}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(ne(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,s={}){try{return await de(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:s.data},headers:this.headers,redirectTo:s.redirectTo,xform:or})}catch(n){if(ne(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:s}=t,n=qo(t,["options"]),a=Object.assign(Object.assign({},n),s);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await de(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:VN,redirectTo:s==null?void 0:s.redirectTo})}catch(s){if(ne(s))return{data:{properties:null,user:null},error:s};throw s}}async createUser(t){try{return await de(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:or})}catch(s){if(ne(s))return{data:{user:null},error:s};throw s}}async listUsers(t){var s,n,a,i,l,o,c;try{const u={nextPage:null,lastPage:0,total:0},d=await de(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(s=t==null?void 0:t.page)===null||s===void 0?void 0:s.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:ff});if(d.error)throw d.error;const m=await d.json(),f=(l=d.headers.get("x-total-count"))!==null&&l!==void 0?l:0,v=(c=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&c!==void 0?c:[];return v.length>0&&(v.forEach(g=>{const w=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(g.split(";")[1].split("=")[1]);u[`${_}Page`]=w}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},m),u),error:null}}catch(u){if(ne(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){Sn(t);try{return await de(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:or})}catch(s){if(ne(s))return{data:{user:null},error:s};throw s}}async updateUserById(t,s){Sn(t);try{return await de(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:s,headers:this.headers,xform:or})}catch(n){if(ne(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,s=!1){Sn(t);try{return await de(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:s},xform:or})}catch(n){if(ne(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Sn(t.userId);try{const{data:s,error:n}=await de(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:s,error:n}}catch(s){if(ne(s))return{data:null,error:s};throw s}}async _deleteFactor(t){Sn(t.userId),Sn(t.id);try{return{data:await de(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(s){if(ne(s))return{data:null,error:s};throw s}}async _listOAuthClients(t){var s,n,a,i,l,o,c;try{const u={nextPage:null,lastPage:0,total:0},d=await de(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(s=t==null?void 0:t.page)===null||s===void 0?void 0:s.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:ff});if(d.error)throw d.error;const m=await d.json(),f=(l=d.headers.get("x-total-count"))!==null&&l!==void 0?l:0,v=(c=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&c!==void 0?c:[];return v.length>0&&(v.forEach(g=>{const w=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(g.split(";")[1].split("=")[1]);u[`${_}Page`]=w}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},m),u),error:null}}catch(u){if(ne(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(t){try{return await de(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(ne(s))return{data:null,error:s};throw s}}async _getOAuthClient(t){try{return await de(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(ne(s))return{data:null,error:s};throw s}}async _updateOAuthClient(t,s){try{return await de(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:s,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ne(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await de(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(s){if(ne(s))return{data:null,error:s};throw s}}async _regenerateOAuthClientSecret(t){try{return await de(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(ne(s))return{data:null,error:s};throw s}}}function pf(e={}){return{getItem:t=>e[t]||null,setItem:(t,s)=>{e[t]=s},removeItem:t=>{delete e[t]}}}const Cn={debug:!!(globalThis&&zg()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Kg extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class GN extends Kg{}async function JN(e,t,s){Cn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Cn.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){Cn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await s()}finally{Cn.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw Cn.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new GN(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Cn.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}}))}function YN(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Wg(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function XN(e){return parseInt(e,16)}function ZN(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function e1(e){var t;const{chainId:s,domain:n,expirationTime:a,issuedAt:i=new Date,nonce:l,notBefore:o,requestId:c,resources:u,scheme:d,uri:m,version:f}=e;{if(!Number.isInteger(s))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${s}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(l&&l.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${l}`);if(!m)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const v=Wg(e.address),g=d?`${d}://${n}`:n,w=e.statement?`${e.statement}
`:"",_=`${g} wants you to sign in with your Ethereum account:
${v}

${w}`;let x=`URI: ${m}
Version: ${f}
Chain ID: ${s}${l?`
Nonce: ${l}`:""}
Issued At: ${i.toISOString()}`;if(a&&(x+=`
Expiration Time: ${a.toISOString()}`),o&&(x+=`
Not Before: ${o.toISOString()}`),c&&(x+=`
Request ID: ${c}`),u){let p=`
Resources:`;for(const y of u){if(!y||typeof y!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${y}`);p+=`
- ${y}`}x+=p}return`${_}
${x}`}class Xe extends Error{constructor({message:t,code:s,cause:n,name:a}){var i;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(i=a??(n instanceof Error?n.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=s}}class mo extends Xe{constructor(t,s){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s,message:t}),this.name="WebAuthnUnknownError",this.originalError=s}}function t1({error:e,options:t}){var s,n,a;const{publicKey:i}=t;if(!i)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Xe({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((s=i.authenticatorSelection)===null||s===void 0?void 0:s.requireResidentKey)===!0)return new Xe({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Xe({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((a=i.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Xe({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Xe({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Xe({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return i.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new Xe({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Xe({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const l=window.location.hostname;if(Vg(l)){if(i.rp.id!==l)return new Xe({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Xe({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new Xe({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Xe({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Xe({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function s1({error:e,options:t}){const{publicKey:s}=t;if(!s)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Xe({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Xe({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(Vg(n)){if(s.rpId!==n)return new Xe({message:`The RP ID "${s.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Xe({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Xe({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Xe({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class r1{createNewAbortSignal(){if(this.controller){const s=new Error("Cancelling existing WebAuthn API call for new one");s.name="AbortError",this.controller.abort(s)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const n1=new r1;function a1(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:s,excludeCredentials:n}=e,a=qo(e,["challenge","user","excludeCredentials"]),i=ta(t).buffer,l=Object.assign(Object.assign({},s),{id:ta(s.id).buffer}),o=Object.assign(Object.assign({},a),{challenge:i,user:l});if(n&&n.length>0){o.excludeCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const u=n[c];o.excludeCredentials[c]=Object.assign(Object.assign({},u),{id:ta(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return o}function i1(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:s}=e,n=qo(e,["challenge","allowCredentials"]),a=ta(t).buffer,i=Object.assign(Object.assign({},n),{challenge:a});if(s&&s.length>0){i.allowCredentials=new Array(s.length);for(let l=0;l<s.length;l++){const o=s[l];i.allowCredentials[l]=Object.assign(Object.assign({},o),{id:ta(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return i}function l1(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const s=e;return{id:e.id,rawId:e.id,response:{attestationObject:Yr(new Uint8Array(e.response.attestationObject)),clientDataJSON:Yr(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=s.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function o1(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const s=e,n=e.getClientExtensionResults(),a=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Yr(new Uint8Array(a.authenticatorData)),clientDataJSON:Yr(new Uint8Array(a.clientDataJSON)),signature:Yr(new Uint8Array(a.signature)),userHandle:a.userHandle?Yr(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=s.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Vg(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function xf(){var e,t;return!!(ft()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function c1(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new mo("Browser returned unexpected credential type",t)}:{data:null,error:new mo("Empty credential response",t)}}catch(t){return{data:null,error:t1({error:t,options:e})}}}async function u1(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new mo("Browser returned unexpected credential type",t)}:{data:null,error:new mo("Empty credential response",t)}}catch(t){return{data:null,error:s1({error:t,options:e})}}}const d1={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},h1={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function fo(...e){const t=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),s=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),n={};for(const a of e)if(a)for(const i in a){const l=a[i];if(l!==void 0)if(Array.isArray(l))n[i]=l;else if(s(l))n[i]=l;else if(t(l)){const o=n[i];t(o)?n[i]=fo(o,l):n[i]=fo(l)}else n[i]=l}return n}function m1(e,t){return fo(d1,e,t||{})}function f1(e,t){return fo(h1,e,t||{})}class p1{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:s,friendlyName:n,signal:a},i){try{const{data:l,error:o}=await this.client.mfa.challenge({factorId:t,webauthn:s});if(!l)return{data:null,error:o};const c=a??n1.createNewAbortSignal();if(l.webauthn.type==="create"){const{user:u}=l.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${n}`),u.displayName||(u.displayName=u.name)}switch(l.webauthn.type){case"create":{const u=m1(l.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:d,error:m}=await c1({publicKey:u,signal:c});return d?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:d}},error:null}:{data:null,error:m}}case"request":{const u=f1(l.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:d,error:m}=await u1(Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:u,signal:c}));return d?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:d}},error:null}:{data:null,error:m}}}}catch(l){return ne(l)?{data:null,error:l}:{data:null,error:new Vr("Unexpected error in challenge",l)}}}async _verify({challengeId:t,factorId:s,webauthn:n}){return this.client.mfa.verify({factorId:s,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},i){if(!s)return{data:null,error:new Ai("rpId is required for WebAuthn authentication")};try{if(!xf())return{data:null,error:new Vr("Browser does not support WebAuthn",null)};const{data:l,error:o}=await this.challenge({factorId:t,webauthn:{rpId:s,rpOrigins:n},signal:a},{request:i});if(!l)return{data:null,error:o};const{webauthn:c}=l;return this._verify({factorId:t,challengeId:l.challengeId,webauthn:{type:c.type,rpId:s,rpOrigins:n,credential_response:c.credential_response}})}catch(l){return ne(l)?{data:null,error:l}:{data:null,error:new Vr("Unexpected error in authenticate",l)}}}async _register({friendlyName:t,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},i){if(!s)return{data:null,error:new Ai("rpId is required for WebAuthn registration")};try{if(!xf())return{data:null,error:new Vr("Browser does not support WebAuthn",null)};const{data:l,error:o}=await this._enroll({friendlyName:t});if(!l)return await this.client.mfa.listFactors().then(d=>{var m;return(m=d.data)===null||m===void 0?void 0:m.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===t&&f.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d==null?void 0:d.id}):void 0),{data:null,error:o};const{data:c,error:u}=await this._challenge({factorId:l.id,friendlyName:l.friendly_name,webauthn:{rpId:s,rpOrigins:n},signal:a},{create:i});return c?this._verify({factorId:l.id,challengeId:c.challengeId,webauthn:{rpId:s,rpOrigins:n,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:u}}catch(l){return ne(l)?{data:null,error:l}:{data:null,error:new Vr("Unexpected error in register",l)}}}}YN();const x1={url:dN,storageKey:hN,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:mN,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function gf(e,t,s){return await s()}const En={};class Ii{get jwks(){var t,s;return(s=(t=En[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&s!==void 0?s:{keys:[]}}set jwks(t){En[this.storageKey]=Object.assign(Object.assign({},En[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,s;return(s=(t=En[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&s!==void 0?s:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){En[this.storageKey]=Object.assign(Object.assign({},En[this.storageKey]),{cachedAt:t})}constructor(t){var s,n,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},x1),t);if(this.storageKey=i.storageKey,this.instanceID=(s=Ii.nextInstanceID[this.storageKey])!==null&&s!==void 0?s:0,Ii.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&ft()){const l=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(l),this.logDebugMessages&&console.trace(l)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new QN({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Bg(i.fetch),this.lock=i.lock||gf,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,i.lock?this.lock=i.lock:this.persistSession&&ft()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=JN:this.lock=gf,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new p1(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:zg()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=pf(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=pf(this.memoryStorage)),ft()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Dg}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let s={},n="none";if(ft()&&(s=EN(window.location.href),this._isImplicitGrantCallback(s)?n="implicit":await this._isPKCECallback(s)&&(n="pkce")),ft()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:i}=await this._getSessionFromURL(s,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),vN(i)){const c=(t=i.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:l,redirectType:o}=a;return this._debug("#_initialize()","detected session in URL",l,"redirect type",o),await this._saveSession(l),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(s){return ne(s)?this._returnResult({error:s}):this._returnResult({error:new Vr("Unexpected error during initialization",s)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var s,n,a;try{const i=await de(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:cs}),{data:l,error:o}=i;if(o||!l)return this._returnResult({data:{user:null,session:null},error:o});const c=l.session,u=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(i){if(ne(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(t){var s,n,a;try{let i;if("email"in t){const{email:d,password:m,options:f}=t;let v=null,g=null;this.flowType==="pkce"&&([v,g]=await kn(this.storage,this.storageKey)),i=await de(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:m,data:(s=f==null?void 0:f.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:v,code_challenge_method:g},xform:cs})}else if("phone"in t){const{phone:d,password:m,options:f}=t;i=await de(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:m,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(a=f==null?void 0:f.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:cs})}else throw new pl("You must provide either an email or phone number and a password");const{data:l,error:o}=i;if(o||!l)return await mt(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:o});const c=l.session,u=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(i){if(await mt(this.storage,`${this.storageKey}-code-verifier`),ne(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(t){try{let s;if("email"in t){const{email:i,password:l,options:o}=t;s=await de(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:l,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:mf})}else if("phone"in t){const{phone:i,password:l,options:o}=t;s=await de(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:l,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:mf})}else throw new pl("You must provide either an email or phone number and a password");const{data:n,error:a}=s;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!n||!n.session||!n.user){const i=new Nn;return this._returnResult({data:{user:null,session:null},error:i})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(s){if(ne(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOAuth(t){var s,n,a,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(s=t.options)===null||s===void 0?void 0:s.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:s}=t;switch(s){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${s}"`)}}async signInWithEthereum(t){var s,n,a,i,l,o,c,u,d,m,f;let v,g;if("message"in t)v=t.message,g=t.signature;else{const{chain:w,wallet:_,statement:x,options:p}=t;let y;if(ft())if(typeof _=="object")y=_;else{const R=window;if("ethereum"in R&&typeof R.ethereum=="object"&&"request"in R.ethereum&&typeof R.ethereum.request=="function")y=R.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof _!="object"||!(p!=null&&p.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");y=_}const j=new URL((s=p==null?void 0:p.url)!==null&&s!==void 0?s:window.location.href),b=await y.request({method:"eth_requestAccounts"}).then(R=>R).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!b||b.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const N=Wg(b[0]);let T=(n=p==null?void 0:p.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!T){const R=await y.request({method:"eth_chainId"});T=XN(R)}const h={domain:j.host,address:N,statement:x,uri:j.href,version:"1",chainId:T,nonce:(a=p==null?void 0:p.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(l=(i=p==null?void 0:p.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&l!==void 0?l:new Date,expirationTime:(o=p==null?void 0:p.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(c=p==null?void 0:p.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(u=p==null?void 0:p.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(d=p==null?void 0:p.signInWithEthereum)===null||d===void 0?void 0:d.resources};v=e1(h),g=await y.request({method:"personal_sign",params:[ZN(v),N]})}try{const{data:w,error:_}=await de(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:v,signature:g},!((m=t.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(f=t.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:cs});if(_)throw _;if(!w||!w.session||!w.user){const x=new Nn;return this._returnResult({data:{user:null,session:null},error:x})}return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),this._returnResult({data:Object.assign({},w),error:_})}catch(w){if(ne(w))return this._returnResult({data:{user:null,session:null},error:w});throw w}}async signInWithSolana(t){var s,n,a,i,l,o,c,u,d,m,f,v;let g,w;if("message"in t)g=t.message,w=t.signature;else{const{chain:_,wallet:x,statement:p,options:y}=t;let j;if(ft())if(typeof x=="object")j=x;else{const N=window;if("solana"in N&&typeof N.solana=="object"&&("signIn"in N.solana&&typeof N.solana.signIn=="function"||"signMessage"in N.solana&&typeof N.solana.signMessage=="function"))j=N.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");j=x}const b=new URL((s=y==null?void 0:y.url)!==null&&s!==void 0?s:window.location.href);if("signIn"in j&&j.signIn){const N=await j.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},y==null?void 0:y.signInWithSolana),{version:"1",domain:b.host,uri:b.href}),p?{statement:p}:null));let T;if(Array.isArray(N)&&N[0]&&typeof N[0]=="object")T=N[0];else if(N&&typeof N=="object"&&"signedMessage"in N&&"signature"in N)T=N;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in T&&"signature"in T&&(typeof T.signedMessage=="string"||T.signedMessage instanceof Uint8Array)&&T.signature instanceof Uint8Array)g=typeof T.signedMessage=="string"?T.signedMessage:new TextDecoder().decode(T.signedMessage),w=T.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in j)||typeof j.signMessage!="function"||!("publicKey"in j)||typeof j!="object"||!j.publicKey||!("toBase58"in j.publicKey)||typeof j.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${b.host} wants you to sign in with your Solana account:`,j.publicKey.toBase58(),...p?["",p,""]:[""],"Version: 1",`URI: ${b.href}`,`Issued At: ${(a=(n=y==null?void 0:y.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=y==null?void 0:y.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...!((l=y==null?void 0:y.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...!((o=y==null?void 0:y.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...!((c=y==null?void 0:y.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...!((u=y==null?void 0:y.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...!((m=(d=y==null?void 0:y.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||m===void 0)&&m.length?["Resources",...y.signInWithSolana.resources.map(T=>`- ${T}`)]:[]].join(`
`);const N=await j.signMessage(new TextEncoder().encode(g),"utf8");if(!N||!(N instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=N}}try{const{data:_,error:x}=await de(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:Yr(w)},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(v=t.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:cs});if(x)throw x;if(!_||!_.session||!_.user){const p=new Nn;return this._returnResult({data:{user:null,session:null},error:p})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:x})}catch(_){if(ne(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async _exchangeCodeForSession(t){const s=await Ur(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(s??"").split("/");try{if(!n&&this.flowType==="pkce")throw new jN;const{data:i,error:l}=await de(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:cs});if(await mt(this.storage,`${this.storageKey}-code-verifier`),l)throw l;if(!i||!i.session||!i.user){const o=new Nn;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:l})}catch(i){if(await mt(this.storage,`${this.storageKey}-code-verifier`),ne(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(t){try{const{options:s,provider:n,token:a,access_token:i,nonce:l}=t,o=await de(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:i,nonce:l,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:cs}),{data:c,error:u}=o;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!c||!c.session||!c.user){const d=new Nn;return this._returnResult({data:{user:null,session:null},error:d})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:u})}catch(s){if(ne(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOtp(t){var s,n,a,i,l;try{if("email"in t){const{email:o,options:c}=t;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await kn(this.storage,this.storageKey));const{error:m}=await de(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:m})}if("phone"in t){const{phone:o,options:c}=t,{data:u,error:d}=await de(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(a=c==null?void 0:c.data)!==null&&a!==void 0?a:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(l=c==null?void 0:c.channel)!==null&&l!==void 0?l:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d})}throw new pl("You must provide either an email or phone number.")}catch(o){if(await mt(this.storage,`${this.storageKey}-code-verifier`),ne(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(t){var s,n;try{let a,i;"options"in t&&(a=(s=t.options)===null||s===void 0?void 0:s.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:l,error:o}=await de(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:cs});if(o)throw o;if(!l)throw new Error("An error occurred on token verification.");const c=l.session,u=l.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(a){if(ne(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(t){var s,n,a,i,l;try{let o=null,c=null;this.flowType==="pkce"&&([o,c]=await kn(this.storage,this.storageKey));const u=await de(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(s=t.options)===null||s===void 0?void 0:s.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:c}),headers:this.headers,xform:WN});return!((i=u.data)===null||i===void 0)&&i.url&&ft()&&!(!((l=t.options)===null||l===void 0)&&l.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(o){if(await mt(this.storage,`${this.storageKey}-code-verifier`),ne(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:s},error:n}=t;if(n)throw n;if(!s)throw new Bt;const{error:a}=await de(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:s.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(t){if(ne(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const s=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:i}=t,{error:l}=await de(this.fetch,"POST",s,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:l})}else if("phone"in t){const{phone:n,type:a,options:i}=t,{data:l,error:o}=await de(this.fetch,"POST",s,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:o})}throw new pl("You must provide either an email or phone number and a type")}catch(s){if(ne(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async s=>s))}async _acquireLock(t,s){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await s()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=s();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const s=await this.__loadSession();return await t(s)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const s=await Ur(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",s),s!==null&&(this._isValidSession(s)?t=s:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<wc:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const l=await Ur(this.userStorage,this.storageKey+"-user");l!=null&&l.user?t.user=l.user:t.user=Nc()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const l={value:this.suppressGetSessionWarning};t.user=UN(t.user,l),l.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const s=await this._acquireLock(-1,async()=>await this._getUser());return s.data.user&&(this.suppressGetSessionWarning=!0),s}async _getUser(t){try{return t?await de(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:or}):await this._useSession(async s=>{var n,a,i;const{data:l,error:o}=s;if(o)throw o;return!(!((n=l.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Bt}:await de(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:or})})}catch(s){if(ne(s))return yN(s)&&(await this._removeSession(),await mt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:s});throw s}}async updateUser(t,s={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,s))}async _updateUser(t,s={}){try{return await this._useSession(async n=>{const{data:a,error:i}=n;if(i)throw i;if(!a.session)throw new Bt;const l=a.session;let o=null,c=null;this.flowType==="pkce"&&t.email!=null&&([o,c]=await kn(this.storage,this.storageKey));const{data:u,error:d}=await de(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:s==null?void 0:s.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:c}),jwt:l.access_token,xform:or});if(d)throw d;return l.user=u.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),this._returnResult({data:{user:l.user},error:null})})}catch(n){if(await mt(this.storage,`${this.storageKey}-code-verifier`),ne(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Bt;const s=Date.now()/1e3;let n=s,a=!0,i=null;const{payload:l}=bc(t.access_token);if(l.exp&&(n=l.exp,a=n<=s),a){const{data:o,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:c}=await this._getUser(t.access_token);if(c)throw c;i={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-s,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(s){if(ne(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async s=>{var n;if(!t){const{data:l,error:o}=s;if(o)throw o;t=(n=l.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Bt;const{data:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(s){if(ne(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async _getSessionFromURL(t,s){try{if(!ft())throw new xl("No browser detected.");if(t.error||t.error_description||t.error_code)throw new xl(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(s){case"implicit":if(this.flowType==="pkce")throw new af("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new xl("Not a valid implicit grant flow url.");break;default:}if(s==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new af("No code detected.");const{data:p,error:y}=await this._exchangeCodeForSession(t.code);if(y)throw y;const j=new URL(window.location.href);return j.searchParams.delete("code"),window.history.replaceState(window.history.state,"",j.toString()),{data:{session:p.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:i,refresh_token:l,expires_in:o,expires_at:c,token_type:u}=t;if(!i||!o||!l||!u)throw new xl("No session defined in URL");const d=Math.round(Date.now()/1e3),m=parseInt(o);let f=d+m;c&&(f=parseInt(c));const v=f-d;v*1e3<=On&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${m}s`);const g=f-m;d-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,f,d):d-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,f,d);const{data:w,error:_}=await this._getUser(i);if(_)throw _;const x={provider_token:n,provider_refresh_token:a,access_token:i,expires_in:m,expires_at:f,refresh_token:l,token_type:u,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:x,redirectType:t.type},error:null})}catch(n){if(ne(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const s=await Ur(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&s)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async s=>{var n;const{data:a,error:i}=s;if(i)return this._returnResult({error:i});const l=(n=a.session)===null||n===void 0?void 0:n.access_token;if(l){const{error:o}=await this.admin.signOut(l,t);if(o&&!(gN(o)&&(o.status===404||o.status===401||o.status===403)))return this._returnResult({error:o})}return t!=="others"&&(await this._removeSession(),await mt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const s=CN(),n={id:s,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",s),this.stateChangeEmitters.delete(s)}};return this._debug("#onAuthStateChange()","registered callback with id",s),this.stateChangeEmitters.set(s,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(s)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async s=>{var n,a;try{const{data:{session:i},error:l}=s;if(l)throw l;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,s={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await kn(this.storage,this.storageKey,!0));try{return await de(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:s.captchaToken}},headers:this.headers,redirectTo:s.redirectTo})}catch(i){if(await mt(this.storage,`${this.storageKey}-code-verifier`),ne(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var t;try{const{data:s,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=s.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(s){if(ne(s))return this._returnResult({data:null,error:s});throw s}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var s;try{const{data:n,error:a}=await this._useSession(async i=>{var l,o,c,u,d;const{data:m,error:f}=i;if(f)throw f;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(l=t.options)===null||l===void 0?void 0:l.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await de(this.fetch,"GET",v,{headers:this.headers,jwt:(d=(u=m.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(a)throw a;return ft()&&!(!((s=t.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(ne(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async s=>{var n;try{const{error:a,data:{session:i}}=s;if(a)throw a;const{options:l,provider:o,token:c,access_token:u,nonce:d}=t,m=await de(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=i==null?void 0:i.access_token)!==null&&n!==void 0?n:void 0,body:{provider:o,id_token:c,access_token:u,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:cs}),{data:f,error:v}=m;return v?this._returnResult({data:{user:null,session:null},error:v}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new Nn}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:v}))}catch(a){if(await mt(this.storage,`${this.storageKey}-code-verifier`),ne(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(t){try{return await this._useSession(async s=>{var n,a;const{data:i,error:l}=s;if(l)throw l;return await de(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(s){if(ne(s))return this._returnResult({data:null,error:s});throw s}}async _refreshAccessToken(t){const s=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{const n=Date.now();return await RN(async a=>(a>0&&await TN(200*Math.pow(2,a-1)),this._debug(s,"refreshing attempt",a),await de(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:cs})),(a,i)=>{const l=200*Math.pow(2,a);return i&&_c(i)&&Date.now()+l-n<On})}catch(n){if(this._debug(s,"error",n),ne(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(s,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,s){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:s.redirectTo,scopes:s.scopes,queryParams:s.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",s,"url",n),ft()&&!s.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,s;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await Ur(this.storage,this.storageKey);if(a&&this.userStorage){let l=await Ur(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:a.user},await An(this.userStorage,this.storageKey+"-user",l)),a.user=(t=l==null?void 0:l.user)!==null&&t!==void 0?t:Nc()}else if(a&&!a.user&&!a.user){const l=await Ur(this.storage,this.storageKey+"-user");l&&(l!=null&&l.user)?(a.user=l.user,await mt(this.storage,this.storageKey+"-user"),await An(this.storage,this.storageKey,a)):a.user=Nc()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const i=((s=a.expires_at)!==null&&s!==void 0?s:1/0)*1e3-Date.now()<wc;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${wc}s`),i){if(this.autoRefreshToken&&a.refresh_token){const{error:l}=await this._callRefreshToken(a.refresh_token);l&&(console.error(l),_c(l)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:o}=await this._getUser(a.access_token);!o&&(l!=null&&l.user)?(a.user=l.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(n,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var s,n;if(!t)throw new Bt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Lo;const{data:i,error:l}=await this._refreshAccessToken(t);if(l)throw l;if(!i.session)throw new Bt;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={data:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(a,"error",i),ne(i)){const l={data:null,error:i};return _c(i)||await this._removeSession(),(s=this.refreshingDeferred)===null||s===void 0||s.resolve(l),l}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,s,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",s,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:s});const i=[],l=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,s)}catch(c){i.push(c)}});if(await Promise.all(l),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await mt(this.storage,`${this.storageKey}-code-verifier`);const s=Object.assign({},t),n=s.user&&s.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&s.user&&await An(this.userStorage,this.storageKey+"-user",{user:s.user});const a=Object.assign({},s);delete a.user;const i=df(a);await An(this.storage,this.storageKey,i)}else{const a=df(s);await An(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await mt(this.storage,this.storageKey),await mt(this.storage,this.storageKey+"-code-verifier"),await mt(this.storage,this.storageKey+"-user"),this.userStorage&&await mt(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&ft()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(s){console.error("removing visibilitychange callback failed",s)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),On);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async s=>{const{data:{session:n}}=s;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/On);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${On}ms, refresh threshold is ${Vu} ticks`),a<=Vu&&await this._callRefreshToken(n.refresh_token)})}catch(s){console.error("Auto refresh tick failed with error. This is likely a transient error.",s)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Kg)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ft()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const s=`#_onVisibilityChanged(${t})`;this._debug(s,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(s,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,s,n){const a=[`provider=${encodeURIComponent(s)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,l]=await kn(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(l)}`});a.push(o.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);a.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async s=>{var n;const{data:a,error:i}=s;return i?this._returnResult({data:null,error:i}):await de(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(s){if(ne(s))return this._returnResult({data:null,error:s});throw s}}async _enroll(t){try{return await this._useSession(async s=>{var n,a;const{data:i,error:l}=s;if(l)return this._returnResult({data:null,error:l});const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:c,error:u}=await de(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return u?this._returnResult({data:null,error:u}):(t.factorType==="totp"&&c.type==="totp"&&(!((a=c==null?void 0:c.totp)===null||a===void 0)&&a.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(s){if(ne(s))return this._returnResult({data:null,error:s});throw s}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var n;const{data:a,error:i}=s;if(i)return this._returnResult({data:null,error:i});const l=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?l1(t.webauthn.credential_response):o1(t.webauthn.credential_response)})}:{code:t.code}),{data:o,error:c}=await de(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:l,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:c}))})}catch(s){if(ne(s))return this._returnResult({data:null,error:s});throw s}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var n;const{data:a,error:i}=s;if(i)return this._returnResult({data:null,error:i});const l=await de(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});if(l.error)return l;const{data:o}=l;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:a1(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:i1(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(s){if(ne(s))return this._returnResult({data:null,error:s});throw s}})}async _challengeAndVerify(t){const{data:s,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:s.id,code:t.code})}async _listFactors(){var t;const{data:{user:s},error:n}=await this.getUser();if(n)return{data:null,error:n};const a={all:[],phone:[],totp:[],webauthn:[]};for(const i of(t=s==null?void 0:s.factors)!==null&&t!==void 0?t:[])a.all.push(i),i.status==="verified"&&a[i.factor_type].push(i);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){var t,s;const{data:{session:n},error:a}=await this.getSession();if(a)return this._returnResult({data:null,error:a});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=bc(n.access_token);let l=null;i.aal&&(l=i.aal);let o=l;((s=(t=n.user.factors)===null||t===void 0?void 0:t.filter(d=>d.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(o="aal2");const u=i.amr||[];return{data:{currentLevel:l,nextLevel:o,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async s=>{const{data:{session:n},error:a}=s;return a?this._returnResult({data:null,error:a}):n?await de(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new Bt})})}catch(s){if(ne(s))return this._returnResult({data:null,error:s});throw s}}async _approveAuthorization(t,s){try{return await this._useSession(async n=>{const{data:{session:a},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!a)return this._returnResult({data:null,error:new Bt});const l=await de(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return l.data&&l.data.redirect_url&&ft()&&!(s!=null&&s.skipBrowserRedirect)&&window.location.assign(l.data.redirect_url),l})}catch(n){if(ne(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,s){try{return await this._useSession(async n=>{const{data:{session:a},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!a)return this._returnResult({data:null,error:new Bt});const l=await de(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return l.data&&l.data.redirect_url&&ft()&&!(s!=null&&s.skipBrowserRedirect)&&window.location.assign(l.data.redirect_url),l})}catch(n){if(ne(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:s},error:n}=t;return n?this._returnResult({data:null,error:n}):s?await de(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new Bt})})}catch(t){if(ne(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async s=>{const{data:{session:n},error:a}=s;return a?this._returnResult({data:null,error:a}):n?(await de(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Bt})})}catch(s){if(ne(s))return this._returnResult({data:null,error:s});throw s}}async fetchJwk(t,s={keys:[]}){let n=s.keys.find(o=>o.kid===t);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+pN>a)return n;const{data:i,error:l}=await de(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=a,n=i.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,s={}){try{let n=t;if(!n){const{data:v,error:g}=await this.getSession();if(g||!v.session)return this._returnResult({data:null,error:g});n=v.session.access_token}const{header:a,payload:i,signature:l,raw:{header:o,payload:c}}=bc(n);s!=null&&s.allowExpired||LN(i.exp);const u=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,s!=null&&s.keys?{keys:s.keys}:s==null?void 0:s.jwks);if(!u){const{error:v}=await this.getUser(n);if(v)throw v;return{data:{claims:i,header:a,signature:l},error:null}}const d=DN(a.alg),m=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,m,l,kN(`${o}.${c}`)))throw new Gu("Invalid JWT signature");return{data:{claims:i,header:a,signature:l},error:null}}catch(n){if(ne(n))return this._returnResult({data:null,error:n});throw n}}}Ii.nextInstanceID={};const g1=Ii,y1="2.89.0";let Ha="";typeof Deno<"u"?Ha="deno":typeof document<"u"?Ha="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ha="react-native":Ha="node";const v1={"X-Client-Info":`supabase-js-${Ha}/${y1}`},j1={headers:v1},w1={schema:"public"},_1={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},b1={};function $i(e){"@babel/helpers - typeof";return $i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$i(e)}function N1(e,t){if($i(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var n=s.call(e,t);if($i(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function k1(e){var t=N1(e,"string");return $i(t)=="symbol"?t:t+""}function S1(e,t,s){return(t=k1(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function yf(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),s.push.apply(s,n)}return s}function He(e){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?arguments[t]:{};t%2?yf(Object(s),!0).forEach(function(n){S1(e,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):yf(Object(s)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(s,n))})}return e}const C1=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),E1=()=>Headers,P1=(e,t,s)=>{const n=C1(s),a=E1();return async(i,l)=>{var o;const c=(o=await t())!==null&&o!==void 0?o:e;let u=new a(l==null?void 0:l.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),n(i,He(He({},l),{},{headers:u}))}};function T1(e){return e.endsWith("/")?e:e+"/"}function R1(e,t){var s,n;const{db:a,auth:i,realtime:l,global:o}=e,{db:c,auth:u,realtime:d,global:m}=t,f={db:He(He({},c),a),auth:He(He({},u),i),realtime:He(He({},d),l),storage:{},global:He(He(He({},m),o),{},{headers:He(He({},(s=m==null?void 0:m.headers)!==null&&s!==void 0?s:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?f.accessToken=e.accessToken:delete f.accessToken,f}function O1(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(T1(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var A1=class extends g1{constructor(e){super(e)}},I1=class{constructor(e,t,s){var n,a;this.supabaseUrl=e,this.supabaseKey=t;const i=O1(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const l=`sb-${i.hostname.split(".")[0]}-auth-token`,o={db:w1,realtime:b1,auth:He(He({},_1),{},{storageKey:l}),global:j1},c=R1(s??{},o);if(this.storageKey=(n=c.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(a=c.global.headers)!==null&&a!==void 0?a:{},c.accessToken)this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(d,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}});else{var u;this.auth=this._initSupabaseAuthClient((u=c.auth)!==null&&u!==void 0?u:{},this.headers,c.global.fetch)}this.fetch=P1(t,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(He({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.accessToken&&this.accessToken().then(d=>this.realtime.setAuth(d)).catch(d=>console.warn("Failed to set initial Realtime auth token:",d)),this.rest=new mb(new URL("rest/v1",i).href,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),this.storage=new uN(this.storageUrl.href,this.headers,this.fetch,s==null?void 0:s.storage),c.accessToken||this._listenForAuthEvents()}get functions(){return new ob(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,s;if(e.accessToken)return await e.accessToken();const{data:n}=await e.auth.getSession();return(t=(s=n.session)===null||s===void 0?void 0:s.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,userStorage:a,storageKey:i,flowType:l,lock:o,debug:c,throwOnError:u},d,m){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new A1({url:this.authUrl.href,headers:He(He({},f),d),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,userStorage:a,flowType:l,lock:o,debug:c,throwOnError:u,fetch:m,hasCustomAuthorizationHeader:Object.keys(this.headers).some(v=>v.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new Tb(this.realtimeUrl.href,He(He({},e),{},{params:He(He({},{apikey:this.supabaseKey}),e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,t,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?(this.changedAccessToken=s,this.realtime.setAuth(s)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const $1=(e,t,s)=>new I1(e,t,s);function q1(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}q1()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const M1="https://recvvlrcvowbzqpjyihk.supabase.co",L1="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJlY3Z2bHJjdm93YnpxcGp5aWhrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY0MDk3OTIsImV4cCI6MjA4MTk4NTc5Mn0.J-rYLEA1thxGfpLeNS6IAk_ahoRgIwx3RW9Soe5ZqBc",I=$1(M1,L1);function D1(){const[e,t]=S.useState(""),[s,n]=S.useState(""),[a,i]=S.useState(""),[l,o]=S.useState(!1),c=Ea(),u=Zd(m=>m.login),d=async m=>{m.preventDefault(),i(""),o(!0);try{const{data:f,error:v}=await I.from("users").select("*, role:roles(*), branch:branches(*)").eq("username",e).eq("status","active").single();if(v||!f){i("      ");return}if(f.password_hash!==s){i("      ");return}u(f),c("/dashboard")}catch{i("    ")}finally{o(!1)}};return r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-blue-100 p-4",children:r.jsxs(le,{className:"w-full max-w-md",children:[r.jsxs(Se,{className:"text-center",children:[r.jsx("div",{className:"flex justify-center mb-4",children:r.jsx("img",{src:"/el-fagr/logo.jpg",alt:" ",className:"w-24 h-24 rounded-xl object-contain"})}),r.jsx(Ge,{className:"text-2xl",children:" "}),r.jsx(Pg,{children:"  "})]}),r.jsx(Ce,{children:r.jsxs("form",{onSubmit:d,className:"space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:" "}),r.jsx(G,{value:e,onChange:m=>t(m.target.value),placeholder:"  ",required:!0})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",children:" "}),r.jsx(G,{type:"password",value:s,onChange:m=>n(m.target.value),placeholder:"  ",required:!0})]}),a&&r.jsx("p",{className:"text-sm text-destructive",children:a}),r.jsx(L,{type:"submit",className:"w-full",disabled:l,children:l?" ...":" "})]})})]})})}function F1(){const[e,t]=S.useState("all"),{data:s}=se({queryKey:["dashboard-branches"],queryFn:async()=>{const{data:i}=await I.from("branches").select("*").eq("status","active").order("name_ar");return i||[]}}),{data:n}=se({queryKey:["dashboard-stats",e],queryFn:async()=>{var _,x,p;let i=I.from("products").select("id",{count:"exact",head:!0}),l=I.from("customers").select("id",{count:"exact",head:!0}),o=I.from("sales").select("total_amount, cost_price:sale_items(cost_price, quantity)").eq("status","completed"),c=I.from("inventory").select("quantity, product_id");e!=="all"&&(l=l.eq("branch_id",e),o=o.eq("branch_id",e),c=c.eq("branch_id",e));const[u,d,m,f]=await Promise.all([i,l,o,c]),v=((_=m.data)==null?void 0:_.reduce((y,j)=>y+(j.total_amount||0),0))||0;let g=0;(x=m.data)==null||x.forEach(y=>{const j=y.total_amount||0;g+=j*.2});const w=((p=f.data)==null?void 0:p.filter(y=>(y.quantity||0)<10).length)||0;return{productsCount:u.count||0,customersCount:d.count||0,totalSales:v,totalProfit:g,lowStockCount:w}}}),a=[{title:" ",value:M((n==null?void 0:n.totalSales)||0),icon:Lu,color:"text-green-600"},{title:"",value:M((n==null?void 0:n.totalProfit)||0),icon:Lu,color:"text-emerald-600"},{title:"",value:(n==null?void 0:n.productsCount)||0,icon:$o,color:"text-blue-600"},{title:"",value:(n==null?void 0:n.customersCount)||0,icon:_a,color:"text-purple-600"},{title:"  ",value:(n==null?void 0:n.lowStockCount)||0,icon:gn,color:"text-red-600"}];return r.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl sm:text-2xl font-bold",children:" "}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"     "})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Ir,{className:"h-5 w-5 text-muted-foreground"}),r.jsxs("select",{value:e,onChange:i=>t(i.target.value),className:"px-3 sm:px-4 py-2 border rounded-md bg-background text-sm w-full sm:w-auto",children:[r.jsx("option",{value:"all",children:" "}),s==null?void 0:s.map(i=>r.jsx("option",{value:i.id,children:i.name_ar},i.id))]})]})]}),r.jsx("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5",children:a.map(i=>r.jsxs(le,{children:[r.jsxs(Se,{className:"flex flex-row items-center justify-between pb-2",children:[r.jsx(Ge,{className:"text-sm font-medium",children:i.title}),r.jsx(i.icon,{className:`h-5 w-5 ${i.color}`})]}),r.jsx(Ce,{children:r.jsx("div",{className:"text-2xl font-bold",children:i.value})})]},i.title))}),r.jsxs("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 md:grid-cols-2",children:[r.jsxs(le,{children:[r.jsx(Se,{children:r.jsx(Ge,{children:" "})}),r.jsx(Ce,{children:r.jsx(U1,{})})]}),r.jsxs(le,{children:[r.jsx(Se,{children:r.jsx(Ge,{children:" "})}),r.jsx(Ce,{children:r.jsx(z1,{})})]})]})]})}function U1(){const{data:e}=se({queryKey:["recent-sales"],queryFn:async()=>{const{data:t}=await I.from("sales").select("*, customer:customers(name)").order("created_at",{ascending:!1}).limit(5);return t||[]}});return e!=null&&e.length?r.jsx("div",{className:"space-y-3",children:e.map(t=>{var s;return r.jsxs("div",{className:"flex items-center justify-between border-b pb-2",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:t.invoice_number}),r.jsx("p",{className:"text-sm text-muted-foreground",children:((s=t.customer)==null?void 0:s.name)||t.customer_name||" "})]}),r.jsx("span",{className:"font-medium",children:M(t.total_amount||0)})]},t.id)})}):r.jsx("p",{className:"text-muted-foreground text-sm",children:"    "})}function z1(){const{data:e}=se({queryKey:["low-stock"],queryFn:async()=>{const{data:t}=await I.from("inventory").select("quantity, product:products(name, name_ar, min_stock_level)").lt("quantity",10).limit(5);return t||[]}});return e!=null&&e.length?r.jsx("div",{className:"space-y-3",children:e.map((t,s)=>{var n,a;return r.jsxs("div",{className:"flex items-center justify-between border-b pb-2",children:[r.jsx("p",{className:"font-medium",children:((n=t.product)==null?void 0:n.name_ar)||((a=t.product)==null?void 0:a.name)}),r.jsxs("span",{className:"text-destructive font-medium",children:[t.quantity," "]})]},s)})}):r.jsx("p",{className:"text-muted-foreground text-sm",children:"  "})}function et({open:e,onOpenChange:t,children:s}){return e?r.jsxs("div",{className:"fixed inset-0 z-50",children:[r.jsx("div",{className:"fixed inset-0 bg-black/50",onClick:()=>t(!1)}),r.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-2 sm:p-4",children:s})]}):null}function tt({children:e,className:t,onClose:s}){return r.jsxs("div",{className:Ut("relative bg-background rounded-lg shadow-lg max-h-[90vh] overflow-auto","w-full max-w-lg p-4 sm:p-6",t),children:[s&&r.jsx("button",{type:"button",onClick:s,className:"absolute left-2 sm:left-4 top-2 sm:top-4 rounded-sm opacity-70 hover:opacity-100 z-10",title:"","aria-label":"",children:r.jsx(sh,{className:"h-5 w-5"})}),e]})}function it({children:e,className:t}){return r.jsx("div",{className:Ut("mb-4",t),children:e})}function lt({children:e,className:t}){return r.jsx("h2",{className:Ut("text-base sm:text-lg font-semibold pr-8",t),children:e})}function js({children:e,className:t}){return r.jsx("div",{className:Ut("mt-6 flex justify-end gap-2",t),children:e})}const Sc={code:"",name:"",name_ar:"",barcode:"",category_id:"",brand_id:"",unit_id:"",purchase_price:0,selling_price:0};function B1(){const[e,t]=S.useState(""),[s,n]=S.useState(!1),[a,i]=S.useState(Sc),[l,o]=S.useState(null),[c,u]=S.useState(1),d=10,m=ht(),{data:f,isLoading:v}=se({queryKey:["products",e,c],queryFn:async()=>{let h=I.from("products").select("*",{count:"exact",head:!0});e&&(h=h.or(`name.ilike.%${e}%,name_ar.ilike.%${e}%,code.ilike.%${e}%,barcode.ilike.%${e}%`));const{count:R}=await h;let P=I.from("products").select("*, category:categories(name_ar), brand:brands(name), unit:units(name_ar)").order("created_at",{ascending:!1});e&&(P=P.or(`name.ilike.%${e}%,name_ar.ilike.%${e}%,code.ilike.%${e}%,barcode.ilike.%${e}%`));const U=(c-1)*d,W=U+d-1,{data:ee}=await P.range(U,W);return{products:ee||[],totalCount:R||0,totalPages:Math.ceil((R||0)/d)}}}),g=(f==null?void 0:f.products)||[],w=(f==null?void 0:f.totalPages)||1,_=(f==null?void 0:f.totalCount)||0;is.useEffect(()=>{u(1)},[e]);const{data:x}=se({queryKey:["categories-list"],queryFn:async()=>{const{data:h}=await I.from("categories").select("id, name_ar").eq("is_active",!0);return h||[]}}),{data:p}=se({queryKey:["brands-list"],queryFn:async()=>{const{data:h}=await I.from("brands").select("id, name").eq("is_active",!0);return h||[]}}),{data:y}=se({queryKey:["units-list"],queryFn:async()=>{const{data:h}=await I.from("units").select("id, name_ar").eq("is_active",!0);return h||[]}}),j=dt({mutationFn:async()=>{l?await I.from("products").update(a).eq("id",l):await I.from("products").insert({...a,status:"active"})},onSuccess:()=>{m.invalidateQueries({queryKey:["products"]}),n(!1),i(Sc),o(null)}}),b=dt({mutationFn:async h=>{await I.from("products").delete().eq("id",h)},onSuccess:()=>m.invalidateQueries({queryKey:["products"]})}),N=h=>{o(h.id),i({code:h.code,name:h.name,name_ar:h.name_ar,barcode:h.barcode||"",category_id:h.category_id||"",brand_id:h.brand_id||"",unit_id:h.unit_id||"",purchase_price:h.purchase_price||0,selling_price:h.selling_price||0}),n(!0)},T=()=>{o(null),i(Sc),n(!0)};return r.jsxs("div",{className:"p-3 md:p-6 space-y-4 md:space-y-6",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl md:text-2xl font-bold",children:""}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"  "})]}),r.jsxs(L,{onClick:T,className:"w-full sm:w-auto",children:[r.jsx(Nt,{className:"h-4 w-4 ml-2"})," "]})]}),r.jsx(et,{open:s,onOpenChange:n,children:r.jsxs(tt,{onClose:()=>n(!1),className:"max-w-[95vw] sm:max-w-2xl max-h-[90vh] overflow-y-auto",children:[r.jsx(it,{children:r.jsx(lt,{className:"text-base sm:text-lg",children:l?" ":"  "})}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:" *"}),r.jsx(G,{value:a.code,onChange:h=>i({...a,code:h.target.value})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:""}),r.jsx(G,{value:a.barcode,onChange:h=>i({...a,barcode:h.target.value})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:"  *"}),r.jsx(G,{value:a.name,onChange:h=>i({...a,name:h.target.value})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:"  *"}),r.jsx(G,{value:a.name_ar,onChange:h=>i({...a,name_ar:h.target.value})})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"category-select",className:"text-sm font-medium",children:""}),r.jsxs("select",{id:"category-select",title:"",className:"w-full h-10 border rounded-md px-3 text-sm",value:a.category_id,onChange:h=>i({...a,category_id:h.target.value}),children:[r.jsx("option",{value:"",children:" "}),x==null?void 0:x.map(h=>r.jsx("option",{value:h.id,children:h.name_ar},h.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"brand-select",className:"text-sm font-medium",children:""}),r.jsxs("select",{id:"brand-select",title:"",className:"w-full h-10 border rounded-md px-3 text-sm",value:a.brand_id,onChange:h=>i({...a,brand_id:h.target.value}),children:[r.jsx("option",{value:"",children:" "}),p==null?void 0:p.map(h=>r.jsx("option",{value:h.id,children:h.name},h.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"unit-select",className:"text-sm font-medium",children:" *"}),r.jsxs("select",{id:"unit-select",title:"",className:"w-full h-10 border rounded-md px-3 text-sm",value:a.unit_id,onChange:h=>i({...a,unit_id:h.target.value}),children:[r.jsx("option",{value:"",children:" "}),y==null?void 0:y.map(h=>r.jsx("option",{value:h.id,children:h.name_ar},h.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:" "}),r.jsx(G,{type:"number",value:a.purchase_price,onChange:h=>i({...a,purchase_price:parseFloat(h.target.value)||0})})]}),r.jsxs("div",{className:"sm:col-span-2",children:[r.jsx("label",{className:"text-sm font-medium",children:" "}),r.jsx(G,{type:"number",value:a.selling_price,onChange:h=>i({...a,selling_price:parseFloat(h.target.value)||0})})]})]}),r.jsxs(js,{className:"flex-col sm:flex-row gap-2",children:[r.jsx(L,{variant:"outline",onClick:()=>n(!1),className:"w-full sm:w-auto",children:""}),r.jsx(L,{onClick:()=>j.mutate(),disabled:j.isPending,className:"w-full sm:w-auto",children:j.isPending?" ...":""})]})]})}),r.jsxs(le,{children:[r.jsx(Se,{children:r.jsx("div",{className:"flex items-center gap-4",children:r.jsxs("div",{className:"relative flex-1 max-w-full sm:max-w-sm",children:[r.jsx(Os,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),r.jsx(G,{placeholder:"     ...",value:e,onChange:h=>t(h.target.value),className:"pr-10"})]})})}),r.jsx(Ce,{children:v?r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:" ..."}):g!=null&&g.length?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"mb-4 text-sm text-muted-foreground",children:[" ",(c-1)*d+1," - ",Math.min(c*d,_),"  ",_," "]}),r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"w-full text-xs sm:text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b",children:[r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:" "}),r.jsx("th",{className:"text-right py-3 px-2",children:" "}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""})]})}),r.jsx("tbody",{children:g.map(h=>{var R,P;return r.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[r.jsx("td",{className:"py-3 px-2 font-mono",children:h.code}),r.jsx("td",{className:"py-3 px-2",children:h.name_ar}),r.jsx("td",{className:"py-3 px-2",children:((R=h.category)==null?void 0:R.name_ar)||"-"}),r.jsx("td",{className:"py-3 px-2",children:((P=h.brand)==null?void 0:P.name)||"-"}),r.jsx("td",{className:"py-3 px-2",children:M(h.purchase_price||0)}),r.jsx("td",{className:"py-3 px-2",children:M(h.selling_price||0)}),r.jsx("td",{className:"py-3 px-2",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${h.status==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:h.status==="active"?"":" "})}),r.jsx("td",{className:"py-3 px-2",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(L,{variant:"ghost",size:"icon",onClick:()=>N(h),title:"",children:r.jsx(yn,{className:"h-4 w-4"})}),r.jsx(L,{variant:"ghost",size:"icon",onClick:()=>b.mutate(h.id),title:"",children:r.jsx(Rs,{className:"h-4 w-4 text-destructive"})})]})})]},h.id)})})]})}),r.jsx("div",{className:"block md:hidden space-y-3",children:g.map(h=>{var R,P,U;return r.jsx(le,{className:"p-4",children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-bold text-sm",children:h.name_ar}),r.jsx("p",{className:"text-xs text-muted-foreground font-mono",children:h.code}),h.barcode&&r.jsxs("p",{className:"text-xs text-muted-foreground",children:[": ",h.barcode]})]}),r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${h.status==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:h.status==="active"?"":" "})]}),r.jsxs("div",{className:"space-y-1 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-medium",children:((R=h.category)==null?void 0:R.name_ar)||"-"})]}),((P=h.brand)==null?void 0:P.name)&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-medium",children:h.brand.name})]}),((U=h.unit)==null?void 0:U.name_ar)&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-medium",children:h.unit.name_ar})]}),r.jsxs("div",{className:"flex justify-between pt-2 border-t",children:[r.jsx("span",{className:"text-muted-foreground",children:" :"}),r.jsx("span",{className:"font-bold text-blue-600",children:M(h.purchase_price||0)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:" :"}),r.jsx("span",{className:"font-bold text-green-600",children:M(h.selling_price||0)})]})]}),r.jsxs("div",{className:"flex gap-2 pt-2",children:[r.jsxs(L,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>N(h),children:[r.jsx(yn,{className:"h-4 w-4 ml-2"}),""]}),r.jsxs(L,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>b.mutate(h.id),children:[r.jsx(Rs,{className:"h-4 w-4 ml-2 text-destructive"}),""]})]})]})},h.id)})}),w>1&&r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 mt-4 pt-4 border-t",children:[r.jsx(L,{variant:"outline",size:"sm",onClick:()=>u(h=>Math.max(1,h-1)),disabled:c===1,className:"w-full sm:w-auto",children:""}),r.jsx("div",{className:"flex items-center gap-1 sm:gap-2",children:r.jsxs("span",{className:"text-sm text-muted-foreground",children:[" ",c,"  ",w]})}),r.jsx(L,{variant:"outline",size:"sm",onClick:()=>u(h=>Math.min(w,h+1)),disabled:c===w,className:"w-full sm:w-auto",children:""})]})]}):r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:"  "})})]})]})}const gl={pending:{label:"",color:"bg-yellow-100 text-yellow-700"},active:{label:"",color:"bg-green-100 text-green-700"},on_hold:{label:"",color:"bg-orange-100 text-orange-700"},blocked:{label:"",color:"bg-red-100 text-red-700"},closed:{label:"",color:"bg-gray-100 text-gray-700"}};function K1(){const[e,t]=S.useState(""),[s,n]=S.useState(!1),[a,i]=S.useState("all"),[l,o]=S.useState(null),[c,u]=S.useState(1),d=10,[m,f]=S.useState({name_ar:"",phone:"",email:"",address:"",credit_limit:0,branch_id:"",tax_card_number:""}),v=ht(),{data:g}=se({queryKey:["customer-branches"],queryFn:async()=>{const{data:h}=await I.from("branches").select("*").eq("status","active").order("name_ar");return h||[]}}),{data:w,isLoading:_}=se({queryKey:["customers",e,a,c],queryFn:async()=>{let h=I.from("customers").select("*",{count:"exact",head:!0});e&&(h=h.or(`name.ilike.%${e}%,name_ar.ilike.%${e}%,code.ilike.%${e}%,phone.ilike.%${e}%`));const{count:R}=await h;let P=I.from("customers").select("*, group:customer_groups(name_ar), branch:branches(name_ar)").order("created_at",{ascending:!1});e&&(P=P.or(`name.ilike.%${e}%,name_ar.ilike.%${e}%,code.ilike.%${e}%,phone.ilike.%${e}%`));const U=(c-1)*d,W=U+d-1,{data:ee}=await P.range(U,W),oe=new Date().toISOString().split("T")[0],re=await Promise.all((ee||[]).map(async me=>{const{data:V}=await I.from("sales").select("remaining_amount, due_date").eq("customer_id",me.id).gt("remaining_amount",0).not("due_date","is",null).lt("due_date",oe),Y=(V||[]).reduce((O,C)=>O+(C.remaining_amount||0),0);let Z=0;if(V&&V.length>0){const O=V.reduce((C,B)=>{const K=B.due_date||"";return!C||K&&K<C?K:C},"");if(O){const C=new Date(O),B=new Date(oe);Z=Math.floor((B.getTime()-C.getTime())/(1e3*60*60*24))}}return{...me,overdueAmount:Y,daysOverdue:Z}}));let ue=re;return a==="overdue"&&(ue=re.filter(me=>(me.overdueAmount||0)>0)),{customers:ue,totalCount:R||0,totalPages:Math.ceil((R||0)/d)}}}),x=(w==null?void 0:w.customers)||[],p=(w==null?void 0:w.totalPages)||1,y=(w==null?void 0:w.totalCount)||0;is.useEffect(()=>{u(1)},[e,a]);const j=dt({mutationFn:async h=>{await I.from("customers").delete().eq("id",h)},onSuccess:()=>v.invalidateQueries({queryKey:["customers"]})}),b=dt({mutationFn:async()=>{if(l){const{error:h}=await I.from("customers").update({name_ar:m.name_ar,name:m.name_ar,phone:m.phone,email:m.email||null,address:m.address||null,tax_card_number:m.tax_card_number||null,credit_limit:m.credit_limit,branch_id:m.branch_id||null}).eq("id",l.id);if(h)throw h}else{const h=`CUS-${Date.now()}`,{error:R}=await I.from("customers").insert({code:h,name_ar:m.name_ar,name:m.name_ar,phone:m.phone,email:m.email||null,address:m.address||null,tax_card_number:m.tax_card_number||null,credit_limit:m.credit_limit,branch_id:m.branch_id||null,current_balance:0,status:"active"});if(R)throw R}},onSuccess:()=>{v.invalidateQueries({queryKey:["customers"]}),n(!1),o(null),f({name_ar:"",phone:"",email:"",address:"",credit_limit:0,branch_id:"",tax_card_number:""}),alert(l?"   !":"   !")},onError:h=>alert(": "+h.message)}),N=h=>{o(h),f({name_ar:h.name_ar||h.name,phone:h.phone,email:h.email||"",address:h.address||"",credit_limit:h.credit_limit||0,branch_id:h.branch_id||"",tax_card_number:h.tax_card_number||""}),n(!0)},T=()=>{n(!1),o(null),f({name_ar:"",phone:"",email:"",address:"",credit_limit:0,branch_id:"",tax_card_number:""})};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold",children:""}),r.jsx("p",{className:"text-muted-foreground",children:"  "})]}),r.jsxs(L,{onClick:()=>n(!0),children:[r.jsx(Nt,{className:"h-4 w-4 ml-2"})," "]})]}),r.jsx(et,{open:s,onOpenChange:T,children:r.jsxs(tt,{onClose:T,className:"max-w-lg",children:[r.jsx(it,{children:r.jsx(lt,{children:l?"  ":"  "})}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"name",className:"text-sm font-medium",children:"  *"}),r.jsx(G,{id:"name",value:m.name_ar,onChange:h=>f({...m,name_ar:h.target.value}),placeholder:"  "})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"phone",className:"text-sm font-medium",children:"  *"}),r.jsx(G,{id:"phone",value:m.phone,onChange:h=>f({...m,phone:h.target.value}),placeholder:"  "})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"email",className:"text-sm font-medium",children:" "}),r.jsx(G,{id:"email",type:"email",value:m.email,onChange:h=>f({...m,email:h.target.value}),placeholder:"  "})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"address",className:"text-sm font-medium",children:""}),r.jsx(G,{id:"address",value:m.address,onChange:h=>f({...m,address:h.target.value}),placeholder:" "})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"tax_card",className:"text-sm font-medium",children:"  "}),r.jsx(G,{id:"tax_card",value:m.tax_card_number,onChange:h=>f({...m,tax_card_number:h.target.value}),placeholder:"   "})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"credit",className:"text-sm font-medium",children:" "}),r.jsx(G,{id:"credit",type:"number",value:m.credit_limit,onChange:h=>f({...m,credit_limit:parseFloat(h.target.value)||0}),placeholder:"0"})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"branch",className:"text-sm font-medium",children:" *"}),r.jsxs("select",{id:"branch",value:m.branch_id,onChange:h=>f({...m,branch_id:h.target.value}),className:"w-full px-3 py-2 border rounded-md bg-background",children:[r.jsx("option",{value:"",children:" "}),g==null?void 0:g.map(h=>r.jsx("option",{value:h.id,children:h.name_ar},h.id))]})]})]}),r.jsxs(js,{children:[r.jsx(L,{variant:"outline",onClick:T,children:""}),r.jsx(L,{onClick:()=>b.mutate(),disabled:!m.name_ar||!m.phone||!m.branch_id||b.isPending,children:b.isPending?" ...":""})]})]})}),r.jsxs(le,{children:[r.jsx(Se,{children:r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{className:"relative flex-1 max-w-sm",children:[r.jsx(Os,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),r.jsx(G,{placeholder:"     ...",value:e,onChange:h=>t(h.target.value),className:"pr-10"})]}),r.jsxs("select",{value:a,onChange:h=>i(h.target.value),className:"px-3 py-2 border rounded-md bg-background","aria-label":" ",children:[r.jsx("option",{value:"all",children:" "}),r.jsx("option",{value:"overdue",children:"  "})]})]})}),r.jsx(Ce,{children:_?r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:" ..."}):x!=null&&x.length?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"mb-4 text-sm text-muted-foreground",children:[" ",(c-1)*d+1," - ",Math.min(c*d,y),"  ",y," "]}),r.jsx("div",{className:"overflow-x-auto -mx-4 sm:mx-0 hidden md:block",children:r.jsx("div",{className:"inline-block min-w-full align-middle",children:r.jsxs("table",{className:"w-full min-w-[800px]",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b",children:[r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:" "}),r.jsx("th",{className:"text-right py-3 px-2",children:" "}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""})]})}),r.jsx("tbody",{children:x==null?void 0:x.map(h=>{var R;return r.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[r.jsx("td",{className:"py-3 px-2 font-mono text-sm",children:h.code}),r.jsx("td",{className:"py-3 px-2",children:h.name_ar||h.name}),r.jsx("td",{className:"py-3 px-2",children:((R=h.branch)==null?void 0:R.name_ar)||"-"}),r.jsx("td",{className:"py-3 px-2",children:r.jsxs("div",{className:"flex flex-col gap-1 text-sm",children:[r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(co,{className:"h-3 w-3"}),h.phone]}),h.email&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(oo,{className:"h-3 w-3"}),h.email]})]})}),r.jsx("td",{className:"py-3 px-2",children:r.jsx("span",{className:h.current_balance&&h.current_balance>0?"text-destructive":"",children:M(h.current_balance||0)})}),r.jsx("td",{className:"py-3 px-2",children:(h.overdueAmount||0)>0?r.jsxs("span",{className:"text-destructive font-bold flex items-center gap-1",children:[r.jsx(gn,{className:"h-4 w-4"}),M(h.overdueAmount||0)]}):r.jsx("span",{className:"text-muted-foreground",children:"-"})}),r.jsx("td",{className:"py-3 px-2",children:(h.daysOverdue||0)>0?r.jsxs("span",{className:"text-destructive font-bold",children:[h.daysOverdue," "]}):r.jsx("span",{className:"text-muted-foreground",children:"-"})}),r.jsx("td",{className:"py-3 px-2",children:M(h.credit_limit||0)}),r.jsx("td",{className:"py-3 px-2",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${gl[h.status||"active"].color}`,children:gl[h.status||"active"].label})}),r.jsx("td",{className:"py-3 px-2",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(L,{variant:"ghost",size:"icon",onClick:()=>N(h),title:"",children:r.jsx(yn,{className:"h-4 w-4"})}),r.jsx(L,{variant:"ghost",size:"icon",onClick:()=>j.mutate(h.id),title:"",children:r.jsx(Rs,{className:"h-4 w-4 text-destructive"})})]})})]},h.id)})})]})})}),r.jsx("div",{className:"block md:hidden space-y-3",children:x==null?void 0:x.map(h=>{var R;return r.jsx(le,{className:"p-4",children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-bold text-sm",children:h.name_ar||h.name}),r.jsx("p",{className:"text-xs text-muted-foreground font-mono",children:h.code})]}),r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${gl[h.status||"active"].color}`,children:gl[h.status||"active"].label})]}),r.jsxs("div",{className:"space-y-1 text-sm",children:[((R=h.branch)==null?void 0:R.name_ar)&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-medium",children:h.branch.name_ar})]}),r.jsxs("div",{className:"flex items-center gap-2 pt-2 border-t",children:[r.jsx(co,{className:"h-4 w-4 text-muted-foreground"}),r.jsx("span",{children:h.phone})]}),h.email&&r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(oo,{className:"h-4 w-4 text-muted-foreground"}),r.jsx("span",{className:"text-xs",children:h.email})]}),r.jsxs("div",{className:"flex justify-between pt-2 border-t",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:`font-bold ${h.current_balance&&h.current_balance>0?"text-destructive":""}`,children:M(h.current_balance||0)})]}),(h.overdueAmount||0)>0&&r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[r.jsx(gn,{className:"h-4 w-4"}),":"]}),r.jsx("span",{className:"font-bold text-destructive",children:M(h.overdueAmount||0)})]}),(h.daysOverdue||0)>0&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:" :"}),r.jsxs("span",{className:"font-bold text-destructive",children:[h.daysOverdue," "]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:" :"}),r.jsx("span",{className:"font-medium",children:M(h.credit_limit||0)})]})]}),r.jsxs("div",{className:"flex gap-2 pt-2",children:[r.jsxs(L,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>N(h),children:[r.jsx(yn,{className:"h-4 w-4 ml-2"}),""]}),r.jsxs(L,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>j.mutate(h.id),children:[r.jsx(Rs,{className:"h-4 w-4 ml-2 text-destructive"}),""]})]})]})},h.id)})}),p>1&&r.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t",children:[r.jsx(L,{variant:"outline",size:"sm",onClick:()=>u(h=>Math.max(1,h-1)),disabled:c===1,children:""}),r.jsx("div",{className:"flex items-center gap-2",children:Array.from({length:Math.min(5,p)},(h,R)=>{let P;return p<=5||c<=3?P=R+1:c>=p-2?P=p-4+R:P=c-2+R,r.jsx(L,{variant:c===P?"default":"outline",size:"sm",onClick:()=>u(P),className:"w-10",children:P},P)})}),r.jsx(L,{variant:"outline",size:"sm",onClick:()=>u(h=>Math.min(p,h+1)),disabled:c===p,children:""})]})]}):r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:"  "})})]})]})}function W1(e){const t=window.open("","_blank","width=400,height=600");if(!t)return;const s=`
    <!DOCTYPE html>
    <html dir="rtl" lang="ar">
    <head>
      <meta charset="UTF-8">
      <title> ${e.invoice_number}</title>
      <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
          font-family: 'Segoe UI', Tahoma, Arial, sans-serif; 
          font-size: 12px; 
          padding: 10px;
          max-width: 80mm;
          margin: 0 auto;
        }
        .header { text-align: center; margin-bottom: 15px; border-bottom: 1px dashed #000; padding-bottom: 10px; }
        .header h1 { font-size: 18px; margin-bottom: 5px; }
        .header p { font-size: 10px; color: #666; }
        .info { margin-bottom: 10px; }
        .info-row { display: flex; justify-content: space-between; margin-bottom: 3px; }
        .items { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
        .items th, .items td { padding: 5px 3px; text-align: right; border-bottom: 1px solid #ddd; }
        .items th { background: #f5f5f5; font-size: 11px; }
        .totals { border-top: 1px dashed #000; padding-top: 10px; }
        .total-row { display: flex; justify-content: space-between; margin-bottom: 5px; }
        .total-row.grand { font-size: 16px; font-weight: bold; border-top: 1px solid #000; padding-top: 5px; margin-top: 5px; }
        .footer { text-align: center; margin-top: 15px; border-top: 1px dashed #000; padding-top: 10px; font-size: 10px; }
        @media print {
          body { padding: 0; }
          @page { margin: 5mm; }
        }
      </style>
    </head>
    <body>
      <div class="header">
        <h1> </h1>
      </div>
      
      <div class="info">
        <div class="info-row"><span> :</span><span>${e.invoice_number}</span></div>
        <div class="info-row"><span>:</span><span>${Ee(e.invoice_date)}</span></div>
        ${e.customer_name?`<div class="info-row"><span>:</span><span>${e.customer_name}</span></div>`:""}
        ${e.customer_phone?`<div class="info-row"><span>:</span><span>${e.customer_phone}</span></div>`:""}
        <div class="info-row"><span>:</span><span>${e.cashier_name}</span></div>
      </div>

      <table class="items">
        <thead>
          <tr>
            <th></th>
            <th></th>
            <th></th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          ${e.items.map(n=>`
            <tr>
              <td>${n.product_name}</td>
              <td>${n.quantity}</td>
              <td>${M(n.unit_price)}</td>
              <td>${M(n.total_price)}</td>
            </tr>
          `).join("")}
        </tbody>
      </table>

      <div class="totals">
        ${e.customer_previous_balance&&e.customer_previous_balance>0?`
          <div class="total-row" style="color: #d97706; font-weight: bold; border-bottom: 1px dashed #ccc; padding-bottom: 5px; margin-bottom: 5px;">
            <span> :</span>
            <span>${M(e.customer_previous_balance)}</span>
          </div>
        `:""}
        <div class="total-row"><span> :</span><span>${M(e.subtotal)}</span></div>
        ${e.discount_amount>0?`<div class="total-row"><span>:</span><span>-${M(e.discount_amount)}</span></div>`:""}
        ${e.tax_amount>0?`<div class="total-row"><span>:</span><span>${M(e.tax_amount)}</span></div>`:""}
        <div class="total-row grand"><span>:</span><span>${M(e.total_amount)}</span></div>
        <div class="total-row"><span>:</span><span>${M(e.paid_amount)}</span></div>
        ${e.remaining_amount>0?`<div class="total-row"><span>:</span><span>${M(e.remaining_amount)}</span></div>`:""}
        ${e.customer_previous_balance&&e.customer_previous_balance>0?`
          <div class="total-row" style="color: #dc2626; font-weight: bold; font-size: 14px; border-top: 2px solid #000; padding-top: 5px; margin-top: 5px;">
            <span> :</span>
            <span>${M(e.customer_previous_balance+(e.remaining_amount||0))}</span>
          </div>
        `:""}
        <div class="total-row"><span> :</span><span>${e.payment_method==="cash"?"":""}</span></div>
      </div>

      <div class="footer">
        <p>  </p>
        <p>     </p>
      </div>

      <script>
        window.onload = function() { window.print(); }
      <\/script>
    </body>
    </html>
  `;t.document.write(s),t.document.close()}function V1(){var me,V,Y,Z,O;const[e,t]=S.useState(""),[s,n]=S.useState(null),[a,i]=S.useState(!1),[l,o]=S.useState(!1),[c,u]=S.useState(""),[d,m]=S.useState("all"),[f,v]=S.useState("all"),[g,w]=S.useState("all"),[_,x]=S.useState("all"),[p,y]=S.useState(1),j=10,b=Ea(),N=ht(),{data:T}=se({queryKey:["sales-branches"],queryFn:async()=>{const{data:C}=await I.from("branches").select("*").eq("status","active").eq("branch_type","outlet").order("name_ar");return C||[]}}),{data:h,isLoading:R}=se({queryKey:["sales",e,d,f,g,_,p],queryFn:async()=>{let C=I.from("sales").select("*",{count:"exact",head:!0});e&&(C=C.or(`invoice_number.ilike.%${e}%,customer_name.ilike.%${e}%`)),_!=="all"&&(C=C.eq("branch_id",_)),d==="with_tax"?C=C.eq("has_tax",!0):d==="without_tax"&&(C=C.eq("has_tax",!1)),f==="paid"?C=C.eq("payment_status","paid"):f==="credit"&&(C=C.eq("payment_status","credit")),g==="lifted"?C=C.eq("is_lifted",!0):g==="not_lifted"&&(C=C.eq("is_lifted",!1));const{count:B}=await C;let K=I.from("sales").select("*, customer:customers(name, name_ar), branch:branches(name_ar)").order("created_at",{ascending:!1});e&&(K=K.or(`invoice_number.ilike.%${e}%,customer_name.ilike.%${e}%`)),_!=="all"&&(K=K.eq("branch_id",_)),d==="with_tax"?K=K.eq("has_tax",!0):d==="without_tax"&&(K=K.eq("has_tax",!1)),f==="paid"?K=K.eq("payment_status","paid"):f==="credit"&&(K=K.eq("payment_status","credit")),g==="lifted"?K=K.eq("is_lifted",!0):g==="not_lifted"&&(K=K.eq("is_lifted",!1));const ce=(p-1)*j,Q=ce+j-1,{data:ge}=await K.range(ce,Q);return{sales:ge||[],totalCount:B||0,totalPages:Math.ceil((B||0)/j)}}}),P=(h==null?void 0:h.sales)||[],U=(h==null?void 0:h.totalPages)||1,W=(h==null?void 0:h.totalCount)||0;is.useEffect(()=>{y(1)},[e,d,f,g,_]);const ee=async(C,B)=>{try{const{error:K}=await I.from("sales").update({is_lifted:B}).eq("id",C);if(K)throw K;N.invalidateQueries({queryKey:["sales"]}),alert(B?"   :  ":"   :   ")}catch(K){console.error("Error updating lifted status:",K),alert("     ")}},oe=async C=>{try{const{data:B,error:K}=await I.from("sales").select(`
          *,
          customer:customers(name_ar, phone),
          branch:branches(name_ar)
        `).eq("id",C).single();if(K){console.error("Error fetching sale:",K),alert("     : "+K.message);return}if(B){let ce="";const Q=B;if(Q.cashier_id){const{data:D}=await I.from("users").select("full_name_ar, full_name").eq("id",Q.cashier_id).single(),q=D||null;ce=(q==null?void 0:q.full_name_ar)||(q==null?void 0:q.full_name)||""}const{data:ge,error:Me}=await I.from("sale_items").select("*, product:products(name_ar, code)").eq("sale_id",C);Me&&console.error("Error fetching items:",Me),n({...B,items:ge||[],cashier:{full_name_ar:ce,full_name:ce}}),i(!0)}}catch(B){console.error("Error:",B),alert("   ")}},re=async C=>{var B,K,ce;try{const{data:Q,error:ge}=await I.from("sales").select(`
          *,
          customer:customers(name_ar, phone),
          branch:branches(name_ar)
        `).eq("id",C).single();if(ge){console.error("Error fetching sale for print:",ge),alert("      : "+ge.message);return}if(Q){let Me="";const A=Q;if(A.cashier_id){const{data:$}=await I.from("users").select("full_name_ar, full_name").eq("id",A.cashier_id).single(),z=$||null;Me=(z==null?void 0:z.full_name_ar)||(z==null?void 0:z.full_name)||""}const{data:D}=await I.from("sale_items").select("*, product:products(name_ar)").eq("sale_id",C);let q=0;if(A.customer_id){const{data:$}=await I.from("customers").select("current_balance").eq("id",A.customer_id).single();if($){const z=$,J=Q;q=(z.current_balance||0)-(J.remaining_amount||0)}}const k=Q;W1({invoice_number:k.invoice_number,invoice_date:k.invoice_date||k.created_at||"",customer_name:((B=A.customer)==null?void 0:B.name_ar)||A.customer_name,customer_phone:(K=A.customer)==null?void 0:K.phone,customer_previous_balance:q>0?q:void 0,items:(D||[]).map($=>{var z;return{product_name:((z=$.product)==null?void 0:z.name_ar)||"",quantity:$.quantity,unit_price:$.unit_price,total_price:$.total_price}}),subtotal:k.subtotal||k.total_amount,discount_amount:k.discount_amount||0,tax_amount:k.tax_amount||0,total_amount:k.total_amount,paid_amount:k.paid_amount||0,remaining_amount:k.remaining_amount||0,payment_method:k.payment_method||"cash",cashier_name:Me,branch_name:((ce=A.branch)==null?void 0:ce.name_ar)||""})}}catch(Q){console.error("Error:",Q),alert("   ")}};return r.jsxs("div",{className:"p-3 md:p-6 space-y-4 md:space-y-6",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl md:text-2xl font-bold",children:""}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"  "})]}),r.jsxs(L,{onClick:()=>b("/pos"),className:"w-full sm:w-auto",children:[r.jsx(Nt,{className:"h-4 w-4 ml-2"}),r.jsx("span",{className:"hidden sm:inline",children:" "}),r.jsx("span",{className:"sm:hidden",children:""})]})]}),r.jsxs(le,{children:[r.jsx(Se,{children:r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[r.jsxs("div",{className:"relative flex-1",children:[r.jsx(Os,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),r.jsx(G,{placeholder:"     ...",value:e,onChange:C=>t(C.target.value),className:"pr-10"})]}),r.jsxs("select",{value:d,onChange:C=>m(C.target.value),className:"px-3 py-2 border rounded-md bg-background text-sm","aria-label":" ",children:[r.jsx("option",{value:"all",children:" ()"}),r.jsx("option",{value:"with_tax",children:""}),r.jsx("option",{value:"without_tax",children:" "})]}),r.jsxs("select",{value:f,onChange:C=>v(C.target.value),className:"px-3 py-2 border rounded-md bg-background text-sm","aria-label":" ",children:[r.jsx("option",{value:"all",children:" ()"}),r.jsx("option",{value:"paid",children:""}),r.jsx("option",{value:"credit",children:""})]}),r.jsxs("select",{value:g,onChange:C=>w(C.target.value),className:"px-3 py-2 border rounded-md bg-background text-sm","aria-label":" ",children:[r.jsx("option",{value:"all",children:" ()"}),r.jsx("option",{value:"lifted",children:" "}),r.jsx("option",{value:"not_lifted",children:"  "})]}),r.jsxs("select",{value:_,onChange:C=>x(C.target.value),className:"px-3 py-2 border rounded-md bg-background text-sm","aria-label":" ",children:[r.jsx("option",{value:"all",children:" "}),T==null?void 0:T.map(C=>r.jsx("option",{value:C.id,children:C.name_ar},C.id))]})]})}),r.jsx(Ce,{children:R?r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:" ..."}):P!=null&&P.length?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"mb-4 text-xs sm:text-sm text-muted-foreground",children:[" ",(p-1)*j+1," - ",Math.min(p*j,W),"  ",W," "]}),r.jsx("div",{className:"block md:hidden space-y-3",children:P.map(C=>{var B,K;return r.jsx(le,{className:"p-3",children:r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-bold text-sm font-mono",children:C.invoice_number}),r.jsx("p",{className:"text-xs text-muted-foreground",children:Ee(C.invoice_date||C.created_at)})]}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx(L,{variant:"ghost",size:"sm",onClick:()=>oe(C.id),title:"",children:r.jsx(Mt,{className:"h-4 w-4"})}),r.jsx(L,{variant:"ghost",size:"sm",onClick:()=>re(C.id),title:"",children:r.jsx(Rr,{className:"h-4 w-4"})})]})]}),r.jsxs("div",{className:"space-y-1 text-xs",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:": "}),r.jsx("span",{className:"font-medium",children:((B=C.customer)==null?void 0:B.name_ar)||C.customer_name||" "})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:": "}),r.jsx("span",{className:"font-medium",children:(K=C.branch)==null?void 0:K.name_ar})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:": "}),r.jsx("span",{className:"font-bold",children:M(C.total_amount||0)})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:": "}),r.jsx("span",{className:"font-medium",children:M(C.paid_amount||0)})]}),(C.remaining_amount||0)>0&&r.jsxs("div",{className:"col-span-2",children:[r.jsx("span",{className:"text-muted-foreground",children:": "}),r.jsx("span",{className:"font-bold text-orange-600",children:M(C.remaining_amount||0)})]})]})]}),r.jsxs("div",{className:"flex gap-2 flex-wrap",children:[r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${C.has_tax?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:C.has_tax?"":""}),r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${C.payment_status==="paid"?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"}`,children:C.payment_status==="paid"?"":""}),r.jsxs("select",{value:C.is_lifted?"lifted":"not_lifted",onChange:ce=>ee(C.id,ce.target.value==="lifted"),className:`px-2 py-1 rounded-md text-xs border ${C.is_lifted?"bg-green-50 text-green-700 border-green-200":"bg-red-50 text-red-700 border-red-200"}`,children:[r.jsx("option",{value:"lifted",children:" "}),r.jsx("option",{value:"not_lifted",children:"  "})]})]})]})},C.id)})}),r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b",children:[r.jsx("th",{className:"text-right py-3 px-2",children:" "}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""})]})}),r.jsx("tbody",{children:P.map(C=>{var B,K;return r.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[r.jsx("td",{className:"py-3 px-2 font-mono text-sm",children:C.invoice_number}),r.jsx("td",{className:"py-3 px-2 text-sm",children:Ee(C.invoice_date||C.created_at)}),r.jsx("td",{className:"py-3 px-2 text-sm",children:((B=C.customer)==null?void 0:B.name_ar)||C.customer_name||" "}),r.jsx("td",{className:"py-3 px-2 text-sm",children:(K=C.branch)==null?void 0:K.name_ar}),r.jsx("td",{className:"py-3 px-2 text-sm",children:M(C.total_amount||0)}),r.jsx("td",{className:"py-3 px-2 text-sm",children:M(C.paid_amount||0)}),r.jsx("td",{className:"py-3 px-2 text-sm",children:(C.remaining_amount||0)>0?r.jsx("span",{className:"text-orange-600 font-semibold",children:M(C.remaining_amount||0)}):r.jsx("span",{className:"text-muted-foreground",children:"-"})}),r.jsx("td",{className:"py-3 px-2",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${C.has_tax?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:C.has_tax?"":""})}),r.jsx("td",{className:"py-3 px-2",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${C.payment_status==="paid"?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"}`,children:C.payment_status==="paid"?"":""})}),r.jsx("td",{className:"py-3 px-2",children:r.jsxs("select",{value:C.is_lifted?"lifted":"not_lifted",onChange:ce=>ee(C.id,ce.target.value==="lifted"),className:`px-2 py-1 rounded-md text-xs border ${C.is_lifted?"bg-green-50 text-green-700 border-green-200":"bg-red-50 text-red-700 border-red-200"}`,children:[r.jsx("option",{value:"lifted",children:" "}),r.jsx("option",{value:"not_lifted",children:"  "})]})}),r.jsx("td",{className:"py-3 px-2",children:r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(L,{variant:"ghost",size:"icon",onClick:()=>oe(C.id),title:" ",className:"h-8 w-8",children:r.jsx(Mt,{className:"h-4 w-4"})}),r.jsx(L,{variant:"ghost",size:"icon",onClick:()=>re(C.id),title:"",className:"h-8 w-8",children:r.jsx(Rr,{className:"h-4 w-4"})})]})})]},C.id)})})]})}),U>1&&r.jsxs("div",{className:"flex items-center justify-between gap-2 mt-4 pt-4 border-t",children:[r.jsx(L,{variant:"outline",size:"sm",onClick:()=>y(C=>Math.max(1,C-1)),disabled:p===1,className:"text-xs sm:text-sm",children:""}),r.jsx("div",{className:"flex items-center gap-1 sm:gap-2",children:Array.from({length:Math.min(5,U)},(C,B)=>{let K;return U<=5||p<=3?K=B+1:p>=U-2?K=U-4+B:K=p-2+B,r.jsx(L,{variant:p===K?"default":"outline",size:"sm",onClick:()=>y(K),className:"w-8 h-8 sm:w-10 sm:h-10 p-0 text-xs sm:text-sm",children:K},K)})}),r.jsx(L,{variant:"outline",size:"sm",onClick:()=>y(C=>Math.min(U,C+1)),disabled:p===U,className:"text-xs sm:text-sm",children:""})]})]}):r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:"  "})})]}),r.jsx(et,{open:a,onOpenChange:i,children:r.jsxs(tt,{className:"max-w-[95vw] sm:max-w-2xl max-h-[90vh] overflow-y-auto",onClose:()=>i(!1),children:[r.jsx(it,{children:r.jsxs(lt,{className:"text-base sm:text-lg",children:["  - ",s==null?void 0:s.invoice_number]})}),s&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 text-sm",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:":"})," ",Ee(s.invoice_date)]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:":"})," ",((me=s.customer)==null?void 0:me.name_ar)||s.customer_name||" "]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:":"})," ",(V=s.branch)==null?void 0:V.name_ar]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:":"})," ",((Y=s.cashier)==null?void 0:Y.full_name_ar)||((Z=s.cashier)==null?void 0:Z.full_name)]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:" :"})," ",r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.has_tax?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:s.has_tax?"":" "})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:" :"})," ",r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.payment_status==="paid"?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"}`,children:s.payment_status==="paid"?"":""})]})]}),r.jsx("div",{className:"border rounded-lg overflow-hidden overflow-x-auto",children:r.jsxs("table",{className:"w-full text-xs sm:text-sm min-w-[400px]",children:[r.jsx("thead",{className:"bg-muted",children:r.jsxs("tr",{children:[r.jsx("th",{className:"text-right py-2 px-2 sm:px-3",children:""}),r.jsx("th",{className:"text-right py-2 px-2 sm:px-3",children:""}),r.jsx("th",{className:"text-right py-2 px-2 sm:px-3",children:""}),r.jsx("th",{className:"text-right py-2 px-2 sm:px-3",children:""})]})}),r.jsx("tbody",{children:(O=s.items)==null?void 0:O.map(C=>{var B;return r.jsxs("tr",{className:"border-t",children:[r.jsx("td",{className:"py-2 px-2 sm:px-3",children:(B=C.product)==null?void 0:B.name_ar}),r.jsx("td",{className:"py-2 px-2 sm:px-3",children:C.quantity}),r.jsx("td",{className:"py-2 px-2 sm:px-3",children:M(C.unit_price)}),r.jsx("td",{className:"py-2 px-2 sm:px-3",children:M(C.total_price)})]},C.id)})})]})}),r.jsxs("div",{className:"border-t pt-4 space-y-2 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:" :"}),r.jsx("span",{children:M(s.subtotal||s.total_amount)})]}),s.discount_amount>0&&r.jsxs("div",{className:"flex justify-between text-red-600",children:[r.jsx("span",{children:":"}),r.jsxs("span",{children:["-",M(s.discount_amount)]})]}),r.jsxs("div",{className:"flex justify-between font-bold text-base sm:text-lg",children:[r.jsx("span",{children:":"}),r.jsx("span",{children:M(s.total_amount)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:":"}),r.jsx("span",{children:M(s.paid_amount)})]}),s.remaining_amount>0&&r.jsxs("div",{className:"flex justify-between text-orange-600",children:[r.jsx("span",{children:":"}),r.jsx("span",{children:M(s.remaining_amount)})]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 pt-4 border-t",children:[s.remaining_amount>0&&r.jsx(L,{variant:"outline",onClick:()=>o(!0),className:"bg-green-50 hover:bg-green-100 w-full sm:w-auto",children:" "}),r.jsx(L,{variant:"outline",onClick:()=>i(!1),className:"w-full sm:w-auto",children:""}),r.jsxs(L,{onClick:()=>re(s.id),className:"w-full sm:w-auto",children:[r.jsx(Rr,{className:"h-4 w-4 ml-2"}),""]})]})]})]})}),r.jsx(et,{open:l,onOpenChange:o,children:r.jsxs(tt,{className:"max-w-[95vw] sm:max-w-md max-h-[90vh] overflow-y-auto",children:[r.jsx(it,{children:r.jsx(lt,{className:"text-base sm:text-lg",children:" "})}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:" "}),r.jsx("p",{className:"text-xl sm:text-2xl font-bold text-destructive",children:M((s==null?void 0:s.remaining_amount)||0)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium mb-2 block",children:" "}),r.jsx(G,{type:"number",value:c,onChange:C=>u(C.target.value),placeholder:" ",autoFocus:!0})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-end",children:[r.jsx(L,{variant:"outline",onClick:()=>{o(!1),u("")},className:"w-full sm:w-auto",children:""}),r.jsx(L,{onClick:ue,disabled:!c||parseFloat(c)<=0,className:"w-full sm:w-auto",children:" "})]})]})]})})]});async function ue(){if(!s)return;const C=parseFloat(c);if(!C||C<=0){alert("   ");return}const B=s.remaining_amount||0;if(C>B){alert("     ");return}try{const K=(s.paid_amount||0)+C,ce=(s.total_amount||0)-K,Q=ce<=0?"paid":"credit",{error:ge}=await I.from("sales").update({paid_amount:K,remaining_amount:ce,payment_status:Q}).eq("id",s.id);if(ge)throw ge;alert("   "),o(!1),u(""),await oe(s.id),N.invalidateQueries({queryKey:["sales"]})}catch(K){console.error("Error adding payment:",K),alert("    ")}}}function H1(){const[e,t]=S.useState(""),[s,n]=S.useState(""),[a,i]=S.useState(1),l=10,o=Ea(),{data:c}=se({queryKey:["branches"],queryFn:async()=>{const{data:g}=await I.from("branches").select("id, name_ar").eq("status","active");return g||[]}}),{data:u,isLoading:d}=se({queryKey:["inventory",e,s,a],queryFn:async()=>{let g=I.from("inventory").select("*, product:products!inner(code, name, name_ar)",{count:"exact",head:!0});s&&(g=g.eq("branch_id",s)),e&&(g=g.or(`code.ilike.%${e}%,name.ilike.%${e}%,name_ar.ilike.%${e}%`,{foreignTable:"products"}));const{count:w}=await g;let _=I.from("inventory").select("*, product:products!inner(code, name, name_ar, min_stock_level), branch:branches(name_ar)");s&&(_=_.eq("branch_id",s)),e&&(_=_.or(`code.ilike.%${e}%,name.ilike.%${e}%,name_ar.ilike.%${e}%`,{foreignTable:"products"}));const x=(a-1)*l,p=x+l-1,{data:y}=await _.order("quantity",{ascending:!0}).range(x,p);return{inventory:y||[],totalCount:w||0,totalPages:Math.ceil((w||0)/l)}}}),m=(u==null?void 0:u.inventory)||[],f=(u==null?void 0:u.totalPages)||1,v=(u==null?void 0:u.totalCount)||0;return is.useEffect(()=>{i(1)},[e,s]),r.jsxs("div",{className:"p-3 md:p-6 space-y-4 md:space-y-6",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl md:text-2xl font-bold",children:""}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"  "})]}),r.jsxs(L,{variant:"outline",onClick:()=>o("/transfers"),className:"w-full sm:w-auto",children:[r.jsx(io,{className:"h-4 w-4 ml-2"}),r.jsx("span",{className:"hidden sm:inline",children:" "}),r.jsx("span",{className:"sm:hidden",children:""})]})]}),r.jsxs(le,{children:[r.jsx(Se,{children:r.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3 sm:gap-4",children:[r.jsxs("div",{className:"relative flex-1",children:[r.jsx(Os,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),r.jsx(G,{placeholder:"   ...",value:e,onChange:g=>t(g.target.value),className:"pr-10"})]}),r.jsxs("select",{id:"branch-filter",title:"  ",value:s,onChange:g=>n(g.target.value),className:"h-10 px-3 rounded-md border border-input bg-background text-sm",children:[r.jsx("option",{value:"",children:" "}),c==null?void 0:c.map(g=>r.jsx("option",{value:g.id,children:g.name_ar},g.id))]})]})}),r.jsx(Ce,{children:d?r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:" ..."}):m!=null&&m.length?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"mb-4 text-xs sm:text-sm text-muted-foreground",children:[" ",(a-1)*l+1," - ",Math.min(a*l,v),"  ",v," "]}),r.jsx("div",{className:"block md:hidden space-y-3",children:m.map(g=>{var _,x,p,y,j;const w=(g.quantity||0)<(((_=g.product)==null?void 0:_.min_stock_level)||10);return r.jsx(le,{className:"p-3",children:r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:"font-bold text-sm",children:(x=g.product)==null?void 0:x.name_ar}),r.jsx("p",{className:"text-xs text-muted-foreground font-mono",children:(p=g.product)==null?void 0:p.code})]}),r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${w?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:w?"":""})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:": "}),r.jsx("span",{className:"font-medium",children:(y=g.branch)==null?void 0:y.name_ar})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:": "}),r.jsx("span",{className:"font-bold",children:g.quantity})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:" : "}),r.jsx("span",{children:((j=g.product)==null?void 0:j.min_stock_level)||10})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:": "}),r.jsx("span",{children:M(g.avg_cost||0)})]}),r.jsxs("div",{className:"col-span-2",children:[r.jsx("span",{className:"text-muted-foreground",children:": "}),r.jsx("span",{className:"font-bold",children:M((g.quantity||0)*(g.avg_cost||0))})]})]})]})},g.id)})}),r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b",children:[r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:" "}),r.jsx("th",{className:"text-right py-3 px-2",children:" "}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""})]})}),r.jsx("tbody",{children:m.map(g=>{var _,x,p,y,j;const w=(g.quantity||0)<(((_=g.product)==null?void 0:_.min_stock_level)||10);return r.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[r.jsx("td",{className:"py-3 px-2 font-mono text-sm",children:(x=g.product)==null?void 0:x.code}),r.jsx("td",{className:"py-3 px-2",children:(p=g.product)==null?void 0:p.name_ar}),r.jsx("td",{className:"py-3 px-2",children:(y=g.branch)==null?void 0:y.name_ar}),r.jsx("td",{className:"py-3 px-2 font-medium",children:g.quantity}),r.jsx("td",{className:"py-3 px-2",children:((j=g.product)==null?void 0:j.min_stock_level)||10}),r.jsx("td",{className:"py-3 px-2",children:M(g.avg_cost||0)}),r.jsx("td",{className:"py-3 px-2",children:M((g.quantity||0)*(g.avg_cost||0))}),r.jsx("td",{className:"py-3 px-2",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${w?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:w?"":""})})]},g.id)})})]})}),f>1&&r.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t gap-2",children:[r.jsx(L,{variant:"outline",size:"sm",onClick:()=>i(g=>Math.max(1,g-1)),disabled:a===1,className:"text-xs sm:text-sm",children:""}),r.jsx("div",{className:"flex items-center gap-1 sm:gap-2",children:Array.from({length:Math.min(5,f)},(g,w)=>{let _=f<=5||a<=3?w+1:a>=f-2?f-4+w:a-2+w;return r.jsx(L,{variant:a===_?"default":"outline",size:"sm",onClick:()=>i(_),className:"w-8 h-8 sm:w-10 sm:h-10 p-0 text-xs sm:text-sm",children:_},_)})}),r.jsx(L,{variant:"outline",size:"sm",onClick:()=>i(g=>Math.min(f,g+1)),disabled:a===f,className:"text-xs sm:text-sm",children:""})]})]}):r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:"  "})})]})]})}var Hg={exports:{}};(function(e,t){(function(s,n){e.exports=n(S,Kx)})(typeof self<"u"?self:ey,function(s,n){return function(){var a={328:function(c,u,d){Object.defineProperty(u,"__esModule",{value:!0}),u.PrintContextConsumer=u.PrintContext=void 0;var m=d(496),f=Object.prototype.hasOwnProperty.call(m,"createContext");u.PrintContext=f?m.createContext({}):null,u.PrintContextConsumer=u.PrintContext?u.PrintContext.Consumer:function(){return null}},428:function(c,u,d){Object.defineProperty(u,"__esModule",{value:!0}),u.ReactToPrint=void 0;var m=d(316),f=d(496),v=d(190),g=d(328),w=d(940),_=function(x){function p(){var y=x.apply(this,m.__spreadArray([],m.__read(arguments),!1))||this;return y.startPrint=function(j){var b=y.props,N=b.onAfterPrint,T=b.onPrintError,h=b.print,R=b.documentTitle;setTimeout(function(){var P,U;if(j.contentWindow)if(j.contentWindow.focus(),h)h(j).then(function(){return N==null?void 0:N()}).then(function(){return y.handleRemoveIframe()}).catch(function(oe){T?T("print",oe):y.logMessages(["An error was thrown by the specified `print` function"])});else{if(j.contentWindow.print){var W=(U=(P=j.contentDocument)===null||P===void 0?void 0:P.title)!==null&&U!==void 0?U:"",ee=j.ownerDocument.title;R&&(j.ownerDocument.title=R,j.contentDocument&&(j.contentDocument.title=R)),j.contentWindow.print(),R&&(j.ownerDocument.title=ee,j.contentDocument&&(j.contentDocument.title=W))}else y.logMessages(["Printing for this browser is not currently possible: the browser does not have a `print` method available for iframes."]);N==null||N(),y.handleRemoveIframe()}else y.logMessages(["Printing failed because the `contentWindow` of the print iframe did not load. This is possibly an error with `react-to-print`. Please file an issue: https://github.com/gregnb/react-to-print/issues/"])},500)},y.triggerPrint=function(j){var b=y.props,N=b.onBeforePrint,T=b.onPrintError;if(N){var h=N();h&&typeof h.then=="function"?h.then(function(){y.startPrint(j)}).catch(function(R){T&&T("onBeforePrint",R)}):y.startPrint(j)}else y.startPrint(j)},y.handlePrint=function(j){var b=y.props,N=b.bodyClass,T=b.content,h=b.copyStyles,R=b.fonts,P=b.pageStyle,U=b.nonce,W=typeof j=="function"?j():null;if(W&&typeof T=="function"&&y.logMessages(['"react-to-print" received a `content` prop and a content param passed the callback return by `useReactToPrint. The `content` prop will be ignored.'],"warning"),W||typeof T!="function"||(W=T()),W!==void 0)if(W!==null){var ee=document.createElement("iframe");ee.width="".concat(document.documentElement.clientWidth,"px"),ee.height="".concat(document.documentElement.clientHeight,"px"),ee.style.position="absolute",ee.style.top="-".concat(document.documentElement.clientHeight+100,"px"),ee.style.left="-".concat(document.documentElement.clientWidth+100,"px"),ee.id="printWindow",ee.srcdoc="<!DOCTYPE html>";var oe=(0,v.findDOMNode)(W);if(oe){var re=oe.cloneNode(!0),ue=re instanceof Text,me=document.querySelectorAll("link[rel~='stylesheet'], link[as='style']"),V=ue?[]:re.querySelectorAll("img"),Y=ue?[]:re.querySelectorAll("video"),Z=R?R.length:0;y.numResourcesToLoad=me.length+V.length+Y.length+Z,y.resourcesLoaded=[],y.resourcesErrored=[];var O=function(C,B){y.resourcesLoaded.includes(C)?y.logMessages(["Tried to mark a resource that has already been handled",C],"debug"):(B?(y.logMessages(m.__spreadArray(['"react-to-print" was unable to load a resource but will continue attempting to print the page'],m.__read(B),!1)),y.resourcesErrored.push(C)):y.resourcesLoaded.push(C),y.resourcesLoaded.length+y.resourcesErrored.length===y.numResourcesToLoad&&y.triggerPrint(ee))};ee.onload=function(){var C,B,K,ce;ee.onload=null;var Q=ee.contentDocument||((B=ee.contentWindow)===null||B===void 0?void 0:B.document);if(Q){Q.body.appendChild(re),R&&(!((K=ee.contentDocument)===null||K===void 0)&&K.fonts&&(!((ce=ee.contentWindow)===null||ce===void 0)&&ce.FontFace)?R.forEach(function(yt){var ke=new FontFace(yt.family,yt.source,{weight:yt.weight,style:yt.style});ee.contentDocument.fonts.add(ke),ke.loaded.then(function(){O(ke)}).catch(function(be){O(ke,["Failed loading the font:",ke,"Load error:",be])})}):(R.forEach(function(yt){return O(yt)}),y.logMessages(['"react-to-print" is not able to load custom fonts because the browser does not support the FontFace API but will continue attempting to print the page'])));var ge=typeof P=="function"?P():P;if(typeof ge!="string")y.logMessages(['"react-to-print" expected a "string" from `pageStyle` but received "'.concat(typeof ge,'". Styles from `pageStyle` will not be applied.')]);else{var Me=Q.createElement("style");U&&(Me.setAttribute("nonce",U),Q.head.setAttribute("nonce",U)),Me.appendChild(Q.createTextNode(ge)),Q.head.appendChild(Me)}if(N&&(C=Q.body.classList).add.apply(C,m.__spreadArray([],m.__read(N.split(" ")),!1)),!ue){for(var A=ue?[]:oe.querySelectorAll("canvas"),D=Q.querySelectorAll("canvas"),q=0;q<A.length;++q){var k=A[q],$=D[q].getContext("2d");$&&$.drawImage(k,0,0)}var z=function(yt){var ke=V[yt],be=ke.getAttribute("src");if(be){var vt=new Image;vt.onload=function(){return O(ke)},vt.onerror=function(Dr,Ra,Hi,ls,Ot){return O(ke,["Error loading <img>",ke,"Error",Ot])},vt.src=be}else O(ke,['Found an <img> tag with an empty "src" attribute. This prevents pre-loading it. The <img> is:',ke])};for(q=0;q<V.length;q++)z(q);var J=function(yt){var ke=Y[yt];ke.preload="auto";var be=ke.getAttribute("poster");if(be){var vt=new Image;vt.onload=function(){return O(ke)},vt.onerror=function(Dr,Ra,Hi,ls,Ot){return O(ke,["Error loading video poster",be,"for video",ke,"Error:",Ot])},vt.src=be}else ke.readyState>=2?O(ke):(ke.onloadeddata=function(){return O(ke)},ke.onerror=function(Dr,Ra,Hi,ls,Ot){return O(ke,["Error loading video",ke,"Error",Ot])},ke.onstalled=function(){return O(ke,["Loading video stalled, skipping",ke])})};for(q=0;q<Y.length;q++)J(q);var xe="input",Re=oe.querySelectorAll(xe),De=Q.querySelectorAll(xe);for(q=0;q<Re.length;q++)De[q].value=Re[q].value;var ae="input[type=checkbox],input[type=radio]",F=oe.querySelectorAll(ae),we=Q.querySelectorAll(ae);for(q=0;q<F.length;q++)we[q].checked=F[q].checked;var pe="select",Ke=oe.querySelectorAll(pe),ws=Q.querySelectorAll(pe);for(q=0;q<Ke.length;q++)ws[q].value=Ke[q].value}if(h)for(var zt=document.querySelectorAll("style, link[rel~='stylesheet'], link[as='style']"),_s=function(yt,ke){var be=zt[yt];if(be.tagName.toLowerCase()==="style"){var vt=Q.createElement(be.tagName),Dr=be.sheet;if(Dr){var Ra="";try{for(var Hi=Dr.cssRules.length,ls=0;ls<Hi;++ls)typeof Dr.cssRules[ls].cssText=="string"&&(Ra+="".concat(Dr.cssRules[ls].cssText,`\r
`))}catch{y.logMessages(["A stylesheet could not be accessed. This is likely due to the stylesheet having cross-origin imports, and many browsers block script access to cross-origin stylesheets. See https://github.com/gregnb/react-to-print/issues/429 for details. You may be able to load the sheet by both marking the stylesheet with the cross `crossorigin` attribute, and setting the `Access-Control-Allow-Origin` header on the server serving the stylesheet. Alternatively, host the stylesheet on your domain to avoid this issue entirely.",be],"warning")}vt.setAttribute("id","react-to-print-".concat(yt)),U&&vt.setAttribute("nonce",U),vt.appendChild(Q.createTextNode(Ra)),Q.head.appendChild(vt)}}else if(be.getAttribute("href"))if(be.hasAttribute("disabled"))y.logMessages(["`react-to-print` encountered a <link> tag with a `disabled` attribute and will ignore it. Note that the `disabled` attribute is deprecated, and some browsers ignore it. You should stop using it. https://developer.mozilla.org/en-US/docs/Web/HTML/Element/link#attr-disabled. The <link> is:",be],"warning"),O(be);else{for(var Ot=Q.createElement(be.tagName),Jg=(ls=0,be.attributes.length);ls<Jg;++ls){var Fo=be.attributes[ls];Fo&&Ot.setAttribute(Fo.nodeName,Fo.nodeValue||"")}Ot.onload=function(){return O(Ot)},Ot.onerror=function(Yg,E2,P2,T2,Xg){return O(Ot,["Failed to load",Ot,"Error:",Xg])},U&&Ot.setAttribute("nonce",U),Q.head.appendChild(Ot)}else y.logMessages(["`react-to-print` encountered a <link> tag with an empty `href` attribute. In addition to being invalid HTML, this can cause problems in many browsers, and so the <link> was not loaded. The <link> is:",be],"warning"),O(be)},Do=(q=0,zt.length);q<Do;++q)_s(q)}y.numResourcesToLoad!==0&&h||y.triggerPrint(ee)},y.handleRemoveIframe(!0),document.body.appendChild(ee)}else y.logMessages(['"react-to-print" could not locate the DOM node corresponding with the `content` prop'])}else y.logMessages(['There is nothing to print because the "content" prop returned "null". Please ensure "content" is renderable before allowing "react-to-print" to be called.']);else y.logMessages(["To print a functional component ensure it is wrapped with `React.forwardRef`, and ensure the forwarded ref is used. See the README for an example: https://github.com/gregnb/react-to-print#examples"])},y.handleRemoveIframe=function(j){var b=y.props.removeAfterPrint;if(j||b){var N=document.getElementById("printWindow");N&&document.body.removeChild(N)}},y.logMessages=function(j,b){b===void 0&&(b="error"),y.props.suppressErrors||(b==="error"?console.error(j):b==="warning"?console.warn(j):b==="debug"&&console.debug(j))},y}return m.__extends(p,x),p.prototype.handleClick=function(y,j){var b=this,N=this.props,T=N.onBeforeGetContent,h=N.onPrintError;if(T){var R=T();R&&typeof R.then=="function"?R.then(function(){return b.handlePrint(j)}).catch(function(P){h&&h("onBeforeGetContent",P)}):this.handlePrint(j)}else this.handlePrint(j)},p.prototype.render=function(){var y=this.props,j=y.children,b=y.trigger;if(b)return f.cloneElement(b(),{onClick:this.handleClick.bind(this)});if(!g.PrintContext)return this.logMessages(['"react-to-print" requires React ^16.3.0 to be able to use "PrintContext"']),null;var N={handlePrint:this.handleClick.bind(this)};return f.createElement(g.PrintContext.Provider,{value:N},j)},p.defaultProps=w.defaultProps,p}(f.Component);u.ReactToPrint=_},940:function(c,u){Object.defineProperty(u,"__esModule",{value:!0}),u.defaultProps=void 0,u.defaultProps={copyStyles:!0,pageStyle:`
        @page {
            /* Remove browser default header (title) and footer (url) */
            margin: 0;
        }
        @media print {
            body {
                /* Tell browsers to print background colors */
                -webkit-print-color-adjust: exact; /* Chrome/Safari/Edge/Opera */
                color-adjust: exact; /* Firefox */
            }
        }
    `,removeAfterPrint:!1,suppressErrors:!1}},892:function(c,u,d){Object.defineProperty(u,"__esModule",{value:!0}),u.useReactToPrint=void 0;var m=d(316),f=d(496),v=d(428),g=d(940),w=d(860),_=Object.prototype.hasOwnProperty.call(f,"useMemo")&&Object.prototype.hasOwnProperty.call(f,"useCallback");u.useReactToPrint=function(x){if(!_)return x.suppressErrors||console.error('"react-to-print" requires React ^16.8.0 to be able to use "useReactToPrint"'),function(){throw new Error('"react-to-print" requires React ^16.8.0 to be able to use "useReactToPrint"')};var p=f.useMemo(function(){return new v.ReactToPrint(m.__assign(m.__assign({},g.defaultProps),x))},[x]);return f.useCallback(function(y,j){return(0,w.wrapCallbackWithArgs)(p,p.handleClick,j)(y)},[p])}},860:function(c,u,d){Object.defineProperty(u,"__esModule",{value:!0}),u.wrapCallbackWithArgs=void 0;var m=d(316);u.wrapCallbackWithArgs=function(f,v){for(var g=[],w=2;w<arguments.length;w++)g[w-2]=arguments[w];return function(){for(var _=[],x=0;x<arguments.length;x++)_[x]=arguments[x];return v.apply(f,m.__spreadArray(m.__spreadArray([],m.__read(_),!1),m.__read(g),!1))}}},496:function(c){c.exports=s},190:function(c){c.exports=n},316:function(c,u,d){d.r(u),d.d(u,{__addDisposableResource:function(){return Q},__assign:function(){return v},__asyncDelegator:function(){return me},__asyncGenerator:function(){return ue},__asyncValues:function(){return V},__await:function(){return re},__awaiter:function(){return N},__classPrivateFieldGet:function(){return B},__classPrivateFieldIn:function(){return ce},__classPrivateFieldSet:function(){return K},__createBinding:function(){return h},__decorate:function(){return w},__disposeResources:function(){return Me},__esDecorate:function(){return x},__exportStar:function(){return R},__extends:function(){return f},__generator:function(){return T},__importDefault:function(){return C},__importStar:function(){return O},__makeTemplateObject:function(){return Y},__metadata:function(){return b},__param:function(){return _},__propKey:function(){return y},__read:function(){return U},__rest:function(){return g},__runInitializers:function(){return p},__setFunctionName:function(){return j},__spread:function(){return W},__spreadArray:function(){return oe},__spreadArrays:function(){return ee},__values:function(){return P}});var m=function(A,D){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(q,k){q.__proto__=k}||function(q,k){for(var $ in k)Object.prototype.hasOwnProperty.call(k,$)&&(q[$]=k[$])},m(A,D)};function f(A,D){if(typeof D!="function"&&D!==null)throw new TypeError("Class extends value "+String(D)+" is not a constructor or null");function q(){this.constructor=A}m(A,D),A.prototype=D===null?Object.create(D):(q.prototype=D.prototype,new q)}var v=function(){return v=Object.assign||function(A){for(var D,q=1,k=arguments.length;q<k;q++)for(var $ in D=arguments[q])Object.prototype.hasOwnProperty.call(D,$)&&(A[$]=D[$]);return A},v.apply(this,arguments)};function g(A,D){var q={};for(var k in A)Object.prototype.hasOwnProperty.call(A,k)&&D.indexOf(k)<0&&(q[k]=A[k]);if(A!=null&&typeof Object.getOwnPropertySymbols=="function"){var $=0;for(k=Object.getOwnPropertySymbols(A);$<k.length;$++)D.indexOf(k[$])<0&&Object.prototype.propertyIsEnumerable.call(A,k[$])&&(q[k[$]]=A[k[$]])}return q}function w(A,D,q,k){var $,z=arguments.length,J=z<3?D:k===null?k=Object.getOwnPropertyDescriptor(D,q):k;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")J=Reflect.decorate(A,D,q,k);else for(var xe=A.length-1;xe>=0;xe--)($=A[xe])&&(J=(z<3?$(J):z>3?$(D,q,J):$(D,q))||J);return z>3&&J&&Object.defineProperty(D,q,J),J}function _(A,D){return function(q,k){D(q,k,A)}}function x(A,D,q,k,$,z){function J(_s){if(_s!==void 0&&typeof _s!="function")throw new TypeError("Function expected");return _s}for(var xe,Re=k.kind,De=Re==="getter"?"get":Re==="setter"?"set":"value",ae=!D&&A?k.static?A:A.prototype:null,F=D||(ae?Object.getOwnPropertyDescriptor(ae,k.name):{}),we=!1,pe=q.length-1;pe>=0;pe--){var Ke={};for(var ws in k)Ke[ws]=ws==="access"?{}:k[ws];for(var ws in k.access)Ke.access[ws]=k.access[ws];Ke.addInitializer=function(_s){if(we)throw new TypeError("Cannot add initializers after decoration has completed");z.push(J(_s||null))};var zt=(0,q[pe])(Re==="accessor"?{get:F.get,set:F.set}:F[De],Ke);if(Re==="accessor"){if(zt===void 0)continue;if(zt===null||typeof zt!="object")throw new TypeError("Object expected");(xe=J(zt.get))&&(F.get=xe),(xe=J(zt.set))&&(F.set=xe),(xe=J(zt.init))&&$.unshift(xe)}else(xe=J(zt))&&(Re==="field"?$.unshift(xe):F[De]=xe)}ae&&Object.defineProperty(ae,k.name,F),we=!0}function p(A,D,q){for(var k=arguments.length>2,$=0;$<D.length;$++)q=k?D[$].call(A,q):D[$].call(A);return k?q:void 0}function y(A){return typeof A=="symbol"?A:"".concat(A)}function j(A,D,q){return typeof D=="symbol"&&(D=D.description?"[".concat(D.description,"]"):""),Object.defineProperty(A,"name",{configurable:!0,value:q?"".concat(q," ",D):D})}function b(A,D){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(A,D)}function N(A,D,q,k){return new(q||(q=Promise))(function($,z){function J(De){try{Re(k.next(De))}catch(ae){z(ae)}}function xe(De){try{Re(k.throw(De))}catch(ae){z(ae)}}function Re(De){var ae;De.done?$(De.value):(ae=De.value,ae instanceof q?ae:new q(function(F){F(ae)})).then(J,xe)}Re((k=k.apply(A,D||[])).next())})}function T(A,D){var q,k,$,z,J={label:0,sent:function(){if(1&$[0])throw $[1];return $[1]},trys:[],ops:[]};return z={next:xe(0),throw:xe(1),return:xe(2)},typeof Symbol=="function"&&(z[Symbol.iterator]=function(){return this}),z;function xe(Re){return function(De){return function(ae){if(q)throw new TypeError("Generator is already executing.");for(;z&&(z=0,ae[0]&&(J=0)),J;)try{if(q=1,k&&($=2&ae[0]?k.return:ae[0]?k.throw||(($=k.return)&&$.call(k),0):k.next)&&!($=$.call(k,ae[1])).done)return $;switch(k=0,$&&(ae=[2&ae[0],$.value]),ae[0]){case 0:case 1:$=ae;break;case 4:return J.label++,{value:ae[1],done:!1};case 5:J.label++,k=ae[1],ae=[0];continue;case 7:ae=J.ops.pop(),J.trys.pop();continue;default:if(!(($=($=J.trys).length>0&&$[$.length-1])||ae[0]!==6&&ae[0]!==2)){J=0;continue}if(ae[0]===3&&(!$||ae[1]>$[0]&&ae[1]<$[3])){J.label=ae[1];break}if(ae[0]===6&&J.label<$[1]){J.label=$[1],$=ae;break}if($&&J.label<$[2]){J.label=$[2],J.ops.push(ae);break}$[2]&&J.ops.pop(),J.trys.pop();continue}ae=D.call(A,J)}catch(F){ae=[6,F],k=0}finally{q=$=0}if(5&ae[0])throw ae[1];return{value:ae[0]?ae[1]:void 0,done:!0}}([Re,De])}}}var h=Object.create?function(A,D,q,k){k===void 0&&(k=q);var $=Object.getOwnPropertyDescriptor(D,q);$&&!("get"in $?!D.__esModule:$.writable||$.configurable)||($={enumerable:!0,get:function(){return D[q]}}),Object.defineProperty(A,k,$)}:function(A,D,q,k){k===void 0&&(k=q),A[k]=D[q]};function R(A,D){for(var q in A)q==="default"||Object.prototype.hasOwnProperty.call(D,q)||h(D,A,q)}function P(A){var D=typeof Symbol=="function"&&Symbol.iterator,q=D&&A[D],k=0;if(q)return q.call(A);if(A&&typeof A.length=="number")return{next:function(){return A&&k>=A.length&&(A=void 0),{value:A&&A[k++],done:!A}}};throw new TypeError(D?"Object is not iterable.":"Symbol.iterator is not defined.")}function U(A,D){var q=typeof Symbol=="function"&&A[Symbol.iterator];if(!q)return A;var k,$,z=q.call(A),J=[];try{for(;(D===void 0||D-- >0)&&!(k=z.next()).done;)J.push(k.value)}catch(xe){$={error:xe}}finally{try{k&&!k.done&&(q=z.return)&&q.call(z)}finally{if($)throw $.error}}return J}function W(){for(var A=[],D=0;D<arguments.length;D++)A=A.concat(U(arguments[D]));return A}function ee(){for(var A=0,D=0,q=arguments.length;D<q;D++)A+=arguments[D].length;var k=Array(A),$=0;for(D=0;D<q;D++)for(var z=arguments[D],J=0,xe=z.length;J<xe;J++,$++)k[$]=z[J];return k}function oe(A,D,q){if(q||arguments.length===2)for(var k,$=0,z=D.length;$<z;$++)!k&&$ in D||(k||(k=Array.prototype.slice.call(D,0,$)),k[$]=D[$]);return A.concat(k||Array.prototype.slice.call(D))}function re(A){return this instanceof re?(this.v=A,this):new re(A)}function ue(A,D,q){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var k,$=q.apply(A,D||[]),z=[];return k={},J("next"),J("throw"),J("return"),k[Symbol.asyncIterator]=function(){return this},k;function J(F){$[F]&&(k[F]=function(we){return new Promise(function(pe,Ke){z.push([F,we,pe,Ke])>1||xe(F,we)})})}function xe(F,we){try{(pe=$[F](we)).value instanceof re?Promise.resolve(pe.value.v).then(Re,De):ae(z[0][2],pe)}catch(Ke){ae(z[0][3],Ke)}var pe}function Re(F){xe("next",F)}function De(F){xe("throw",F)}function ae(F,we){F(we),z.shift(),z.length&&xe(z[0][0],z[0][1])}}function me(A){var D,q;return D={},k("next"),k("throw",function($){throw $}),k("return"),D[Symbol.iterator]=function(){return this},D;function k($,z){D[$]=A[$]?function(J){return(q=!q)?{value:re(A[$](J)),done:!1}:z?z(J):J}:z}}function V(A){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var D,q=A[Symbol.asyncIterator];return q?q.call(A):(A=P(A),D={},k("next"),k("throw"),k("return"),D[Symbol.asyncIterator]=function(){return this},D);function k($){D[$]=A[$]&&function(z){return new Promise(function(J,xe){(function(Re,De,ae,F){Promise.resolve(F).then(function(we){Re({value:we,done:ae})},De)})(J,xe,(z=A[$](z)).done,z.value)})}}}function Y(A,D){return Object.defineProperty?Object.defineProperty(A,"raw",{value:D}):A.raw=D,A}var Z=Object.create?function(A,D){Object.defineProperty(A,"default",{enumerable:!0,value:D})}:function(A,D){A.default=D};function O(A){if(A&&A.__esModule)return A;var D={};if(A!=null)for(var q in A)q!=="default"&&Object.prototype.hasOwnProperty.call(A,q)&&h(D,A,q);return Z(D,A),D}function C(A){return A&&A.__esModule?A:{default:A}}function B(A,D,q,k){if(q==="a"&&!k)throw new TypeError("Private accessor was defined without a getter");if(typeof D=="function"?A!==D||!k:!D.has(A))throw new TypeError("Cannot read private member from an object whose class did not declare it");return q==="m"?k:q==="a"?k.call(A):k?k.value:D.get(A)}function K(A,D,q,k,$){if(k==="m")throw new TypeError("Private method is not writable");if(k==="a"&&!$)throw new TypeError("Private accessor was defined without a setter");if(typeof D=="function"?A!==D||!$:!D.has(A))throw new TypeError("Cannot write private member to an object whose class did not declare it");return k==="a"?$.call(A,q):$?$.value=q:D.set(A,q),q}function ce(A,D){if(D===null||typeof D!="object"&&typeof D!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof A=="function"?D===A:A.has(D)}function Q(A,D,q){if(D!=null){if(typeof D!="object"&&typeof D!="function")throw new TypeError("Object expected.");var k;if(q){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");k=D[Symbol.asyncDispose]}if(k===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");k=D[Symbol.dispose]}if(typeof k!="function")throw new TypeError("Object not disposable.");A.stack.push({value:D,dispose:k,async:q})}else q&&A.stack.push({async:!0});return D}var ge=typeof SuppressedError=="function"?SuppressedError:function(A,D,q){var k=new Error(q);return k.name="SuppressedError",k.error=A,k.suppressed=D,k};function Me(A){function D(q){A.error=A.hasError?new ge(q,A.error,"An error was suppressed during disposal."):q,A.hasError=!0}return function q(){for(;A.stack.length;){var k=A.stack.pop();try{var $=k.dispose&&k.dispose.call(k.value);if(k.async)return Promise.resolve($).then(q,function(z){return D(z),q()})}catch(z){D(z)}}if(A.hasError)throw A.error}()}u.default={__extends:f,__assign:v,__rest:g,__decorate:w,__param:_,__metadata:b,__awaiter:N,__generator:T,__createBinding:h,__exportStar:R,__values:P,__read:U,__spread:W,__spreadArrays:ee,__spreadArray:oe,__await:re,__asyncGenerator:ue,__asyncDelegator:me,__asyncValues:V,__makeTemplateObject:Y,__importStar:O,__importDefault:C,__classPrivateFieldGet:B,__classPrivateFieldSet:K,__classPrivateFieldIn:ce,__addDisposableResource:Q,__disposeResources:Me}}},i={};function l(c){var u=i[c];if(u!==void 0)return u.exports;var d=i[c]={exports:{}};return a[c](d,d.exports,l),d.exports}l.d=function(c,u){for(var d in u)l.o(u,d)&&!l.o(c,d)&&Object.defineProperty(c,d,{enumerable:!0,get:u[d]})},l.o=function(c,u){return Object.prototype.hasOwnProperty.call(c,u)},l.r=function(c){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})};var o={};return function(){var c=o;Object.defineProperty(c,"__esModule",{value:!0}),c.useReactToPrint=c.ReactToPrint=c.PrintContextConsumer=void 0;var u=l(328);Object.defineProperty(c,"PrintContextConsumer",{enumerable:!0,get:function(){return u.PrintContextConsumer}});var d=l(428);Object.defineProperty(c,"ReactToPrint",{enumerable:!0,get:function(){return d.ReactToPrint}});var m=l(892);Object.defineProperty(c,"useReactToPrint",{enumerable:!0,get:function(){return m.useReactToPrint}});var f=l(428);c.default=f.ReactToPrint}(),o}()})})(Hg);var Qg=Hg.exports;const Gg=S.forwardRef(({purchase:e,items:t,supplier:s,branch:n},a)=>r.jsxs("div",{ref:a,className:"p-8 bg-white text-black",dir:"rtl",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6 border-b-2 pb-4",children:[r.jsx("div",{children:r.jsx("img",{src:"/el-fagr/logo.jpg",alt:" ",className:"w-24 h-24 object-contain"})}),r.jsxs("div",{className:"text-center",children:[r.jsx("h1",{className:"text-3xl font-bold text-primary",children:" "}),r.jsx("p",{className:"text-lg",children:" "}),r.jsx("p",{className:"text-sm",children:"73     "}),r.jsx("p",{className:"text-sm",children:": 02-24156242 / 02-24142417"})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("h2",{className:"text-2xl font-bold",children:" "}),r.jsx("p",{className:"text-sm",children:"Purchase Invoice"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[r.jsxs("div",{children:[r.jsxs("p",{children:[r.jsx("strong",{children:" :"})," ",e.invoice_number]}),r.jsxs("p",{children:[r.jsx("strong",{children:":"})," ",Ee(e.invoice_date)]}),r.jsxs("p",{children:[r.jsx("strong",{children:":"})," ",n==null?void 0:n.name_ar]})]}),r.jsxs("div",{className:"text-right",children:[r.jsxs("p",{children:[r.jsx("strong",{children:":"})," ",(s==null?void 0:s.name_ar)||(s==null?void 0:s.name)]}),r.jsxs("p",{children:[r.jsx("strong",{children:":"})," ",s==null?void 0:s.phone]}),(s==null?void 0:s.address)&&r.jsxs("p",{children:[r.jsx("strong",{children:":"})," ",s.address]})]})]}),r.jsxs("table",{className:"w-full border-collapse mb-6",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-gray-200",children:[r.jsx("th",{className:"border p-2 text-right",children:"#"}),r.jsx("th",{className:"border p-2 text-right",children:""}),r.jsx("th",{className:"border p-2 text-center",children:""}),r.jsx("th",{className:"border p-2 text-right",children:" "}),r.jsx("th",{className:"border p-2 text-right",children:""})]})}),r.jsx("tbody",{children:t.map((i,l)=>{var o,c;return r.jsxs("tr",{children:[r.jsx("td",{className:"border p-2",children:l+1}),r.jsx("td",{className:"border p-2",children:((o=i.product)==null?void 0:o.name_ar)||((c=i.product)==null?void 0:c.name)}),r.jsx("td",{className:"border p-2 text-center",children:i.quantity}),r.jsx("td",{className:"border p-2",children:M(i.unit_price)}),r.jsx("td",{className:"border p-2",children:M(i.total_price)})]},i.id)})})]}),r.jsx("div",{className:"flex justify-end mb-6",children:r.jsxs("div",{className:"w-64",children:[r.jsxs("div",{className:"flex justify-between py-2 border-b",children:[r.jsx("span",{children:" :"}),r.jsx("span",{children:M(e.subtotal||0)})]}),e.discount_amount>0&&r.jsxs("div",{className:"flex justify-between py-2 border-b",children:[r.jsx("span",{children:":"}),r.jsxs("span",{children:["(",M(e.discount_amount),")"]})]}),e.tax_amount>0&&r.jsxs("div",{className:"flex justify-between py-2 border-b",children:[r.jsx("span",{children:":"}),r.jsx("span",{children:M(e.tax_amount)})]}),e.expenses_egp>0&&r.jsxs("div",{className:"flex justify-between py-2 border-b",children:[r.jsx("span",{children:":"}),r.jsx("span",{children:M(e.expenses_egp)})]}),r.jsxs("div",{className:"flex justify-between py-2 font-bold text-lg border-t-2",children:[r.jsx("span",{children:":"}),r.jsx("span",{className:"text-primary",children:M(e.total_amount||0)})]}),r.jsxs("div",{className:"flex justify-between py-2",children:[r.jsx("span",{children:":"}),r.jsx("span",{children:M(e.paid_amount||0)})]}),e.remaining_amount>0&&r.jsxs("div",{className:"flex justify-between py-2 text-red-600 font-bold",children:[r.jsx("span",{children:":"}),r.jsx("span",{children:M(e.remaining_amount)})]})]})}),e.notes&&r.jsxs("div",{className:"mb-6",children:[r.jsx("p",{children:r.jsx("strong",{children:":"})}),r.jsx("p",{className:"text-sm",children:e.notes})]}),r.jsx("div",{className:"border-t-2 pt-4 mt-8",children:r.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[r.jsxs("div",{children:[r.jsx("p",{className:"mb-8",children:"_______________"}),r.jsx("p",{children:""})]}),r.jsxs("div",{children:[r.jsx("p",{className:"mb-8",children:"_______________"}),r.jsx("p",{children:""})]}),r.jsxs("div",{children:[r.jsx("p",{className:"mb-8",children:"_______________"}),r.jsx("p",{children:""})]})]})}),r.jsx("div",{className:"text-center text-xs text-gray-500 mt-4",children:r.jsxs("p",{children:[" : ",Ee(new Date().toISOString())]})})]}));Gg.displayName="PurchaseInvoicePrint";function Q1(){const[e,t]=S.useState(""),[s,n]=S.useState(!1),[a,i]=S.useState(null),[l,o]=S.useState(null),[c,u]=S.useState("all"),[d,m]=S.useState("all"),[f,v]=S.useState(1),g=10,w=ht(),{data:_}=se({queryKey:["purchases",e,c,d,f],queryFn:async()=>{let j=I.from("purchases").select("*",{count:"exact",head:!0});e&&(j=j.or(`invoice_number.ilike.%${e}%`)),c==="with_tax"?j=j.eq("has_tax",!0):c==="without_tax"&&(j=j.eq("has_tax",!1)),d==="paid"?j=j.eq("payment_status","paid"):d==="credit"&&(j=j.eq("payment_status","credit"));const{count:b}=await j;let N=I.from("purchases").select("*, supplier:suppliers(name, name_ar), branch:branches(name_ar)").order("created_at",{ascending:!1});e&&(N=N.or(`invoice_number.ilike.%${e}%`)),c==="with_tax"?N=N.eq("has_tax",!0):c==="without_tax"&&(N=N.eq("has_tax",!1)),d==="paid"?N=N.eq("payment_status","paid"):d==="credit"&&(N=N.eq("payment_status","credit"));const T=(f-1)*g,h=T+g-1,{data:R}=await N.range(T,h);return{purchases:R||[],totalCount:b||0,totalPages:Math.ceil((b||0)/g)}}}),x=(_==null?void 0:_.purchases)||[],p=(_==null?void 0:_.totalPages)||1,y=(_==null?void 0:_.totalCount)||0;return is.useEffect(()=>{v(1)},[e,c,d]),r.jsxs("div",{className:"p-3 md:p-6 space-y-4 md:space-y-6",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 mb-4 md:mb-6",children:[r.jsx("h1",{className:"text-xl md:text-2xl font-bold",children:""}),r.jsxs(L,{onClick:()=>n(!0),className:"w-full sm:w-auto",children:[r.jsx(Nt,{className:"ml-2 h-4 w-4"}),r.jsx("span",{className:"hidden sm:inline",children:"  "}),r.jsx("span",{className:"sm:hidden",children:""})]})]}),r.jsxs(le,{children:[r.jsx(Se,{children:r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:[r.jsxs("div",{className:"relative flex-1",children:[r.jsx(Os,{className:"absolute right-3 top-3 h-4 w-4 text-gray-400"}),r.jsx(G,{placeholder:"  ...",value:e,onChange:j=>t(j.target.value),className:"pr-10"})]}),r.jsxs("select",{value:c,onChange:j=>u(j.target.value),className:"px-3 py-2 border rounded-md bg-background text-sm","aria-label":" ",children:[r.jsx("option",{value:"all",children:" ()"}),r.jsx("option",{value:"with_tax",children:""}),r.jsx("option",{value:"without_tax",children:" "})]}),r.jsxs("select",{value:d,onChange:j=>m(j.target.value),className:"px-3 py-2 border rounded-md bg-background text-sm","aria-label":" ",children:[r.jsx("option",{value:"all",children:" ()"}),r.jsx("option",{value:"paid",children:""}),r.jsx("option",{value:"credit",children:""})]})]})}),r.jsx(Ce,{children:!x||x.length===0?r.jsx("div",{className:"text-center py-12 text-gray-500",children:"   "}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"mb-4 text-xs sm:text-sm text-muted-foreground",children:[" ",(f-1)*g+1," - ",Math.min(f*g,y),"  ",y," "]}),r.jsx("div",{className:"block md:hidden space-y-3",children:x.map(j=>{var b,N,T;return r.jsx(le,{className:"p-3",children:r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-bold text-sm",children:j.invoice_number}),r.jsx("p",{className:"text-xs text-muted-foreground",children:Ee(j.invoice_date||j.created_at||"")})]}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx(L,{variant:"ghost",size:"sm",onClick:()=>i(j.id),title:"",children:r.jsx(Mt,{className:"h-4 w-4"})}),r.jsx(L,{variant:"ghost",size:"sm",onClick:()=>o(j.id),title:"",children:r.jsx(Rr,{className:"h-4 w-4"})})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:": "}),r.jsx("span",{className:"font-medium",children:((b=j.supplier)==null?void 0:b.name_ar)||((N=j.supplier)==null?void 0:N.name)})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:": "}),r.jsx("span",{className:"font-medium",children:(T=j.branch)==null?void 0:T.name_ar})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:": "}),r.jsx("span",{className:"font-bold",children:M(j.total_amount||0)})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:": "}),r.jsx("span",{className:"font-medium",children:M(j.paid_amount||0)})]})]}),r.jsxs("div",{className:"flex gap-2 flex-wrap",children:[r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${j.has_tax?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:j.has_tax?"":""}),r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${j.payment_status==="paid"?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"}`,children:j.payment_status==="paid"?"":""})]})]})},j.id)})}),r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b",children:[r.jsx("th",{className:"text-right py-3 px-2",children:" "}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-center py-3 px-2",children:""})]})}),r.jsx("tbody",{children:x.map(j=>{var b,N,T;return r.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[r.jsx("td",{className:"py-3 px-2",children:j.invoice_number}),r.jsx("td",{className:"py-3 px-2",children:Ee(j.invoice_date||j.created_at||"")}),r.jsx("td",{className:"py-3 px-2",children:((b=j.supplier)==null?void 0:b.name_ar)||((N=j.supplier)==null?void 0:N.name)}),r.jsx("td",{className:"py-3 px-2",children:(T=j.branch)==null?void 0:T.name_ar}),r.jsx("td",{className:"py-3 px-2",children:M(j.total_amount||0)}),r.jsx("td",{className:"py-3 px-2",children:M(j.paid_amount||0)}),r.jsx("td",{className:"py-3 px-2",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${j.has_tax?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:j.has_tax?"":""})}),r.jsx("td",{className:"py-3 px-2",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${j.payment_status==="paid"?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"}`,children:j.payment_status==="paid"?"":""})}),r.jsx("td",{className:"py-3 px-2 text-center",children:r.jsxs("div",{className:"flex gap-1 justify-center",children:[r.jsx(L,{variant:"ghost",size:"sm",onClick:()=>i(j.id),title:" ",children:r.jsx(Mt,{className:"h-4 w-4"})}),r.jsx(L,{variant:"ghost",size:"sm",onClick:()=>o(j.id),title:"",children:r.jsx(Rr,{className:"h-4 w-4"})})]})})]},j.id)})})]})}),p>1&&r.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t gap-2",children:[r.jsx(L,{variant:"outline",size:"sm",onClick:()=>v(j=>Math.max(1,j-1)),disabled:f===1,className:"text-xs sm:text-sm",children:""}),r.jsx("div",{className:"flex items-center gap-1 sm:gap-2",children:Array.from({length:Math.min(5,p)},(j,b)=>{let N;return p<=5||f<=3?N=b+1:f>=p-2?N=p-4+b:N=f-2+b,r.jsx(L,{variant:f===N?"default":"outline",size:"sm",onClick:()=>v(N),className:"w-8 h-8 sm:w-10 sm:h-10 p-0 text-xs sm:text-sm",children:N},N)})}),r.jsx(L,{variant:"outline",size:"sm",onClick:()=>v(j=>Math.min(p,j+1)),disabled:f===p,className:"text-xs sm:text-sm",children:""})]})]})})]}),r.jsx(et,{open:s,onOpenChange:n,children:r.jsxs(tt,{className:"max-w-[95vw] sm:max-w-6xl max-h-[90vh] overflow-auto",children:[r.jsx(it,{children:r.jsx(lt,{className:"text-base sm:text-lg",children:"  "})}),r.jsx(G1,{onClose:()=>n(!1),onSuccess:()=>{n(!1),w.invalidateQueries({queryKey:["purchases"]})}})]})}),a&&r.jsx(et,{open:!!a,onOpenChange:()=>i(null),children:r.jsxs(tt,{className:"max-w-[95vw] sm:max-w-4xl max-h-[90vh] overflow-auto",children:[r.jsx(it,{children:r.jsx(lt,{className:"text-base sm:text-lg",children:"  "})}),r.jsx(J1,{purchaseId:a,onClose:()=>i(null)})]})}),l&&r.jsx(Y1,{purchaseId:l,onClose:()=>o(null)})]})}function G1({onClose:e,onSuccess:t}){const[s,n]=S.useState(""),[a,i]=S.useState(""),[l,o]=S.useState(""),[c,u]=S.useState(""),[d,m]=S.useState([]),[f,v]=S.useState(""),[g,w]=S.useState("cash"),[_,x]=S.useState(!1),[p,y]=S.useState(!1),[j,b]=S.useState(!1),[N,T]=S.useState(!1),[h,R]=S.useState(""),[P,U]=S.useState(""),[W,ee]=S.useState(""),[oe,re]=S.useState(""),[ue,me]=S.useState(""),{data:V}=se({queryKey:["usd-rate"],queryFn:async()=>{const{data:F}=await I.from("system_settings").select("value").eq("key","usd_exchange_rate").single(),we=F?F.value:"50";return parseFloat(we||"50")}}),{data:Y}=se({queryKey:["next-purchase-invoice"],queryFn:async()=>{const{data:F}=await I.from("purchases").select("invoice_number").order("created_at",{ascending:!1}).limit(1);if(F&&F.length>0){const pe=F[0].invoice_number.match(/PUR-(\d+)/);if(pe)return`PUR-${(parseInt(pe[1])+1).toString().padStart(6,"0")}`}return"PUR-000001"}}),{data:Z}=se({queryKey:["purchase-branches"],queryFn:async()=>{const{data:F}=await I.from("branches").select("*").eq("status","active").order("name_ar");return F||[]}}),{data:O}=se({queryKey:["purchase-suppliers",l],queryFn:async()=>{let F=I.from("suppliers").select("*").eq("status","active").order("name_ar");l&&(F=F.or(`name_ar.ilike.%${l}%,name.ilike.%${l}%,code.ilike.%${l}%`));const{data:we}=await F.limit(10);return we||[]}}),{data:C}=se({queryKey:["purchase-products"],queryFn:async()=>{const{data:F}=await I.from("products").select("*").eq("status","active").order("name_ar");return F||[]}}),B=Z==null?void 0:Z.find(F=>F.id===s),K=O==null?void 0:O.find(F=>F.id===a),ce=d.reduce((F,we)=>F+we.total,0),Q=parseFloat(h)||0,ge=parseFloat(P)||0,Me=parseFloat(W)||0,A=parseFloat(oe)||0,D=parseFloat(ue)||0,q=Q+ge+Me+A+D,k=ce+q,$=g==="cash"?k:parseFloat(f)||0,z=k-$,J=F=>{if(d.find(pe=>pe.product.id===F.id))m(d.map(pe=>pe.product.id===F.id?{...pe,quantity:pe.quantity+1,total:(pe.quantity+1)*pe.unit_price}:pe));else{const pe={id:crypto.randomUUID(),product:F,quantity:1,unit_price:F.purchase_price||0,total:F.purchase_price||0};m([...d,pe])}T(!1)},xe=(F,we)=>{m(d.map(pe=>{if(pe.id===F){const Ke=Math.max(1,pe.quantity+we);return{...pe,quantity:Ke,total:Ke*pe.unit_price}}return pe}))},Re=(F,we)=>{m(d.map(pe=>pe.id===F?{...pe,unit_price:we,total:pe.quantity*we}:pe))},De=F=>{m(d.filter(we=>we.id!==F))},ae=dt({mutationFn:async()=>{var ke;if(!s||!a)throw new Error("   ");if(d.length===0)throw new Error("  ");const{data:F}=await I.from("users").select("id").limit(1),we=(ke=F==null?void 0:F[0])==null?void 0:ke.id;if(!we)throw new Error("  ");const pe=Y||`PUR-${Date.now()}`,Ke=g==="cash"?"paid":z>0?"credit":"paid",ws={invoice_number:pe,invoice_date:new Date().toISOString(),supplier_invoice_number:c||null,branch_id:s,supplier_id:a,received_by:we,subtotal:ce,transport_cost:Q||null,shipping_cost:ge||null,transfer_fees:Me||null,customs_fees:A||null,clearance_fees:D||null,total_expenses:q||null,has_tax:_,payment_type:g,payment_status:Ke,total_amount:k,paid_amount:$,remaining_amount:z>0?z:0,status:"received"},{data:zt,error:_s}=await I.from("purchases").insert(ws).select().single();if(_s)throw _s;const Do=d.map(be=>({purchase_id:zt.id,product_id:be.product.id,quantity:be.quantity,received_quantity:be.quantity,unit_price:be.unit_price,total_price:be.total})),{error:yt}=await I.from("purchase_items").insert(Do);if(yt)throw yt;for(const be of d){const{data:vt}=await I.from("inventory").select("id, quantity").eq("product_id",be.product.id).eq("branch_id",s).single();vt?await I.from("inventory").update({quantity:(vt.quantity||0)+be.quantity}).eq("id",vt.id):await I.from("inventory").insert({product_id:be.product.id,branch_id:s,quantity:be.quantity})}return zt},onSuccess:()=>{alert("    !"),t()},onError:F=>{alert(" : "+F.message)}});return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"relative",children:[r.jsx("label",{className:"text-sm font-medium mb-2 block",children:""}),r.jsxs("div",{className:"flex items-center gap-2 p-3 border rounded-md cursor-pointer hover:bg-muted",onClick:()=>y(!p),children:[r.jsx(Ir,{className:"h-4 w-4"}),r.jsx("span",{className:"flex-1",children:B?B.name_ar:" "})]}),p&&r.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-background border rounded-md shadow-lg z-10 max-h-60 overflow-auto",children:Z==null?void 0:Z.map(F=>r.jsxs("button",{type:"button",className:"w-full p-3 text-right hover:bg-muted",onClick:()=>{n(F.id),y(!1)},children:[r.jsx("p",{className:"font-medium",children:F.name_ar}),r.jsx("p",{className:"text-xs text-muted-foreground",children:F.branch_type==="warehouse"?"":" "})]},F.id))})]}),r.jsxs("div",{className:"relative",children:[r.jsx("label",{className:"text-sm font-medium mb-2 block",children:""}),r.jsxs("div",{className:"relative",children:[r.jsx(Pi,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),r.jsx(G,{placeholder:"  ...",value:l,onChange:F=>{o(F.target.value),b(!0)},onFocus:()=>b(!0),className:"pr-10"})]}),K&&r.jsxs("div",{className:"mt-2 p-2 bg-muted rounded-md text-sm",children:[r.jsx("p",{className:"font-medium",children:K.name_ar||K.name}),r.jsx("p",{className:"text-xs text-muted-foreground",children:K.phone})]}),j&&l&&O&&O.length>0&&r.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-background border rounded-md shadow-lg z-10 max-h-60 overflow-auto",children:O.map(F=>r.jsxs("button",{type:"button",className:"w-full p-3 text-right hover:bg-muted",onClick:()=>{i(F.id),o(F.name_ar||F.name||""),b(!1)},children:[r.jsx("p",{className:"font-medium",children:F.name_ar||F.name}),r.jsxs("p",{className:"text-xs text-muted-foreground",children:[F.code," - ",F.phone]})]},F.id))})]})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium mb-2 block",children:" "}),r.jsx(G,{value:Y||" ...",disabled:!0,className:"bg-muted"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium mb-2 block",children:"   ()"}),r.jsx(G,{placeholder:"  ...",value:c,onChange:F=>u(F.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium mb-2 block",children:" "}),r.jsxs("div",{className:"flex gap-4 items-center h-10",children:[r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",value:"cash",checked:g==="cash",onChange:()=>w("cash"),className:"cursor-pointer"}),r.jsx("span",{children:""})]}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",value:"credit",checked:g==="credit",onChange:()=>w("credit"),className:"cursor-pointer"}),r.jsx("span",{children:""})]})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium mb-2 block",children:" "}),r.jsxs("div",{className:"flex gap-4 items-center",children:[r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",checked:_,onChange:()=>x(!0),className:"cursor-pointer"}),r.jsx("span",{children:""})]}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",checked:!_,onChange:()=>x(!1),className:"cursor-pointer"}),r.jsx("span",{children:" "})]})]})]}),r.jsxs("div",{className:"relative",children:[r.jsx("label",{className:"text-sm font-medium mb-2 block",children:" "}),r.jsxs("div",{className:"flex items-center gap-2 p-3 border rounded-md cursor-pointer hover:bg-muted",onClick:()=>T(!N),children:[r.jsx(Bm,{className:"h-4 w-4"}),r.jsx("span",{className:"flex-1",children:"  "})]}),N&&r.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-background border rounded-md shadow-lg z-10 max-h-60 overflow-auto",children:C&&C.length>0?C.map(F=>r.jsxs("button",{type:"button",className:"w-full p-3 text-right hover:bg-muted flex justify-between items-center",onClick:()=>J(F),children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:F.name_ar}),r.jsx("p",{className:"text-xs text-muted-foreground",children:F.code})]}),r.jsx("p",{className:"text-sm font-medium",children:M(F.purchase_price||0)})]},F.id)):r.jsx("p",{className:"p-3 text-center text-muted-foreground",children:"  "})})]}),r.jsxs("div",{className:"border rounded-md p-4",children:[r.jsx("h3",{className:"font-medium mb-3",children:""}),d.length===0?r.jsx("p",{className:"text-center text-muted-foreground py-4",children:"    "}):r.jsx("div",{className:"space-y-2",children:d.map(F=>r.jsxs("div",{className:"flex items-center gap-2 p-2 bg-muted/50 rounded",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"font-medium text-sm",children:F.product.name_ar}),r.jsx("p",{className:"text-xs text-muted-foreground",children:F.product.code})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(L,{variant:"outline",size:"icon",className:"h-7 w-7",onClick:()=>xe(F.id,-1),children:r.jsx(Io,{className:"h-3 w-3"})}),r.jsx(G,{type:"number",value:F.quantity,onChange:we=>{const pe=parseInt(we.target.value)||1;pe<1||m(d.map(Ke=>Ke.id===F.id?{...Ke,quantity:pe,total:pe*Ke.unit_price}:Ke))},className:"w-16 h-7 text-center font-bold p-1",min:1}),r.jsx(L,{variant:"outline",size:"icon",className:"h-7 w-7",onClick:()=>xe(F.id,1),children:r.jsx(Nt,{className:"h-3 w-3"})})]}),r.jsx(G,{type:"number",value:F.unit_price,onChange:we=>Re(F.id,parseFloat(we.target.value)||0),className:"w-24 h-8 text-center"}),r.jsx("span",{className:"font-bold w-24 text-left",children:M(F.total)}),r.jsx(L,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>De(F.id),children:r.jsx(Rs,{className:"h-3 w-3 text-destructive"})})]},F.id))})]}),r.jsxs("div",{className:"border-t pt-4 space-y-3",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:" "}),r.jsx("span",{className:"font-bold",children:M(ce)})]}),r.jsxs("div",{className:"border rounded-lg p-4 bg-blue-50 space-y-3",children:[r.jsx("h4",{className:"font-medium text-sm mb-2",children:"  ()"}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:""}),r.jsx(G,{type:"number",step:"0.01",value:h,onChange:F=>R(F.target.value),placeholder:"0.00",className:"h-9"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:""}),r.jsx(G,{type:"number",step:"0.01",value:P,onChange:F=>U(F.target.value),placeholder:"0.00",className:"h-9"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:" "}),r.jsx(G,{type:"number",step:"0.01",value:W,onChange:F=>ee(F.target.value),placeholder:"0.00",className:"h-9"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:""}),r.jsx(G,{type:"number",step:"0.01",value:oe,onChange:F=>re(F.target.value),placeholder:"0.00",className:"h-9"})]}),r.jsxs("div",{className:"sm:col-span-2",children:[r.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:" "}),r.jsx(G,{type:"number",step:"0.01",value:ue,onChange:F=>me(F.target.value),placeholder:"0.00",className:"h-9"})]})]}),q>0&&r.jsxs("div",{className:"flex justify-between text-sm font-medium border-t pt-2",children:[r.jsx("span",{children:" "}),r.jsx("span",{className:"text-blue-700",children:M(q)})]})]}),r.jsxs("div",{className:"flex justify-between text-lg font-bold border-t pt-2",children:[r.jsx("span",{children:" "}),r.jsx("span",{className:"text-primary",children:M(k)})]}),g==="credit"&&r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-sm",children:""}),r.jsx(G,{type:"number",value:f,onChange:F=>v(F.target.value),className:"flex-1 h-10",placeholder:"0"})]}),g==="cash"&&r.jsxs("div",{className:"flex justify-between text-green-600",children:[r.jsx("span",{children:" "}),r.jsx("span",{className:"font-bold",children:M(k)})]}),z>0&&g==="credit"&&r.jsxs("div",{className:"flex justify-between text-destructive",children:[r.jsx("span",{children:""}),r.jsx("span",{className:"font-bold",children:M(z)})]})]}),r.jsxs("div",{className:"flex gap-2 justify-end pt-4",children:[r.jsx(L,{variant:"outline",onClick:e,children:""}),r.jsxs(L,{onClick:()=>ae.mutate(),disabled:ae.isPending||d.length===0,children:[r.jsx(Bm,{className:"h-4 w-4 ml-2"})," "]})]})]})}function J1({purchaseId:e,onClose:t}){var u,d,m,f,v,g;const[s,n]=S.useState(!1),[a,i]=S.useState(""),l=ht(),{data:o}=se({queryKey:["purchase-details",e],queryFn:async()=>{const{data:w}=await I.from("purchases").select(`
          *,
          supplier:suppliers(name, name_ar, phone),
          branch:branches(name_ar),
          items:purchase_items(
            *,
            product:products(code, name_ar)
          )
        `).eq("id",e).single();return w}});if(!o)return r.jsx("div",{className:"text-center py-8",children:" ..."});return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4 p-4 bg-muted rounded-md",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:"font-bold",children:o.invoice_number})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:""}),r.jsx("p",{className:"font-bold",children:Ee(o.invoice_date||"")})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:""}),r.jsx("p",{className:"font-bold",children:((u=o.supplier)==null?void 0:u.name_ar)||((d=o.supplier)==null?void 0:d.name)}),((m=o.supplier)==null?void 0:m.phone)&&r.jsx("p",{className:"text-xs text-muted-foreground",children:o.supplier.phone})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:""}),r.jsx("p",{className:"font-bold",children:(f=o.branch)==null?void 0:f.name_ar})]}),o.supplier_invoice_number&&r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"  "}),r.jsx("p",{className:"font-bold",children:o.supplier_invoice_number})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:" "}),r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${o.has_tax?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:o.has_tax?"":" "})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:" "}),r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${o.payment_status==="paid"?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"}`,children:o.payment_status==="paid"?"":""})]})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-bold mb-3",children:""}),r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b",children:[r.jsx("th",{className:"text-right py-2",children:""}),r.jsx("th",{className:"text-right py-2",children:""}),r.jsx("th",{className:"text-center py-2",children:""}),r.jsx("th",{className:"text-right py-2",children:""}),r.jsx("th",{className:"text-right py-2",children:""})]})}),r.jsx("tbody",{children:(v=o.items)==null?void 0:v.map(w=>{var _,x;return r.jsxs("tr",{className:"border-b",children:[r.jsx("td",{className:"py-2",children:(_=w.product)==null?void 0:_.code}),r.jsx("td",{className:"py-2",children:(x=w.product)==null?void 0:x.name_ar}),r.jsx("td",{className:"py-2 text-center",children:w.quantity}),r.jsx("td",{className:"py-2",children:M(w.unit_price)}),r.jsx("td",{className:"py-2",children:M(w.total_price)})]},w.id)})})]})]}),r.jsxs("div",{className:"border-t pt-4 space-y-2",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:" "}),r.jsx("span",{className:"font-bold",children:M(o.subtotal||0)})]}),(o.expenses_usd||0)>0&&r.jsx("div",{className:"bg-blue-50 p-2 rounded",children:r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:""}),r.jsxs("span",{className:"font-bold text-blue-700",children:["$",(g=o.expenses_usd)==null?void 0:g.toFixed(2)," (",M(o.expenses_egp||0),")"]})]})}),r.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[r.jsx("span",{children:""}),r.jsx("span",{className:"text-primary",children:M(o.total_amount||0)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:""}),r.jsx("span",{className:"font-bold text-green-600",children:M(o.paid_amount||0)})]}),(o.remaining_amount||0)>0&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:""}),r.jsx("span",{className:"font-bold text-destructive",children:M(o.remaining_amount||0)})]})]}),r.jsxs("div",{className:"flex justify-between pt-4 border-t",children:[(o.remaining_amount||0)>0&&r.jsx(L,{variant:"outline",onClick:()=>n(!0),className:"bg-green-50 hover:bg-green-100",children:" "}),r.jsx(L,{onClick:t,className:"mr-auto",children:""})]}),r.jsx(et,{open:s,onOpenChange:n,children:r.jsxs(tt,{children:[r.jsx(it,{children:r.jsx(lt,{children:" "})}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:" "}),r.jsx("p",{className:"text-2xl font-bold text-destructive",children:M(o.remaining_amount||0)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium mb-2 block",children:" "}),r.jsx(G,{type:"number",value:a,onChange:w=>i(w.target.value),placeholder:" ",autoFocus:!0})]}),r.jsxs("div",{className:"flex gap-2 justify-end",children:[r.jsx(L,{variant:"outline",onClick:()=>{n(!1),i("")},children:""}),r.jsx(L,{onClick:()=>c(),disabled:!a||parseFloat(a)<=0,children:" "})]})]})]})})]});async function c(){if(!o){alert("   ");return}const w=parseFloat(a);if(!w||w<=0){alert("   ");return}const _=o.remaining_amount||0;if(w>_){alert("     ");return}try{const x=(o.paid_amount||0)+w,p=(o.total_amount||0)-x,y=p<=0?"paid":"credit",{error:j}=await I.from("purchases").update({paid_amount:x,remaining_amount:p,payment_status:y}).eq("id",e);if(j)throw j;alert("   "),n(!1),i(""),l.invalidateQueries({queryKey:["purchase-details",e]}),l.invalidateQueries({queryKey:["purchases"]})}catch(x){console.error("Error adding payment:",x),alert("    ")}}}function Y1({purchaseId:e,onClose:t}){const s=S.useRef(null),{data:n}=se({queryKey:["purchase-print",e],queryFn:async()=>{const{data:l}=await I.from("purchases").select("*, supplier:suppliers(*), branch:branches(*)").eq("id",e).single();return l}}),{data:a}=se({queryKey:["purchase-items-print",e],queryFn:async()=>{const{data:l}=await I.from("purchase_items").select("*, product:products(*)").eq("purchase_id",e);return l||[]}}),i=Qg.useReactToPrint({content:()=>s.current,onAfterPrint:t});return!n||!a?r.jsx(et,{open:!0,onOpenChange:t,children:r.jsx(tt,{children:r.jsx("div",{className:"text-center py-8",children:" ..."})})}):r.jsx(et,{open:!0,onOpenChange:t,children:r.jsxs(tt,{className:"max-w-4xl",children:[r.jsx(it,{children:r.jsx(lt,{children:"  "})}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"max-h-[60vh] overflow-auto border rounded",children:r.jsx(Gg,{ref:s,purchase:n,items:a,supplier:n.supplier,branch:n.branch})}),r.jsxs("div",{className:"flex gap-2 justify-end",children:[r.jsx(L,{variant:"outline",onClick:t,children:""}),r.jsxs(L,{onClick:i,children:[r.jsx(Rr,{className:"ml-2 h-4 w-4"}),""]})]})]})]})})}const yl={active:{label:"",color:"bg-green-100 text-green-700"},inactive:{label:" ",color:"bg-gray-100 text-gray-700"},blocked:{label:"",color:"bg-red-100 text-red-700"}};function X1(){const[e,t]=S.useState(""),[s,n]=S.useState(!1),[a,i]=S.useState(1),l=10,[o,c]=S.useState({name_ar:"",phone:"",email:"",address:"",credit_limit:0}),u=ht(),{data:d,isLoading:m}=se({queryKey:["suppliers",e,a],queryFn:async()=>{let x=I.from("suppliers").select("*",{count:"exact",head:!0});e&&(x=x.or(`name.ilike.%${e}%,name_ar.ilike.%${e}%,code.ilike.%${e}%,phone.ilike.%${e}%`));const{count:p}=await x;let y=I.from("suppliers").select("*").order("created_at",{ascending:!1});e&&(y=y.or(`name.ilike.%${e}%,name_ar.ilike.%${e}%,code.ilike.%${e}%,phone.ilike.%${e}%`));const j=(a-1)*l,b=j+l-1,{data:N}=await y.range(j,b);return{suppliers:N||[],totalCount:p||0,totalPages:Math.ceil((p||0)/l)}}}),f=(d==null?void 0:d.suppliers)||[],v=(d==null?void 0:d.totalPages)||1,g=(d==null?void 0:d.totalCount)||0;is.useEffect(()=>{i(1)},[e]);const w=dt({mutationFn:async x=>{await I.from("suppliers").delete().eq("id",x)},onSuccess:()=>u.invalidateQueries({queryKey:["suppliers"]})}),_=dt({mutationFn:async()=>{const x=`SUP-${Date.now()}`,{error:p}=await I.from("suppliers").insert({code:x,name_ar:o.name_ar,name:o.name_ar,phone:o.phone,email:o.email||null,address:o.address||null,credit_limit:o.credit_limit,current_balance:0,status:"active",rating:0});if(p)throw p},onSuccess:()=>{u.invalidateQueries({queryKey:["suppliers"]}),n(!1),c({name_ar:"",phone:"",email:"",address:"",credit_limit:0}),alert("   !")},onError:x=>alert(": "+x.message)});return r.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl sm:text-2xl font-bold",children:""}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"  "})]}),r.jsxs(L,{onClick:()=>n(!0),className:"w-full sm:w-auto",children:[r.jsx(Nt,{className:"h-4 w-4 ml-2"})," "]})]}),r.jsx(et,{open:s,onOpenChange:n,children:r.jsxs(tt,{onClose:()=>n(!1),className:"max-w-[95vw] sm:max-w-lg max-h-[90vh] overflow-y-auto",children:[r.jsx(it,{children:r.jsx(lt,{className:"text-base sm:text-lg",children:"  "})}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"name",className:"text-sm font-medium",children:"  *"}),r.jsx(G,{id:"name",value:o.name_ar,onChange:x=>c({...o,name_ar:x.target.value}),placeholder:"  "})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"phone",className:"text-sm font-medium",children:"  *"}),r.jsx(G,{id:"phone",value:o.phone,onChange:x=>c({...o,phone:x.target.value}),placeholder:"  "})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"email",className:"text-sm font-medium",children:" "}),r.jsx(G,{id:"email",type:"email",value:o.email,onChange:x=>c({...o,email:x.target.value}),placeholder:"  "})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"address",className:"text-sm font-medium",children:""}),r.jsx(G,{id:"address",value:o.address,onChange:x=>c({...o,address:x.target.value}),placeholder:" "})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"credit",className:"text-sm font-medium",children:" "}),r.jsx(G,{id:"credit",type:"number",value:o.credit_limit,onChange:x=>c({...o,credit_limit:parseFloat(x.target.value)||0}),placeholder:"0"})]})]}),r.jsxs(js,{className:"flex-col sm:flex-row gap-2",children:[r.jsx(L,{variant:"outline",onClick:()=>n(!1),className:"w-full sm:w-auto",children:""}),r.jsx(L,{onClick:()=>_.mutate(),disabled:!o.name_ar||!o.phone||_.isPending,className:"w-full sm:w-auto",children:_.isPending?" ...":""})]})]})}),r.jsxs(le,{children:[r.jsx(Se,{children:r.jsxs("div",{className:"relative flex-1 max-w-sm",children:[r.jsx(Os,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),r.jsx(G,{placeholder:"     ...",value:e,onChange:x=>t(x.target.value),className:"pr-10"})]})}),r.jsx(Ce,{children:m?r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:" ..."}):f!=null&&f.length?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"mb-4 text-sm text-muted-foreground",children:[" ",(a-1)*l+1," - ",Math.min(a*l,g),"  ",g," "]}),r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b",children:[r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:" "}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""})]})}),r.jsx("tbody",{children:f.map(x=>r.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[r.jsx("td",{className:"py-3 px-2 font-mono text-sm",children:x.code}),r.jsx("td",{className:"py-3 px-2",children:x.name_ar||x.name}),r.jsx("td",{className:"py-3 px-2",children:r.jsxs("div",{className:"flex flex-col gap-1 text-sm",children:[r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(co,{className:"h-3 w-3"}),x.phone]}),x.email&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(oo,{className:"h-3 w-3"}),x.email]})]})}),r.jsx("td",{className:"py-3 px-2",children:r.jsx("span",{className:x.current_balance&&x.current_balance>0?"text-destructive":"",children:M(x.current_balance||0)})}),r.jsx("td",{className:"py-3 px-2",children:M(x.credit_limit||0)}),r.jsx("td",{className:"py-3 px-2",children:r.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(p=>r.jsx(Km,{className:`h-4 w-4 ${p<=(x.rating||0)?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},p))})}),r.jsx("td",{className:"py-3 px-2",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${yl[x.status||"active"].color}`,children:yl[x.status||"active"].label})}),r.jsx("td",{className:"py-3 px-2",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(L,{variant:"ghost",size:"icon",children:r.jsx(yn,{className:"h-4 w-4"})}),r.jsx(L,{variant:"ghost",size:"icon",onClick:()=>w.mutate(x.id),children:r.jsx(Rs,{className:"h-4 w-4 text-destructive"})})]})})]},x.id))})]})}),r.jsx("div",{className:"block md:hidden space-y-3",children:f.map(x=>r.jsx(le,{className:"p-4",children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-bold",children:x.name_ar||x.name}),r.jsx("p",{className:"text-xs text-muted-foreground font-mono",children:x.code})]}),r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${yl[x.status||"active"].color}`,children:yl[x.status||"active"].label})]}),r.jsxs("div",{className:"space-y-1 text-sm",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(co,{className:"h-4 w-4 text-muted-foreground"}),r.jsx("span",{children:x.phone})]}),x.email&&r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(oo,{className:"h-4 w-4 text-muted-foreground"}),r.jsx("span",{className:"text-xs",children:x.email})]}),r.jsxs("div",{className:"flex justify-between pt-2 border-t",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:`font-bold ${x.current_balance&&x.current_balance>0?"text-destructive":""}`,children:M(x.current_balance||0)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:" :"}),r.jsx("span",{className:"font-medium",children:M(x.credit_limit||0)})]}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(p=>r.jsx(Km,{className:`h-4 w-4 ${p<=(x.rating||0)?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},p))})]})]}),r.jsxs("div",{className:"flex gap-2 pt-2",children:[r.jsxs(L,{variant:"outline",size:"sm",className:"flex-1",children:[r.jsx(yn,{className:"h-4 w-4 ml-2"}),""]}),r.jsxs(L,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>w.mutate(x.id),children:[r.jsx(Rs,{className:"h-4 w-4 ml-2 text-destructive"}),""]})]})]})},x.id))}),v>1&&r.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t gap-2",children:[r.jsx(L,{variant:"outline",size:"sm",onClick:()=>i(x=>Math.max(1,x-1)),disabled:a===1,className:"text-xs sm:text-sm",children:""}),r.jsx("div",{className:"flex items-center gap-1 sm:gap-2",children:Array.from({length:Math.min(5,v)},(x,p)=>{let y=v<=5||a<=3?p+1:a>=v-2?v-4+p:a-2+p;return r.jsx(L,{variant:a===y?"default":"outline",size:"sm",onClick:()=>i(y),className:"w-8 h-8 sm:w-10 sm:h-10 p-0 text-xs sm:text-sm",children:y},y)})}),r.jsx(L,{variant:"outline",size:"sm",onClick:()=>i(x=>Math.min(v,x+1)),disabled:a===v,className:"text-xs sm:text-sm",children:""})]})]}):r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:"  "})})]})]})}const Qa={pending:{label:"",color:"bg-yellow-100 text-yellow-700"},approved:{label:" ",color:"bg-green-100 text-green-700"},rejected:{label:"",color:"bg-red-100 text-red-700"},completed:{label:"",color:"bg-green-100 text-green-700"}},Ga={draft:{label:"",color:"bg-gray-100 text-gray-700"},approved:{label:" ",color:"bg-blue-100 text-blue-700"},completed:{label:"",color:"bg-green-100 text-green-700"}};function Z1(){const[e,t]=S.useState(""),[s,n]=S.useState("sales"),[a,i]=S.useState(!1),[l,o]=S.useState(null),[c,u]=S.useState(1),[d,m]=S.useState(1),f=10,v=ht(),{data:g,isLoading:w}=se({queryKey:["sales-returns",e,c],queryFn:async()=>{let h=I.from("sales_returns").select("*",{count:"exact",head:!0});e&&(h=h.ilike("return_number",`%${e}%`));const{count:R}=await h;let P=I.from("sales_returns").select("*, customer:customers(name, name_ar), branch:branches(name_ar), sale:sales(invoice_number)").order("created_at",{ascending:!1});e&&(P=P.ilike("return_number",`%${e}%`));const U=(c-1)*f,W=U+f-1,{data:ee}=await P.range(U,W);return{returns:ee||[],totalCount:R||0,totalPages:Math.ceil((R||0)/f)}},enabled:s==="sales"}),{data:_,isLoading:x}=se({queryKey:["purchase-returns",e,d],queryFn:async()=>{let h=I.from("purchase_returns").select("*",{count:"exact",head:!0});e&&(h=h.ilike("return_number",`%${e}%`));const{count:R}=await h;let P=I.from("purchase_returns").select("*, supplier:suppliers(name, name_ar), branch:branches(name_ar), purchase:purchases(invoice_number)").order("created_at",{ascending:!1});e&&(P=P.ilike("return_number",`%${e}%`));const U=(d-1)*f,W=U+f-1,{data:ee}=await P.range(U,W);return{returns:ee||[],totalCount:R||0,totalPages:Math.ceil((R||0)/f)}},enabled:s==="purchases"}),p=(g==null?void 0:g.returns)||[],y=(g==null?void 0:g.totalPages)||1,j=(g==null?void 0:g.totalCount)||0,b=(_==null?void 0:_.returns)||[],N=(_==null?void 0:_.totalPages)||1,T=(_==null?void 0:_.totalCount)||0;return is.useEffect(()=>{u(1),m(1)},[e]),r.jsxs("div",{className:"p-3 md:p-6 space-y-4 md:space-y-6",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl md:text-2xl font-bold",children:""}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"   "})]}),r.jsxs(L,{onClick:()=>i(!0),className:"w-full sm:w-auto",children:[r.jsx(Nt,{className:"h-4 w-4 ml-2"}),r.jsx("span",{className:"hidden sm:inline",children:" "}),r.jsx("span",{className:"sm:hidden",children:""})]})]}),r.jsxs("div",{className:"flex gap-2 border-b",children:[r.jsxs("button",{onClick:()=>n("sales"),className:`flex items-center gap-2 px-4 py-2 border-b-2 transition-colors ${s==="sales"?"border-primary text-primary":"border-transparent hover:text-primary"}`,children:[r.jsx(Ei,{className:"h-4 w-4"})," "]}),r.jsxs("button",{onClick:()=>n("purchases"),className:`flex items-center gap-2 px-4 py-2 border-b-2 transition-colors ${s==="purchases"?"border-primary text-primary":"border-transparent hover:text-primary"}`,children:[r.jsx(Ei,{className:"h-4 w-4"})," "]})]}),r.jsxs(le,{children:[r.jsx(Se,{children:r.jsxs("div",{className:"relative flex-1 max-w-sm",children:[r.jsx(Os,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),r.jsx(G,{placeholder:"  ...",value:e,onChange:h=>t(h.target.value),className:"pr-10"})]})}),r.jsx(Ce,{children:s==="sales"?w?r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:" ..."}):p!=null&&p.length?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b",children:[r.jsx("th",{className:"text-right py-3 px-2",children:" "}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:" "}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""})]})}),r.jsx("tbody",{children:p.map(h=>{var R,P,U;return r.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[r.jsx("td",{className:"py-3 px-2 font-mono",children:h.return_number}),r.jsx("td",{className:"py-3 px-2",children:Ee(h.return_date||h.created_at)}),r.jsx("td",{className:"py-3 px-2",children:(R=h.sale)==null?void 0:R.invoice_number}),r.jsx("td",{className:"py-3 px-2",children:((P=h.customer)==null?void 0:P.name_ar)||((U=h.customer)==null?void 0:U.name)||"-"}),r.jsx("td",{className:"py-3 px-2",children:M(h.total_amount||0)}),r.jsx("td",{className:"py-3 px-2",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${Qa[h.status||"pending"].color}`,children:Qa[h.status||"pending"].label})}),r.jsxs("td",{className:"py-3 px-2 flex gap-1",children:[r.jsx(L,{variant:"ghost",size:"icon",onClick:()=>o(h.id),children:r.jsx(Mt,{className:"h-4 w-4"})}),h.status==="pending"&&r.jsx(L,{variant:"ghost",size:"sm",onClick:async()=>{const{error:W}=await I.from("sales_returns").update({status:"completed"}).eq("id",h.id);W||(alert("  !"),v.invalidateQueries({queryKey:["sales-returns"]}))},children:""})]})]},h.id)})})]})}),r.jsx("div",{className:"block md:hidden space-y-3",children:p.map(h=>{var R,P,U;return r.jsx(le,{className:"p-4",children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-mono text-sm font-bold",children:h.return_number}),r.jsx("p",{className:"text-xs text-muted-foreground",children:Ee(h.return_date||h.created_at)})]}),r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${Qa[h.status||"pending"].color}`,children:Qa[h.status||"pending"].label})]}),r.jsxs("div",{className:"space-y-1 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:" :"}),r.jsx("span",{className:"font-medium",children:(R=h.sale)==null?void 0:R.invoice_number})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-medium",children:((P=h.customer)==null?void 0:P.name_ar)||((U=h.customer)==null?void 0:U.name)||"-"})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-bold text-primary",children:M(h.total_amount||0)})]})]}),r.jsxs("div",{className:"flex gap-2 pt-2",children:[r.jsxs(L,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>o(h.id),children:[r.jsx(Mt,{className:"h-4 w-4 ml-2"}),""]}),h.status==="pending"&&r.jsx(L,{size:"sm",className:"flex-1",onClick:async()=>{const{error:W}=await I.from("sales_returns").update({status:"completed"}).eq("id",h.id);W||(alert("  !"),v.invalidateQueries({queryKey:["sales-returns"]}))},children:""})]})]})},h.id)})}),r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 mt-4 pt-4 border-t",children:[r.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",(c-1)*f+1,"-",Math.min(c*f,j),"  ",j]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(L,{variant:"outline",size:"sm",onClick:()=>u(h=>Math.max(1,h-1)),disabled:c===1,className:"text-xs sm:text-sm",children:""}),Array.from({length:Math.min(5,y)},(h,R)=>{let P;return y<=5||c<=3?P=R+1:c>=y-2?P=y-4+R:P=c-2+R,r.jsx(L,{variant:c===P?"default":"outline",size:"sm",onClick:()=>u(P),className:"w-8 h-8 sm:w-10 sm:h-10 p-0 text-xs sm:text-sm",children:P},P)}),r.jsx(L,{variant:"outline",size:"sm",onClick:()=>u(h=>Math.min(y,h+1)),disabled:c===y,className:"text-xs sm:text-sm",children:""})]})]})]}):r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:"  "}):x?r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:" ..."}):b!=null&&b.length?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b",children:[r.jsx("th",{className:"text-right py-3 px-2",children:" "}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:" "}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""})]})}),r.jsx("tbody",{children:b.map(h=>{var R,P,U;return r.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[r.jsx("td",{className:"py-3 px-2 font-mono",children:h.return_number}),r.jsx("td",{className:"py-3 px-2",children:Ee(h.return_date||h.created_at)}),r.jsx("td",{className:"py-3 px-2",children:(R=h.purchase)==null?void 0:R.invoice_number}),r.jsx("td",{className:"py-3 px-2",children:((P=h.supplier)==null?void 0:P.name_ar)||((U=h.supplier)==null?void 0:U.name)}),r.jsx("td",{className:"py-3 px-2",children:M(h.total_amount||0)}),r.jsx("td",{className:"py-3 px-2",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${Ga[h.status||"draft"].color}`,children:Ga[h.status||"draft"].label})}),r.jsx("td",{className:"py-3 px-2",children:r.jsx(L,{variant:"ghost",size:"icon",onClick:()=>o(h.id),children:r.jsx(Mt,{className:"h-4 w-4"})})})]},h.id)})})]})}),r.jsx("div",{className:"block md:hidden space-y-3",children:b.map(h=>{var R,P,U;return r.jsx(le,{className:"p-4",children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-mono text-sm font-bold",children:h.return_number}),r.jsx("p",{className:"text-xs text-muted-foreground",children:Ee(h.return_date||h.created_at)})]}),r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${Ga[h.status||"draft"].color}`,children:Ga[h.status||"draft"].label})]}),r.jsxs("div",{className:"space-y-1 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:" :"}),r.jsx("span",{className:"font-medium",children:(R=h.purchase)==null?void 0:R.invoice_number})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-medium",children:((P=h.supplier)==null?void 0:P.name_ar)||((U=h.supplier)==null?void 0:U.name)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-bold text-primary",children:M(h.total_amount||0)})]})]}),r.jsxs(L,{variant:"outline",size:"sm",className:"w-full",onClick:()=>o(h.id),children:[r.jsx(Mt,{className:"h-4 w-4 ml-2"})," "]})]})},h.id)})}),r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 mt-4 pt-4 border-t",children:[r.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",(d-1)*f+1,"-",Math.min(d*f,T),"  ",T]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(L,{variant:"outline",size:"sm",onClick:()=>m(h=>Math.max(1,h-1)),disabled:d===1,className:"text-xs sm:text-sm",children:""}),Array.from({length:Math.min(5,N)},(h,R)=>{let P;return N<=5||d<=3?P=R+1:d>=N-2?P=N-4+R:P=d-2+R,r.jsx(L,{variant:d===P?"default":"outline",size:"sm",onClick:()=>m(P),className:"w-8 h-8 sm:w-10 sm:h-10 p-0 text-xs sm:text-sm",children:P},P)}),r.jsx(L,{variant:"outline",size:"sm",onClick:()=>m(h=>Math.min(N,h+1)),disabled:d===N,className:"text-xs sm:text-sm",children:""})]})]})]}):r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:"  "})})]}),r.jsx(et,{open:a,onOpenChange:i,children:r.jsxs(tt,{className:"max-w-[95vw] sm:max-w-6xl max-h-[90vh] overflow-auto",children:[r.jsx(it,{children:r.jsx(lt,{className:"text-base sm:text-lg",children:s==="sales"?"  ":"  "})}),s==="sales"?r.jsx(e2,{onClose:()=>i(!1),onSuccess:()=>i(!1)}):r.jsx(t2,{onClose:()=>i(!1),onSuccess:()=>i(!1)})]})}),l&&r.jsx(et,{open:!!l,onOpenChange:()=>o(null),children:r.jsxs(tt,{className:"max-w-[95vw] sm:max-w-4xl max-h-[90vh] overflow-auto",children:[r.jsx(it,{children:r.jsx(lt,{className:"text-base sm:text-lg",children:" "})}),r.jsx(s2,{returnId:l,returnType:s,onClose:()=>o(null)})]})})]})}function e2({onClose:e,onSuccess:t}){const[s,n]=S.useState(""),[a,i]=S.useState(null),[l,o]=S.useState([]),[c,u]=S.useState([]),[d,m]=S.useState(""),f=ht(),{data:v}=se({queryKey:["return-sales-search",s],queryFn:async()=>{if(!s)return[];const{data:j}=await I.from("sales").select("*, branch:branches(name_ar)").or(`invoice_number.ilike.%${s}%`).eq("status","paid").order("created_at",{ascending:!1}).limit(10);return j||[]},enabled:s.length>0}),g=async j=>{const{data:b}=await I.from("sale_items").select("*, product:products(code, name_ar)").eq("sale_id",j);b&&(o(b),u(b.map(N=>{var T,h;return{id:crypto.randomUUID(),sale_item_id:N.id,product_id:N.product_id,product_name:((T=N.product)==null?void 0:T.name_ar)||"",product_code:((h=N.product)==null?void 0:h.code)||"",original_quantity:N.quantity,return_quantity:0,unit_price:N.unit_price,total:0}})))},w=j=>{i(j),g(j.id),n("")},_=(j,b)=>{u(c.map(N=>{if(N.id===j){const T=Math.max(0,Math.min(b,N.original_quantity));return{...N,return_quantity:T,total:T*N.unit_price}}return N}))},x=c.reduce((j,b)=>j+b.total,0),p=c.filter(j=>j.return_quantity>0).length,y=dt({mutationFn:async()=>{var re,ue;if(!a)throw new Error("  ");const j=c.filter(me=>me.return_quantity>0);if(j.length===0)throw new Error("   ");const{data:b}=await I.from("users").select("id").limit(1),N=(re=b==null?void 0:b[0])==null?void 0:re.id;if(!N)throw new Error("  ");const h={return_number:`SR-${Date.now()}`,return_date:new Date().toISOString(),sale_id:a.id,branch_id:((ue=a.branch)!=null&&ue.name_ar,null),customer_id:null,requested_by:N,total_amount:x,refund_amount:x,status:"pending"},{data:R}=await I.from("sales").select("branch_id, customer_id").eq("id",a.id).single();R&&(h.branch_id=R.branch_id,h.customer_id=R.customer_id);const{data:P,error:U}=await I.from("sales_returns").insert(h).select().single();if(U)throw U;const W=j.map(me=>({return_id:P.id,sale_item_id:me.sale_item_id,product_id:me.product_id,quantity:me.return_quantity,unit_price:me.unit_price,total_price:me.total})),{error:ee}=await I.from("sales_return_items").insert(W);if(ee)throw ee;const oe=h.branch_id;if(oe)for(const me of j){const{data:V}=await I.from("inventory").select("id, quantity").eq("product_id",me.product_id).eq("branch_id",oe).single();V&&await I.from("inventory").update({quantity:(V.quantity||0)+me.return_quantity}).eq("id",V.id)}return P},onSuccess:()=>{alert("   !"),f.invalidateQueries({queryKey:["sales-returns"]}),t()},onError:j=>{alert(" : "+j.message)}});return r.jsx("div",{className:"space-y-4",children:a?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"bg-muted p-4 rounded-md",children:r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-bold text-lg",children:a.invoice_number}),r.jsxs("p",{className:"text-sm text-muted-foreground",children:[Ee(a.invoice_date)," - ",a.customer_name||" "]})]}),r.jsx(L,{variant:"ghost",size:"sm",onClick:()=>{i(null),u([])},children:" "})]})}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium mb-2 block",children:"  ()"}),r.jsx(G,{value:d,onChange:j=>m(j.target.value),placeholder:" ..."})]}),r.jsxs("div",{className:"border rounded-md p-4",children:[r.jsx("h3",{className:"font-medium mb-3",children:""}),r.jsx("div",{className:"space-y-2",children:c.map(j=>r.jsxs("div",{className:"flex items-center gap-2 p-2 bg-muted/50 rounded",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"font-medium text-sm",children:j.product_name}),r.jsxs("p",{className:"text-xs text-muted-foreground",children:[j.product_code," -  : ",j.original_quantity]})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(L,{variant:"outline",size:"icon",className:"h-7 w-7",onClick:()=>_(j.id,j.return_quantity-1),children:r.jsx(Io,{className:"h-3 w-3"})}),r.jsx(G,{type:"number",value:j.return_quantity,onChange:b=>_(j.id,parseInt(b.target.value)||0),className:"w-16 h-8 text-center",min:0,max:j.original_quantity}),r.jsx(L,{variant:"outline",size:"icon",className:"h-7 w-7",onClick:()=>_(j.id,j.return_quantity+1),children:r.jsx(Nt,{className:"h-3 w-3"})})]}),r.jsx("span",{className:"font-bold w-24 text-left",children:M(j.total)})]},j.id))})]}),r.jsxs("div",{className:"border-t pt-4 space-y-2",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"  "}),r.jsx("span",{className:"font-bold",children:p})]}),r.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[r.jsx("span",{children:"  "}),r.jsx("span",{className:"text-primary",children:M(x)})]})]}),r.jsxs("div",{className:"flex gap-2 justify-end pt-4",children:[r.jsx(L,{variant:"outline",onClick:e,children:""}),r.jsxs(L,{onClick:()=>y.mutate(),disabled:y.isPending||p===0,children:[r.jsx(Ei,{className:"h-4 w-4 ml-2"})," "]})]})]}):r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium mb-2 block",children:"  "}),r.jsx(G,{value:s,onChange:j=>n(j.target.value),placeholder:" ...",autoFocus:!0}),v&&v.length>0&&r.jsx("div",{className:"mt-2 border rounded-md max-h-60 overflow-auto",children:v.map(j=>r.jsxs("button",{type:"button",className:"w-full p-3 text-right hover:bg-muted flex justify-between items-center border-b",onClick:()=>w(j),children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:j.invoice_number}),r.jsxs("p",{className:"text-xs text-muted-foreground",children:[Ee(j.invoice_date)," - ",j.customer_name||" "]})]}),r.jsx("p",{className:"font-bold",children:M(j.total_amount||0)})]},j.id))})]})})}function t2({onClose:e,onSuccess:t}){var j,b;const[s,n]=S.useState(""),[a,i]=S.useState(null),[l,o]=S.useState([]),[c,u]=S.useState([]),[d,m]=S.useState(""),f=ht(),{data:v}=se({queryKey:["return-purchases-search",s],queryFn:async()=>{if(!s)return[];const{data:N}=await I.from("purchases").select("*, supplier:suppliers(name, name_ar), branch:branches(name_ar)").or(`invoice_number.ilike.%${s}%,supplier_invoice_number.ilike.%${s}%`).eq("status","received").order("created_at",{ascending:!1}).limit(10);return N||[]},enabled:s.length>0}),g=async N=>{const{data:T}=await I.from("purchase_items").select("*, product:products(code, name_ar)").eq("purchase_id",N);T&&(o(T),u(T.map(h=>{var R,P;return{id:crypto.randomUUID(),purchase_item_id:h.id,product_id:h.product_id,product_name:((R=h.product)==null?void 0:R.name_ar)||"",product_code:((P=h.product)==null?void 0:P.code)||"",original_quantity:h.quantity,return_quantity:0,unit_price:h.unit_price,total:0}})))},w=N=>{i(N),g(N.id),n("")},_=(N,T)=>{u(c.map(h=>{if(h.id===N){const R=Math.max(0,Math.min(T,h.original_quantity));return{...h,return_quantity:R,total:R*h.unit_price}}return h}))},x=c.reduce((N,T)=>N+T.total,0),p=c.filter(N=>N.return_quantity>0).length,y=dt({mutationFn:async()=>{if(!a)throw new Error("   ");const N=c.filter(re=>re.return_quantity>0);if(N.length===0)throw new Error("   ");const T=`PR-${Date.now()}`,{data:h}=await I.from("purchases").select("branch_id, supplier_id").eq("id",a.id).single();if(!h)throw new Error("   ");const R={return_number:T,return_date:new Date().toISOString(),purchase_id:a.id,branch_id:h.branch_id,supplier_id:h.supplier_id,total_amount:x,credit_amount:x,status:"draft"},{data:P,error:U}=await I.from("purchase_returns").insert(R).select().single();if(U)throw U;const W=N.map(re=>({purchase_return_id:P.id,purchase_item_id:re.purchase_item_id,product_id:re.product_id,quantity:re.return_quantity,unit_price:re.unit_price,total_price:re.total})),{error:ee}=await I.from("purchase_return_items").insert(W);if(ee)throw ee;const oe=h.branch_id;for(const re of N){const{data:ue}=await I.from("inventory").select("id, quantity").eq("product_id",re.product_id).eq("branch_id",oe).single();ue&&await I.from("inventory").update({quantity:Math.max(0,(ue.quantity||0)-re.return_quantity)}).eq("id",ue.id)}return P},onSuccess:()=>{alert("    !"),f.invalidateQueries({queryKey:["purchase-returns"]}),t()},onError:N=>{alert(" : "+N.message)}});return r.jsx("div",{className:"space-y-4",children:a?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"bg-muted p-4 rounded-md",children:r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-bold text-lg",children:a.invoice_number}),r.jsxs("p",{className:"text-sm text-muted-foreground",children:[Ee(a.invoice_date)," - ",((j=a.supplier)==null?void 0:j.name_ar)||((b=a.supplier)==null?void 0:b.name)]}),a.supplier_invoice_number&&r.jsxs("p",{className:"text-xs text-muted-foreground",children:[" : ",a.supplier_invoice_number]})]}),r.jsx(L,{variant:"ghost",size:"sm",onClick:()=>{i(null),u([])},children:" "})]})}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium mb-2 block",children:"  ()"}),r.jsx(G,{value:d,onChange:N=>m(N.target.value),placeholder:"  ..."})]}),r.jsxs("div",{className:"border rounded-md p-4",children:[r.jsx("h3",{className:"font-medium mb-3",children:""}),r.jsx("div",{className:"space-y-2",children:c.map(N=>r.jsxs("div",{className:"flex items-center gap-2 p-2 bg-muted/50 rounded",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"font-medium text-sm",children:N.product_name}),r.jsxs("p",{className:"text-xs text-muted-foreground",children:[N.product_code," -  : ",N.original_quantity]})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(L,{variant:"outline",size:"icon",className:"h-7 w-7",onClick:()=>_(N.id,N.return_quantity-1),children:r.jsx(Io,{className:"h-3 w-3"})}),r.jsx(G,{type:"number",value:N.return_quantity,onChange:T=>_(N.id,parseInt(T.target.value)||0),className:"w-16 h-8 text-center",min:0,max:N.original_quantity}),r.jsx(L,{variant:"outline",size:"icon",className:"h-7 w-7",onClick:()=>_(N.id,N.return_quantity+1),children:r.jsx(Nt,{className:"h-3 w-3"})})]}),r.jsx("span",{className:"font-bold w-24 text-left",children:M(N.total)})]},N.id))})]}),r.jsxs("div",{className:"border-t pt-4 space-y-2",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"  "}),r.jsx("span",{className:"font-bold",children:p})]}),r.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[r.jsx("span",{children:"  "}),r.jsx("span",{className:"text-primary",children:M(x)})]})]}),r.jsxs("div",{className:"flex gap-2 justify-end pt-4",children:[r.jsx(L,{variant:"outline",onClick:e,children:""}),r.jsxs(L,{onClick:()=>y.mutate(),disabled:y.isPending||p===0,children:[r.jsx(Ei,{className:"h-4 w-4 ml-2"})," "]})]})]}):r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium mb-2 block",children:"   "}),r.jsx(G,{value:s,onChange:N=>n(N.target.value),placeholder:"     ...",autoFocus:!0}),v&&v.length>0&&r.jsx("div",{className:"mt-2 border rounded-md max-h-60 overflow-auto",children:v.map(N=>{var T,h;return r.jsxs("button",{type:"button",className:"w-full p-3 text-right hover:bg-muted flex justify-between items-center border-b",onClick:()=>w(N),children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:N.invoice_number}),r.jsxs("p",{className:"text-xs text-muted-foreground",children:[Ee(N.invoice_date)," - ",((T=N.supplier)==null?void 0:T.name_ar)||((h=N.supplier)==null?void 0:h.name)]}),N.supplier_invoice_number&&r.jsxs("p",{className:"text-xs text-muted-foreground",children:[" : ",N.supplier_invoice_number]})]}),r.jsx("p",{className:"font-bold",children:M(N.total_amount||0)})]},N.id)})})]})})}function s2({returnId:e,returnType:t,onClose:s}){var c,u,d,m,f;const n=t==="sales"?"sales_returns":"purchase_returns",a=t==="sales"?"sales_return_items":"purchase_return_items",{data:i}=se({queryKey:["return-details",e,t],queryFn:async()=>{const{data:v}=await I.from(n).select(`
          *,
          ${t==="sales"?"sale:sales(invoice_number), customer:customers(name_ar, phone)":"purchase:purchases(invoice_number), supplier:suppliers(name_ar, phone)"},
          branch:branches(name_ar)
        `).eq("id",e).single();return v}}),{data:l}=se({queryKey:["return-items",e,t],queryFn:async()=>{const{data:v}=await I.from(a).select(`
          *,
          product:products(code, name_ar)
        `).eq("return_id",e);return v}});if(!i)return r.jsx("div",{className:"text-center py-8",children:" ..."});const o=t==="sales"?Qa:Ga;return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4 p-4 bg-muted rounded-md",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:"font-bold",children:i.return_number})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:""}),r.jsx("p",{className:"font-bold",children:Ee(i.return_date)})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:t==="sales"?" ":"  "}),r.jsx("p",{className:"font-bold",children:t==="sales"?(c=i.sale)==null?void 0:c.invoice_number:(u=i.purchase)==null?void 0:u.invoice_number})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:t==="sales"?"":""}),r.jsx("p",{className:"font-bold",children:t==="sales"?((d=i.customer)==null?void 0:d.name_ar)||" ":(m=i.supplier)==null?void 0:m.name_ar})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:""}),r.jsx("p",{className:"font-bold",children:(f=i.branch)==null?void 0:f.name_ar})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:""}),r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${o[i.status||"pending"].color}`,children:o[i.status||"pending"].label})]})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-bold mb-3",children:" "}),r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b",children:[r.jsx("th",{className:"text-right py-2",children:""}),r.jsx("th",{className:"text-right py-2",children:""}),r.jsx("th",{className:"text-center py-2",children:""}),r.jsx("th",{className:"text-right py-2",children:""}),r.jsx("th",{className:"text-right py-2",children:""})]})}),r.jsx("tbody",{children:l==null?void 0:l.map(v=>{var g,w;return r.jsxs("tr",{className:"border-b",children:[r.jsx("td",{className:"py-2",children:(g=v.product)==null?void 0:g.code}),r.jsx("td",{className:"py-2",children:(w=v.product)==null?void 0:w.name_ar}),r.jsx("td",{className:"py-2 text-center",children:v.quantity}),r.jsx("td",{className:"py-2",children:M(v.unit_price)}),r.jsx("td",{className:"py-2",children:M(v.total_price)})]},v.id)})})]})]}),r.jsxs("div",{className:"border-t pt-4 space-y-2",children:[r.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[r.jsx("span",{children:"  "}),r.jsx("span",{className:"text-primary",children:M(i.total_amount||0)})]}),t==="sales"&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:" "}),r.jsx("span",{className:"font-bold text-green-600",children:M(i.refund_amount||0)})]}),t==="purchases"&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:" "}),r.jsx("span",{className:"font-bold text-green-600",children:M(i.credit_amount||0)})]})]}),r.jsx("div",{className:"flex justify-end pt-4",children:r.jsx(L,{onClick:s,children:""})})]})}const Pn={pending:{label:"  ",color:"bg-yellow-100 text-yellow-700"},approved:{label:" ",color:"bg-blue-100 text-blue-700"},rejected:{label:"",color:"bg-red-100 text-red-700"},preparing:{label:" ",color:"bg-purple-100 text-purple-700"},in_transit:{label:" ",color:"bg-orange-100 text-orange-700"},partially_received:{label:" ",color:"bg-orange-100 text-orange-700"},received:{label:" ",color:"bg-green-100 text-green-700"},completed:{label:"",color:"bg-green-100 text-green-700"},cancelled:{label:"",color:"bg-gray-100 text-gray-700"}};function r2(){var Y,Z;const[e,t]=S.useState(""),[s,n]=S.useState(!1),[a,i]=S.useState(!1),[l,o]=S.useState(null),[c,u]=S.useState(""),[d,m]=S.useState(""),[f,v]=S.useState([]),[g,w]=S.useState(""),[_,x]=S.useState(1),[p,y]=S.useState(1),j=10,b=ht(),{data:N,isLoading:T}=se({queryKey:["transfers",e,p],queryFn:async()=>{let O=I.from("stock_transfers").select("*",{count:"exact",head:!0});e&&(O=O.ilike("transfer_number",`%${e}%`));const{count:C}=await O;let B=I.from("stock_transfers").select("*, from_branch:branches!stock_transfers_from_branch_id_fkey(name_ar), to_branch:branches!stock_transfers_to_branch_id_fkey(name_ar)").order("created_at",{ascending:!1});e&&(B=B.ilike("transfer_number",`%${e}%`));const K=(p-1)*j,ce=K+j-1,{data:Q}=await B.range(K,ce);return{transfers:Q||[],totalCount:C||0,totalPages:Math.ceil((C||0)/j)}}}),h=(N==null?void 0:N.transfers)||[],R=(N==null?void 0:N.totalPages)||1,P=(N==null?void 0:N.totalCount)||0;is.useEffect(()=>{y(1)},[e]);const{data:U}=se({queryKey:["branches-list"],queryFn:async()=>{const{data:O}=await I.from("branches").select("id, name_ar").eq("status","active");return O||[]}}),{data:W}=se({queryKey:["products-list"],queryFn:async()=>{const{data:O}=await I.from("products").select("id, code, name_ar, selling_price").eq("status","active");return O||[]}}),ee=dt({mutationFn:async()=>{const{data:O}=await I.from("users").select("id").limit(1).single(),C=`TRF-${Date.now()}`,B=f.reduce((Q,ge)=>Q+ge.quantity*ge.unit_cost,0),{data:K,error:ce}=await I.from("stock_transfers").insert({transfer_number:C,transfer_date:new Date().toISOString(),from_branch_id:c,to_branch_id:d,total_items:f.length,total_value:B,status:"completed",requested_by:O==null?void 0:O.id,approved_by:O==null?void 0:O.id}).select().single();if(ce)throw ce;for(const Q of f){await I.from("stock_transfer_items").insert({transfer_id:K.id,product_id:Q.product_id,requested_quantity:Q.quantity,approved_quantity:Q.quantity,shipped_quantity:Q.quantity,received_quantity:Q.quantity,unit_cost:Q.unit_cost,total_value:Q.quantity*Q.unit_cost});const{data:ge}=await I.from("inventory").select("id, quantity").eq("product_id",Q.product_id).eq("branch_id",c).single();if(ge){const A=ge;await I.from("inventory").update({quantity:(A.quantity||0)-Q.quantity}).eq("id",A.id)}const{data:Me}=await I.from("inventory").select("id, quantity").eq("product_id",Q.product_id).eq("branch_id",d).single();if(Me){const A=Me;await I.from("inventory").update({quantity:(A.quantity||0)+Q.quantity}).eq("id",A.id)}else await I.from("inventory").insert({product_id:Q.product_id,branch_id:d,quantity:Q.quantity,avg_cost:Q.unit_cost})}return K},onSuccess:()=>{b.invalidateQueries({queryKey:["transfers"]}),b.invalidateQueries({queryKey:["inventory"]}),n(!1),oe(),alert("   !")},onError:O=>alert(": "+O.message)}),oe=()=>{u(""),m(""),v([]),w(""),x(1)},re=()=>{const O=W==null?void 0:W.find(C=>C.id===g);!O||_<=0||(v([...f,{product_id:O.id,product_name:O.name_ar,quantity:_,unit_cost:O.selling_price||0}]),w(""),x(1))},ue=O=>v(f.filter((C,B)=>B!==O)),{data:me}=se({queryKey:["transfer-items",l==null?void 0:l.id],queryFn:async()=>{if(!(l!=null&&l.id))return[];const{data:O}=await I.from("stock_transfer_items").select("*, product:products(name_ar, code)").eq("transfer_id",l.id);return O||[]},enabled:!!(l!=null&&l.id)&&a}),V=O=>{o(O),i(!0)};return r.jsxs("div",{className:"p-3 md:p-6 space-y-4 md:space-y-6",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl md:text-2xl font-bold",children:" "}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"    "})]}),r.jsxs(L,{onClick:()=>n(!0),className:"w-full sm:w-auto",children:[r.jsx(Nt,{className:"h-4 w-4 ml-2"}),r.jsx("span",{className:"hidden sm:inline",children:" "}),r.jsx("span",{className:"sm:hidden",children:""})]})]}),r.jsx(et,{open:s,onOpenChange:n,children:r.jsxs(tt,{onClose:()=>n(!1),className:"max-w-[95vw] sm:max-w-2xl max-h-[90vh] overflow-auto",children:[r.jsx(it,{children:r.jsx(lt,{className:"text-base sm:text-lg",children:"  "})}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"from-branch",className:"text-sm font-medium",children:"  *"}),r.jsxs("select",{id:"from-branch",title:" ",className:"w-full h-10 border rounded-md px-3",value:c,onChange:O=>u(O.target.value),children:[r.jsx("option",{value:"",children:" "}),U==null?void 0:U.filter(O=>O.id!==d).map(O=>r.jsx("option",{value:O.id,children:O.name_ar},O.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"to-branch",className:"text-sm font-medium",children:"  *"}),r.jsxs("select",{id:"to-branch",title:" ",className:"w-full h-10 border rounded-md px-3",value:d,onChange:O=>m(O.target.value),children:[r.jsx("option",{value:"",children:" "}),U==null?void 0:U.filter(O=>O.id!==c).map(O=>r.jsx("option",{value:O.id,children:O.name_ar},O.id))]})]})]}),r.jsxs("div",{className:"border rounded-md p-4",children:[r.jsx("h4",{className:"font-medium mb-3",children:" "}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("select",{title:"",className:"flex-1 h-10 border rounded-md px-3",value:g,onChange:O=>w(O.target.value),children:[r.jsx("option",{value:"",children:" "}),W==null?void 0:W.map(O=>r.jsxs("option",{value:O.id,children:[O.code," - ",O.name_ar]},O.id))]}),r.jsx(G,{type:"number",value:_,onChange:O=>x(parseInt(O.target.value)||1),className:"w-24",min:1,placeholder:""}),r.jsx(L,{type:"button",onClick:re,children:""})]})]}),f.length>0&&r.jsx("div",{className:"border rounded-md",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b bg-muted/50",children:[r.jsx("th",{className:"text-right py-2 px-3",children:""}),r.jsx("th",{className:"text-right py-2 px-3",children:""}),r.jsx("th",{className:"text-right py-2 px-3",children:""}),r.jsx("th",{className:"py-2 px-3"})]})}),r.jsx("tbody",{children:f.map((O,C)=>r.jsxs("tr",{className:"border-b",children:[r.jsx("td",{className:"py-2 px-3",children:O.product_name}),r.jsx("td",{className:"py-2 px-3",children:O.quantity}),r.jsx("td",{className:"py-2 px-3",children:M(O.quantity*O.unit_cost)}),r.jsx("td",{className:"py-2 px-3",children:r.jsx(L,{type:"button",variant:"ghost",size:"icon",onClick:()=>ue(C),children:r.jsx(sh,{className:"h-4 w-4 text-destructive"})})})]},C))})]})})]}),r.jsxs(js,{children:[r.jsx(L,{variant:"outline",onClick:()=>n(!1),children:""}),r.jsx(L,{onClick:()=>ee.mutate(),disabled:!c||!d||f.length===0||ee.isPending,children:ee.isPending?" ...":" "})]})]})}),r.jsx(et,{open:a,onOpenChange:i,children:r.jsxs(tt,{onClose:()=>i(!1),className:"max-w-[95vw] sm:max-w-2xl max-h-[90vh] overflow-auto",children:[r.jsx(it,{children:r.jsxs(lt,{className:"text-base sm:text-lg",children:["  - ",l==null?void 0:l.transfer_number]})}),l&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4 p-4 bg-muted/50 rounded-lg",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:"font-medium",children:(Y=l.from_branch)==null?void 0:Y.name_ar})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:"font-medium",children:(Z=l.to_branch)==null?void 0:Z.name_ar})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:""}),r.jsx("p",{className:"font-medium",children:Ee(l.transfer_date||l.created_at)})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:""}),r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${Pn[l.status||"pending"].color}`,children:Pn[l.status||"pending"].label})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:"font-medium",children:l.total_items||0})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:"font-medium",children:M(l.total_value||0)})]})]}),r.jsxs("div",{className:"border rounded-md",children:[r.jsx("h4",{className:"font-medium p-3 border-b bg-muted/30",children:" "}),r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b bg-muted/50",children:[r.jsx("th",{className:"text-right py-2 px-3",children:""}),r.jsx("th",{className:"text-right py-2 px-3",children:""}),r.jsx("th",{className:"text-right py-2 px-3",children:" "}),r.jsx("th",{className:"text-right py-2 px-3",children:""})]})}),r.jsxs("tbody",{children:[me==null?void 0:me.map(O=>{var C,B;return r.jsxs("tr",{className:"border-b",children:[r.jsxs("td",{className:"py-2 px-3",children:[(C=O.product)==null?void 0:C.code," - ",(B=O.product)==null?void 0:B.name_ar]}),r.jsx("td",{className:"py-2 px-3",children:O.received_quantity||0}),r.jsx("td",{className:"py-2 px-3",children:M(O.unit_cost||0)}),r.jsx("td",{className:"py-2 px-3",children:M(O.total_value||0)})]},O.id)}),(!me||me.length===0)&&r.jsx("tr",{children:r.jsx("td",{colSpan:4,className:"py-4 text-center text-muted-foreground",children:"  "})})]})]})]})]}),r.jsx(js,{children:r.jsx(L,{variant:"outline",onClick:()=>i(!1),children:""})})]})}),r.jsxs(le,{children:[r.jsx(Se,{children:r.jsxs("div",{className:"relative flex-1 max-w-sm",children:[r.jsx(Os,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),r.jsx(G,{placeholder:"  ...",value:e,onChange:O=>t(O.target.value),className:"pr-10"})]})}),r.jsx(Ce,{children:T?r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:" ..."}):h!=null&&h.length?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"mb-4 text-xs sm:text-sm text-muted-foreground",children:[" ",(p-1)*j+1," - ",Math.min(p*j,P),"  ",P," "]}),r.jsx("div",{className:"block md:hidden space-y-3",children:h.map(O=>{var C,B;return r.jsx(le,{className:"p-3",children:r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-bold text-sm font-mono",children:O.transfer_number}),r.jsx("p",{className:"text-xs text-muted-foreground",children:Ee(O.transfer_date||O.created_at)})]}),r.jsx(L,{variant:"ghost",size:"sm",onClick:()=>V(O),children:r.jsx(Mt,{className:"h-4 w-4"})})]}),r.jsxs("div",{className:"space-y-1 text-xs",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-medium",children:(C=O.from_branch)==null?void 0:C.name_ar})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(io,{className:"h-3 w-3 text-muted-foreground"}),r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-medium",children:(B=O.to_branch)==null?void 0:B.name_ar})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:": "}),r.jsx("span",{className:"font-medium",children:O.total_items||0})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:": "}),r.jsx("span",{className:"font-bold",children:M(O.total_value||0)})]})]})]}),r.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs ${Pn[O.status||"pending"].color}`,children:Pn[O.status||"pending"].label})]})},O.id)})}),r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b",children:[r.jsx("th",{className:"text-right py-3 px-2",children:" "}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:" "}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""})]})}),r.jsx("tbody",{children:h.map(O=>{var C,B;return r.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[r.jsx("td",{className:"py-3 px-2 font-mono",children:O.transfer_number}),r.jsx("td",{className:"py-3 px-2",children:Ee(O.transfer_date||O.created_at)}),r.jsx("td",{className:"py-3 px-2",children:(C=O.from_branch)==null?void 0:C.name_ar}),r.jsx("td",{className:"py-3 px-2",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(io,{className:"h-4 w-4 text-muted-foreground"}),(B=O.to_branch)==null?void 0:B.name_ar]})}),r.jsx("td",{className:"py-3 px-2",children:O.total_items||0}),r.jsx("td",{className:"py-3 px-2",children:M(O.total_value||0)}),r.jsx("td",{className:"py-3 px-2",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${Pn[O.status||"pending"].color}`,children:Pn[O.status||"pending"].label})}),r.jsx("td",{className:"py-3 px-2",children:r.jsx(L,{variant:"ghost",size:"icon",title:"",onClick:()=>V(O),children:r.jsx(Mt,{className:"h-4 w-4"})})})]},O.id)})})]})}),R>1&&r.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t gap-2",children:[r.jsx(L,{variant:"outline",size:"sm",onClick:()=>y(O=>Math.max(1,O-1)),disabled:p===1,className:"text-xs sm:text-sm",children:""}),r.jsx("div",{className:"flex items-center gap-1 sm:gap-2",children:Array.from({length:Math.min(5,R)},(O,C)=>{let B=R<=5||p<=3?C+1:p>=R-2?R-4+C:p-2+C;return r.jsx(L,{variant:p===B?"default":"outline",size:"sm",onClick:()=>y(B),className:"w-8 h-8 sm:w-10 sm:h-10 p-0 text-xs sm:text-sm",children:B},B)})}),r.jsx(L,{variant:"outline",size:"sm",onClick:()=>y(O=>Math.min(R,O+1)),disabled:p===R,className:"text-xs sm:text-sm",children:""})]})]}):r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:"  "})})]})]})}const Tn={discovered:{label:" ",color:"bg-yellow-100 text-yellow-700"},reported:{label:" ",color:"bg-blue-100 text-blue-700"},approved:{label:" ",color:"bg-green-100 text-green-700"},completed:{label:"",color:"bg-green-100 text-green-700"}},vl={physical_damage:" ",water_damage:"  ",expired:" ",manufacturing_defect:" ",storage_damage:"  ",transit_damage:"  ",other:""};function n2(){var Me,A,D,q;const[e,t]=S.useState(""),[s,n]=S.useState("damaged"),[a,i]=S.useState(!1),[l,o]=S.useState(!1),[c,u]=S.useState(null),[d,m]=S.useState(null),[f,v]=S.useState(""),[g,w]=S.useState(""),[_,x]=S.useState(1),[p,y]=S.useState("physical_damage"),[j,b]=S.useState(""),[N,T]=S.useState(1),[h,R]=S.useState(1),P=10,U=ht(),{data:W,isLoading:ee}=se({queryKey:["damaged-items",e,N],queryFn:async()=>{let k=I.from("damaged_items").select("*",{count:"exact",head:!0});e&&(k=k.ilike("damage_number",`%${e}%`));const{count:$}=await k;let z=I.from("damaged_items").select("*, product:products(code, name, name_ar), branch:branches(name_ar)").order("created_at",{ascending:!1});e&&(z=z.ilike("damage_number",`%${e}%`));const J=(N-1)*P,xe=J+P-1,{data:Re}=await z.range(J,xe);return{items:Re||[],totalCount:$||0,totalPages:Math.ceil(($||0)/P)}},enabled:s==="damaged"}),{data:oe,isLoading:re}=se({queryKey:["write-offs",e,h],queryFn:async()=>{let k=I.from("write_offs").select("*",{count:"exact",head:!0});e&&(k=k.ilike("writeoff_number",`%${e}%`));const{count:$}=await k;let z=I.from("write_offs").select("*, branch:branches(name_ar)").order("created_at",{ascending:!1});e&&(z=z.ilike("writeoff_number",`%${e}%`));const J=(h-1)*P,xe=J+P-1,{data:Re}=await z.range(J,xe);return{items:Re||[],totalCount:$||0,totalPages:Math.ceil(($||0)/P)}},enabled:s==="writeoffs"}),ue=(W==null?void 0:W.items)||[],me=(W==null?void 0:W.totalPages)||1,V=(W==null?void 0:W.totalCount)||0,Y=(oe==null?void 0:oe.items)||[],Z=(oe==null?void 0:oe.totalPages)||1,O=(oe==null?void 0:oe.totalCount)||0;is.useEffect(()=>{T(1),R(1)},[e]);const{data:C}=se({queryKey:["branches-list"],queryFn:async()=>{const{data:k}=await I.from("branches").select("id, name_ar").eq("status","active");return k||[]}}),{data:B}=se({queryKey:["products-list"],queryFn:async()=>{const{data:k}=await I.from("products").select("id, code, name_ar, purchase_price").eq("status","active");return k||[]}}),K=dt({mutationFn:async()=>{const{data:k}=await I.from("users").select("id").limit(1).single(),$=k?k.id:null,z=B==null?void 0:B.find(ae=>ae.id===g);if(!z)throw new Error("  ");const J=`DMG-${Date.now()}`,xe=_*(z.purchase_price||0),{error:Re}=await I.from("damaged_items").insert({damage_number:J,damage_date:new Date().toISOString(),product_id:g,branch_id:f,quantity:_,damage_type:p,unit_cost:z.purchase_price||0,total_cost:xe,status:"approved",discovered_by:$,reported_by:$,approved_by:$,notes:j});if(Re)throw Re;const{data:De}=await I.from("inventory").select("id, quantity").eq("product_id",g).eq("branch_id",f).single();if(De){const ae=De;await I.from("inventory").update({quantity:Math.max(0,(ae.quantity||0)-_)}).eq("id",ae.id)}},onSuccess:()=>{U.invalidateQueries({queryKey:["damaged-items"]}),U.invalidateQueries({queryKey:["inventory"]}),i(!1),ce(),alert("     !")},onError:k=>alert(": "+k.message)}),ce=()=>{v(""),w(""),x(1),y("physical_damage"),b("")},Q=k=>{u(k),m(null),o(!0)},ge=k=>{m(k),u(null),o(!0)};return r.jsxs("div",{className:"p-3 md:p-6 space-y-4 md:space-y-6",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl md:text-2xl font-bold",children:" "}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"    "})]}),r.jsx("div",{className:"flex gap-2 w-full sm:w-auto",children:r.jsxs(L,{onClick:()=>i(!0),className:"flex-1 sm:flex-none",children:[r.jsx(Nt,{className:"h-4 w-4 ml-2"}),r.jsx("span",{className:"hidden sm:inline",children:" "}),r.jsx("span",{className:"sm:hidden",children:""})]})})]}),r.jsx(et,{open:a,onOpenChange:i,children:r.jsxs(tt,{onClose:()=>i(!1),className:"max-w-[95vw] sm:max-w-lg max-h-[90vh] overflow-y-auto",children:[r.jsx(it,{children:r.jsx(lt,{className:"text-base sm:text-lg",children:"  "})}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"branch",className:"text-sm font-medium",children:" *"}),r.jsxs("select",{id:"branch",title:"",className:"w-full h-10 border rounded-md px-3",value:f,onChange:k=>v(k.target.value),children:[r.jsx("option",{value:"",children:" "}),C==null?void 0:C.map(k=>r.jsx("option",{value:k.id,children:k.name_ar},k.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"product",className:"text-sm font-medium",children:" *"}),r.jsxs("select",{id:"product",title:"",className:"w-full h-10 border rounded-md px-3",value:g,onChange:k=>w(k.target.value),children:[r.jsx("option",{value:"",children:" "}),B==null?void 0:B.map(k=>r.jsxs("option",{value:k.id,children:[k.code," - ",k.name_ar]},k.id))]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"quantity",className:"text-sm font-medium",children:" *"}),r.jsx(G,{id:"quantity",type:"number",value:_,min:1,onChange:k=>x(parseInt(k.target.value)||1)})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"damage-type",className:"text-sm font-medium",children:"  *"}),r.jsx("select",{id:"damage-type",title:" ",className:"w-full h-10 border rounded-md px-3",value:p,onChange:k=>y(k.target.value),children:Object.entries(vl).map(([k,$])=>r.jsx("option",{value:k,children:$},k))})]})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"notes",className:"text-sm font-medium",children:""}),r.jsx(G,{id:"notes",value:j,onChange:k=>b(k.target.value),placeholder:"  ..."})]})]}),r.jsxs(js,{children:[r.jsx(L,{variant:"outline",onClick:()=>i(!1),children:""}),r.jsx(L,{onClick:()=>K.mutate(),disabled:!f||!g||_<=0||K.isPending,children:K.isPending?" ...":""})]})]})}),r.jsx(et,{open:l,onOpenChange:o,children:r.jsxs(tt,{onClose:()=>o(!1),className:"max-w-[95vw] sm:max-w-lg max-h-[90vh] overflow-y-auto",children:[r.jsx(it,{children:r.jsx(lt,{className:"text-base sm:text-lg",children:c?`  - ${c.damage_number}`:d?`  - ${d.writeoff_number}`:""})}),c&&r.jsx("div",{className:"space-y-4",children:r.jsxs("div",{className:"grid grid-cols-2 gap-4 p-4 bg-muted/50 rounded-lg",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:""}),r.jsx("p",{className:"font-medium",children:((Me=c.product)==null?void 0:Me.name_ar)||((A=c.product)==null?void 0:A.name)})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:""}),r.jsx("p",{className:"font-medium",children:(D=c.branch)==null?void 0:D.name_ar})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:""}),r.jsx("p",{className:"font-medium",children:Ee(c.damage_date||c.created_at)})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:""}),r.jsx("p",{className:"font-medium",children:c.quantity})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:"font-medium",children:vl[c.damage_type||"other"]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:""}),r.jsx("p",{className:"font-medium",children:M(c.total_cost||0)})]}),r.jsxs("div",{className:"col-span-2",children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:""}),r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${Tn[c.status||"discovered"].color}`,children:Tn[c.status||"discovered"].label})]})]})}),d&&r.jsx("div",{className:"space-y-4",children:r.jsxs("div",{className:"grid grid-cols-2 gap-4 p-4 bg-muted/50 rounded-lg",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:""}),r.jsx("p",{className:"font-medium",children:(q=d.branch)==null?void 0:q.name_ar})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:""}),r.jsx("p",{className:"font-medium",children:Ee(d.writeoff_date||d.created_at)})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:""}),r.jsx("p",{className:"font-medium",children:d.writeoff_reason||"-"})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:"font-medium",children:d.total_items||0})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:"font-medium",children:M(d.total_value||0)})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:""}),r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${d.status==="completed"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:d.status==="completed"?"":""})]})]})}),r.jsx(js,{children:r.jsx(L,{variant:"outline",onClick:()=>o(!1),children:""})})]})}),r.jsx("div",{className:"flex gap-2 border-b",children:r.jsxs("button",{type:"button",onClick:()=>n("damaged"),className:`flex items-center gap-2 px-4 py-2 border-b-2 transition-colors ${s==="damaged"?"border-primary text-primary":"border-transparent hover:text-primary"}`,children:[r.jsx(gn,{className:"h-4 w-4"})," "]})}),r.jsxs(le,{children:[r.jsx(Se,{children:r.jsxs("div",{className:"relative flex-1 max-w-sm",children:[r.jsx(Os,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),r.jsx(G,{placeholder:"...",value:e,onChange:k=>t(k.target.value),className:"pr-10"})]})}),r.jsx(Ce,{children:s==="damaged"?ee?r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:" ..."}):ue!=null&&ue.length?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b",children:[r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:" "}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""})]})}),r.jsx("tbody",{children:ue.map(k=>{var $,z,J;return r.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[r.jsx("td",{className:"py-3 px-2 font-mono",children:k.damage_number}),r.jsx("td",{className:"py-3 px-2",children:Ee(k.damage_date||k.created_at)}),r.jsx("td",{className:"py-3 px-2",children:(($=k.product)==null?void 0:$.name_ar)||((z=k.product)==null?void 0:z.name)}),r.jsx("td",{className:"py-3 px-2",children:(J=k.branch)==null?void 0:J.name_ar}),r.jsx("td",{className:"py-3 px-2",children:k.quantity}),r.jsx("td",{className:"py-3 px-2",children:vl[k.damage_type||"other"]}),r.jsx("td",{className:"py-3 px-2",children:M(k.total_cost||0)}),r.jsx("td",{className:"py-3 px-2",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${Tn[k.status||"discovered"].color}`,children:Tn[k.status||"discovered"].label})}),r.jsx("td",{className:"py-3 px-2",children:r.jsx(L,{variant:"ghost",size:"icon",title:"",onClick:()=>Q(k),children:r.jsx(Mt,{className:"h-4 w-4"})})})]},k.id)})})]})}),r.jsx("div",{className:"block md:hidden space-y-3",children:ue.map(k=>{var $,z,J;return r.jsx(le,{className:"p-4",children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-mono text-sm font-bold",children:k.damage_number}),r.jsx("p",{className:"text-xs text-muted-foreground",children:Ee(k.damage_date||k.created_at)})]}),r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${Tn[k.status||"discovered"].color}`,children:Tn[k.status||"discovered"].label})]}),r.jsxs("div",{className:"space-y-1 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-medium",children:(($=k.product)==null?void 0:$.name_ar)||((z=k.product)==null?void 0:z.name)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-medium",children:(J=k.branch)==null?void 0:J.name_ar})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-medium",children:k.quantity})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:" :"}),r.jsx("span",{className:"font-medium",children:vl[k.damage_type||"other"]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-bold text-destructive",children:M(k.total_cost||0)})]})]}),r.jsxs(L,{variant:"outline",size:"sm",className:"w-full",onClick:()=>Q(k),children:[r.jsx(Mt,{className:"h-4 w-4 ml-2"})," "]})]})},k.id)})}),r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 mt-4 pt-4 border-t",children:[r.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",(N-1)*P+1,"-",Math.min(N*P,V),"  ",V]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(L,{variant:"outline",size:"sm",onClick:()=>T(k=>Math.max(1,k-1)),disabled:N===1,className:"text-xs sm:text-sm",children:""}),Array.from({length:Math.min(5,me)},(k,$)=>{let z;return me<=5||N<=3?z=$+1:N>=me-2?z=me-4+$:z=N-2+$,r.jsx(L,{variant:N===z?"default":"outline",size:"sm",onClick:()=>T(z),className:"w-8 h-8 sm:w-10 sm:h-10 p-0 text-xs sm:text-sm",children:z},z)}),r.jsx(L,{variant:"outline",size:"sm",onClick:()=>T(k=>Math.min(me,k+1)),disabled:N===me,className:"text-xs sm:text-sm",children:""})]})]})]}):r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:"   "}):re?r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:" ..."}):Y!=null&&Y.length?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b",children:[r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:" "}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""})]})}),r.jsx("tbody",{children:Y.map(k=>{var $;return r.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[r.jsx("td",{className:"py-3 px-2 font-mono",children:k.writeoff_number}),r.jsx("td",{className:"py-3 px-2",children:Ee(k.writeoff_date||k.created_at)}),r.jsx("td",{className:"py-3 px-2",children:($=k.branch)==null?void 0:$.name_ar}),r.jsx("td",{className:"py-3 px-2",children:k.writeoff_reason}),r.jsx("td",{className:"py-3 px-2",children:k.total_items||0}),r.jsx("td",{className:"py-3 px-2",children:M(k.total_value||0)}),r.jsx("td",{className:"py-3 px-2",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${k.status==="completed"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:k.status==="completed"?"":""})}),r.jsx("td",{className:"py-3 px-2",children:r.jsx(L,{variant:"ghost",size:"icon",title:"",onClick:()=>ge(k),children:r.jsx(Mt,{className:"h-4 w-4"})})})]},k.id)})})]})}),r.jsx("div",{className:"block md:hidden space-y-3",children:Y.map(k=>{var $;return r.jsx(le,{className:"p-4",children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-mono text-sm font-bold",children:k.writeoff_number}),r.jsx("p",{className:"text-xs text-muted-foreground",children:Ee(k.writeoff_date||k.created_at)})]}),r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${k.status==="completed"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:k.status==="completed"?"":""})]}),r.jsxs("div",{className:"space-y-1 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-medium",children:($=k.branch)==null?void 0:$.name_ar})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-medium",children:k.writeoff_reason})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:" :"}),r.jsx("span",{className:"font-medium",children:k.total_items||0})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-bold text-destructive",children:M(k.total_value||0)})]})]}),r.jsxs(L,{variant:"outline",size:"sm",className:"w-full",onClick:()=>ge(k),children:[r.jsx(Mt,{className:"h-4 w-4 ml-2"})," "]})]})},k.id)})}),r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 mt-4 pt-4 border-t",children:[r.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",(h-1)*P+1,"-",Math.min(h*P,O),"  ",O]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(L,{variant:"outline",size:"sm",onClick:()=>R(k=>Math.max(1,k-1)),disabled:h===1,className:"text-xs sm:text-sm",children:""}),Array.from({length:Math.min(5,Z)},(k,$)=>{let z;return Z<=5||h<=3?z=$+1:h>=Z-2?z=Z-4+$:z=h-2+$,r.jsx(L,{variant:h===z?"default":"outline",size:"sm",onClick:()=>R(z),className:"w-8 h-8 sm:w-10 sm:h-10 p-0 text-xs sm:text-sm",children:z},z)}),r.jsx(L,{variant:"outline",size:"sm",onClick:()=>R(k=>Math.min(Z,k+1)),disabled:h===Z,className:"text-xs sm:text-sm",children:""})]})]})]}):r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:"   "})})]})]})}function a2(){const[e,t]=S.useState("general"),s=[{key:"general",label:" ",icon:th},{key:"branches",label:"",icon:Ir},{key:"users",label:"",icon:_a},{key:"categories",label:"",icon:Cg},{key:"brands",label:"",icon:D_},{key:"units",label:"",icon:P_}];return r.jsxs("div",{className:"p-3 md:p-6 space-y-4 md:space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl md:text-2xl font-bold",children:""}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"  "})]}),r.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:gap-6",children:[r.jsx("div",{className:"w-full md:w-48",children:r.jsx("div",{className:"flex md:flex-col gap-1 overflow-x-auto md:overflow-x-visible pb-2 md:pb-0",children:s.map(n=>r.jsxs("button",{onClick:()=>t(n.key),className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm transition-colors whitespace-nowrap ${e===n.key?"bg-primary text-primary-foreground":"hover:bg-muted"}`,children:[r.jsx(n.icon,{className:"h-4 w-4 flex-shrink-0"}),r.jsx("span",{className:"hidden sm:inline",children:n.label})]},n.key))})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[e==="general"&&r.jsx(i2,{}),e==="branches"&&r.jsx(l2,{}),e==="users"&&r.jsx(o2,{}),e==="categories"&&r.jsx(c2,{}),e==="brands"&&r.jsx(u2,{}),e==="units"&&r.jsx(d2,{})]})]})]})}function i2(){const[e,t]=S.useState(""),{data:s}=se({queryKey:["system-settings"],queryFn:async()=>{const{data:i}=await I.from("system_settings").select("*");return i||[]}}),n=s==null?void 0:s.find(i=>i.key==="usd_exchange_rate"),a=async()=>{if(e)try{n?await I.from("system_settings").update({value:e}).eq("id",n.id):await I.from("system_settings").insert({key:"usd_exchange_rate",value:e,description:"     ",value_type:"number"}),alert("    "),window.location.reload()}catch{alert("   ")}};return r.jsxs(le,{children:[r.jsx(Se,{children:r.jsx(Ge,{children:" "})}),r.jsxs(Ce,{className:"space-y-4",children:[r.jsxs("div",{className:"border rounded-lg p-4 bg-muted/50",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-lg",children:"  "}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"     "})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(G,{type:"number",step:"0.01",placeholder:(n==null?void 0:n.value)||"50.00",value:e,onChange:i=>t(i.target.value),className:"w-32 text-center font-bold"}),r.jsx("span",{className:"text-sm text-muted-foreground",children:""})]})]}),n&&r.jsxs("p",{className:"text-sm text-primary",children:[" : ",n.value," "]}),r.jsxs(L,{onClick:a,className:"mt-3",disabled:!e,children:[r.jsx(U_,{className:"h-4 w-4 ml-2"}),"  "]})]}),s==null?void 0:s.filter(i=>i.key!=="usd_exchange_rate").map(i=>r.jsxs("div",{className:"flex items-center justify-between border-b pb-3",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:i.key}),r.jsx("p",{className:"text-sm text-muted-foreground",children:i.description})]}),r.jsx(G,{defaultValue:i.value||"",className:"w-48"})]},i.id))]})]})}function l2(){const{data:e}=se({queryKey:["branches-settings"],queryFn:async()=>{const{data:t}=await I.from("branches").select("*").order("created_at");return t||[]}});return r.jsxs(le,{children:[r.jsxs(Se,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[r.jsx(Ge,{className:"text-base sm:text-lg",children:""}),r.jsx(L,{size:"sm",className:"w-full sm:w-auto",children:" "})]}),r.jsxs(Ce,{children:[r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"w-full text-xs sm:text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b",children:[r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""})]})}),r.jsx("tbody",{children:e==null?void 0:e.map(t=>r.jsxs("tr",{className:"border-b",children:[r.jsx("td",{className:"py-2 px-1 sm:px-2",children:t.code}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:t.name_ar}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:t.branch_type==="warehouse"?"":" "}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:t.phone}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${t.status==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:t.status==="active"?"":" "})})]},t.id))})]})}),r.jsx("div",{className:"block md:hidden space-y-3",children:e==null?void 0:e.map(t=>r.jsx(le,{className:"p-3",children:r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-sm",children:t.name_ar}),r.jsx("p",{className:"text-xs text-muted-foreground font-mono",children:t.code})]}),r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${t.status==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:t.status==="active"?"":" "})]}),r.jsxs("div",{className:"space-y-1 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-medium",children:t.branch_type==="warehouse"?"":" "})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-medium",children:t.phone})]})]})]})},t.id))})]})]})}function o2(){const{data:e}=se({queryKey:["users-settings"],queryFn:async()=>{const{data:t}=await I.from("users").select("*, role:roles(name_ar), branch:branches(name_ar)").order("created_at");return t||[]}});return r.jsxs(le,{children:[r.jsxs(Se,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[r.jsx(Ge,{className:"text-base sm:text-lg",children:""}),r.jsx(L,{size:"sm",className:"w-full sm:w-auto",children:" "})]}),r.jsxs(Ce,{children:[r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"w-full text-xs sm:text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b",children:[r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:" "}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""})]})}),r.jsx("tbody",{children:e==null?void 0:e.map(t=>{var s,n;return r.jsxs("tr",{className:"border-b",children:[r.jsx("td",{className:"py-2 px-1 sm:px-2",children:t.employee_code}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:t.full_name}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:t.username}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:(s=t.role)==null?void 0:s.name_ar}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:((n=t.branch)==null?void 0:n.name_ar)||""}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${t.status==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:t.status==="active"?"":" "})})]},t.id)})})]})}),r.jsx("div",{className:"block md:hidden space-y-3",children:e==null?void 0:e.map(t=>{var s,n;return r.jsx(le,{className:"p-3",children:r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-sm",children:t.full_name}),r.jsx("p",{className:"text-xs text-muted-foreground font-mono",children:t.employee_code})]}),r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${t.status==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:t.status==="active"?"":" "})]}),r.jsxs("div",{className:"space-y-1 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:" :"}),r.jsx("span",{className:"font-medium",children:t.username})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-medium",children:(s=t.role)==null?void 0:s.name_ar})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-medium",children:((n=t.branch)==null?void 0:n.name_ar)||""})]})]})]})},t.id)})})]})]})}function c2(){const{data:e}=se({queryKey:["categories-settings"],queryFn:async()=>{const{data:t}=await I.from("categories").select("*").order("sort_order");return t||[]}});return r.jsxs(le,{children:[r.jsxs(Se,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[r.jsx(Ge,{className:"text-base sm:text-lg",children:""}),r.jsx(L,{size:"sm",className:"w-full sm:w-auto",children:" "})]}),r.jsxs(Ce,{children:[r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"w-full text-xs sm:text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b",children:[r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""})]})}),r.jsx("tbody",{children:e==null?void 0:e.map(t=>r.jsxs("tr",{className:"border-b",children:[r.jsx("td",{className:"py-2 px-1 sm:px-2",children:t.code}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:t.name_ar}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${t.is_active?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:t.is_active?"":" "})})]},t.id))})]})}),r.jsx("div",{className:"block md:hidden space-y-3",children:e==null?void 0:e.map(t=>r.jsx(le,{className:"p-3",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-sm",children:t.name_ar}),r.jsx("p",{className:"text-xs text-muted-foreground font-mono",children:t.code})]}),r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${t.is_active?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:t.is_active?"":" "})]})},t.id))})]})]})}function u2(){const{data:e}=se({queryKey:["brands-settings"],queryFn:async()=>{const{data:t}=await I.from("brands").select("*").order("name");return t||[]}});return r.jsxs(le,{children:[r.jsxs(Se,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[r.jsx(Ge,{className:"text-base sm:text-lg",children:""}),r.jsx(L,{size:"sm",className:"w-full sm:w-auto",children:" "})]}),r.jsxs(Ce,{children:[r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"w-full text-xs sm:text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b",children:[r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""})]})}),r.jsx("tbody",{children:e==null?void 0:e.map(t=>r.jsxs("tr",{className:"border-b",children:[r.jsx("td",{className:"py-2 px-1 sm:px-2",children:t.code}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:t.name}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${t.is_active?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:t.is_active?"":" "})})]},t.id))})]})}),r.jsx("div",{className:"block md:hidden space-y-3",children:e==null?void 0:e.map(t=>r.jsx(le,{className:"p-3",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-sm",children:t.name}),r.jsx("p",{className:"text-xs text-muted-foreground font-mono",children:t.code})]}),r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${t.is_active?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:t.is_active?"":" "})]})},t.id))})]})]})}function d2(){const{data:e}=se({queryKey:["units-settings"],queryFn:async()=>{const{data:t}=await I.from("units").select("*").order("name");return t||[]}});return r.jsxs(le,{children:[r.jsxs(Se,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[r.jsx(Ge,{className:"text-base sm:text-lg",children:""}),r.jsx(L,{size:"sm",className:"w-full sm:w-auto",children:" "})]}),r.jsxs(Ce,{children:[r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"w-full text-xs sm:text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b",children:[r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""})]})}),r.jsx("tbody",{children:e==null?void 0:e.map(t=>r.jsxs("tr",{className:"border-b",children:[r.jsx("td",{className:"py-2 px-1 sm:px-2",children:t.code}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:t.name_ar}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${t.is_active?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:t.is_active?"":" "})})]},t.id))})]})}),r.jsx("div",{className:"block md:hidden space-y-3",children:e==null?void 0:e.map(t=>r.jsx(le,{className:"p-3",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-sm",children:t.name_ar}),r.jsx("p",{className:"text-xs text-muted-foreground font-mono",children:t.code})]}),r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${t.is_active?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:t.is_active?"":" "})]})},t.id))})]})]})}function h2(){const[e,t]=S.useState(""),[s,n]=S.useState([]),[a,i]=S.useState(null),[l,o]=S.useState(""),[c,u]=S.useState(!1),[d,m]=S.useState(0),[f,v]=S.useState(""),[g,w]=S.useState(""),[_,x]=S.useState(!1),[p,y]=S.useState(""),[j,b]=S.useState(!1),N=ht(),{data:T}=se({queryKey:["pos-branches"],queryFn:async()=>{const{data:C}=await I.from("branches").select("*").eq("status","active").eq("branch_type","outlet").order("name_ar");return C||[]}});!p&&T&&T.length>0&&y(T[0].id);const h=T==null?void 0:T.find(C=>C.id===p),{data:R}=se({queryKey:["pos-products",e,p],queryFn:async()=>{if(!p)return[];let C=I.from("inventory").select(`
          quantity,
          product:products!inner(
            id,
            code,
            name,
            name_ar,
            barcode,
            selling_price,
            status,
            category:categories(name_ar)
          )
        `).eq("branch_id",p).eq("product.status","active").gt("quantity",0);e&&(C=C.or(`product.code.ilike.%${e}%,product.name_ar.ilike.%${e}%,product.barcode.ilike.%${e}%`));const{data:B}=await C.limit(20);return(B||[]).map(K=>({...K.product,available_quantity:K.quantity}))},enabled:!!p}),{data:P}=se({queryKey:["pos-customers",l,p,c],queryFn:async()=>{if(!p)return[];let C=I.from("customers").select("*").eq("status","active").eq("branch_id",p);l&&(C=C.or(`code.ilike.%${l}%,name_ar.ilike.%${l}%,phone.ilike.%${l}%`));const{data:B}=await C.limit(20).order("name_ar");return B||[]},enabled:c&&!!p}),U=s.reduce((C,B)=>C+B.total,0),W=U*d/100,ee=_?(U-W)*.14:0,oe=U-W+ee,re=parseFloat(f)||0,ue=oe-re,me=C=>{const B=s.find(Q=>Q.product.id===C.id),K=B?B.quantity:0,ce=C.available_quantity||0;if(K>=ce){alert(` : ${ce}`);return}if(B)n(s.map(Q=>Q.product.id===C.id?{...Q,quantity:Q.quantity+1,total:(Q.quantity+1)*Q.unit_price}:Q));else{const Q={id:crypto.randomUUID(),product:C,quantity:1,unit_price:C.selling_price||0,discount:0,total:C.selling_price||0};n([...s,Q])}},V=(C,B)=>{n(s.map(K=>{if(K.id===C){const ce=Math.max(1,K.quantity+B),Q=K.product.available_quantity||0;return ce>Q?(alert(` : ${Q}`),K):{...K,quantity:ce,total:ce*K.unit_price}}return K}))},Y=C=>{n(s.filter(B=>B.id!==C))},Z=()=>{n([]),i(null),m(0),v(""),w(""),x(!1)},O=dt({mutationFn:async C=>{var q;if(!p)throw new Error("   ");const{data:B}=await I.from("users").select("id").limit(1),K=(q=B==null?void 0:B[0])==null?void 0:q.id;if(!K)throw new Error("Missing user");const Q={invoice_number:`INV-${Date.now()}`,invoice_date:new Date().toISOString(),branch_id:p,cashier_id:K,customer_id:(a==null?void 0:a.id)||null,customer_name:(a==null?void 0:a.name_ar)||(a==null?void 0:a.name)||null,subtotal:U,discount_amount:W,tax_amount:ee,total_amount:oe,paid_amount:re,remaining_amount:ue>0?ue:0,payment_method:C,status:ue<=0?"paid":"partially_paid",due_date:C==="credit"&&g?g:null,has_tax:_,payment_status:ue<=0?"paid":"credit"},{data:ge,error:Me}=await I.from("sales").insert(Q).select().single();if(Me)throw Me;const A=s.map(k=>({sale_id:ge.id,product_id:k.product.id,quantity:k.quantity,unit_price:k.unit_price,discount_amount:k.discount,total_price:k.total})),{error:D}=await I.from("sale_items").insert(A);if(D)throw D;for(const k of s){const{data:$}=await I.from("inventory").select("quantity").eq("product_id",k.product.id).eq("branch_id",p).single();if($){const z=($.quantity||0)-k.quantity,{error:J}=await I.from("inventory").update({quantity:z}).eq("product_id",k.product.id).eq("branch_id",p);J&&console.error("Inventory update error:",J)}}return ge},onSuccess:()=>{Z(),N.invalidateQueries({queryKey:["sales"]}),alert("   !")},onError:C=>{alert(" : "+C.message)}});return r.jsxs("div",{className:"h-[calc(100vh-4rem)] flex flex-col lg:flex-row gap-2 sm:gap-4",children:[r.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[r.jsxs("div",{className:"mb-2 sm:mb-4 space-y-2",children:[r.jsxs("div",{className:"relative",children:[r.jsxs("div",{className:"flex items-center gap-2 p-2 sm:p-3 border rounded-md cursor-pointer hover:bg-muted bg-card",onClick:()=>b(!j),children:[r.jsx(Ir,{className:"h-4 w-4 sm:h-5 sm:w-5 text-primary"}),r.jsx("span",{className:"flex-1 font-medium text-sm sm:text-base",children:h?h.name_ar:"  "})]}),j&&r.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-background border rounded-md shadow-lg z-10 max-h-60 overflow-auto",children:T==null?void 0:T.map(C=>r.jsxs("button",{type:"button",className:`w-full p-3 text-right hover:bg-muted ${p===C.id?"bg-primary/10":""}`,onClick:()=>{y(C.id),b(!1),n([])},children:[r.jsx("p",{className:"font-medium",children:C.name_ar}),r.jsx("p",{className:"text-xs text-muted-foreground",children:C.code})]},C.id))})]}),r.jsxs("div",{className:"relative",children:[r.jsx(E_,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 sm:h-5 sm:w-5 text-muted-foreground"}),r.jsx(G,{placeholder:"   ...",value:e,onChange:C=>t(C.target.value),className:"pr-10 sm:pr-12 text-base sm:text-lg h-10 sm:h-12",autoFocus:!0,disabled:!p})]})]}),r.jsx("div",{className:"flex-1 overflow-auto",children:p?R&&R.length===0?r.jsx("div",{className:"h-full flex items-center justify-center text-muted-foreground",children:r.jsx("p",{className:"text-sm sm:text-base",children:"      "})}):r.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-3 xl:grid-cols-4 gap-2 sm:gap-3",children:R==null?void 0:R.map(C=>r.jsxs("button",{type:"button",onClick:()=>me(C),className:"p-2 sm:p-4 bg-card border rounded-lg hover:border-primary hover:shadow-md transition-all text-right relative",children:[r.jsx("p",{className:"font-bold text-sm sm:text-lg truncate",children:C.name_ar}),r.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:C.code}),r.jsx("p",{className:"text-primary font-bold mt-1 sm:mt-2 text-sm sm:text-base",children:M(C.selling_price||0)}),r.jsx("span",{className:"absolute top-1 sm:top-2 left-1 sm:left-2 bg-muted px-1 sm:px-2 py-0.5 sm:py-1 rounded text-xs",children:C.available_quantity})]},C.id))}):r.jsx("div",{className:"h-full flex items-center justify-center text-muted-foreground",children:r.jsx("p",{className:"text-sm sm:text-base",children:"    "})})})]}),r.jsxs(le,{className:"w-full lg:w-[400px] flex flex-col max-h-[50vh] lg:max-h-none",children:[r.jsxs(Se,{className:"pb-2 p-3 sm:p-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs(Ge,{className:"flex items-center gap-2 text-base sm:text-lg",children:[r.jsx(Sg,{className:"h-4 w-4 sm:h-5 sm:w-5"}),"",s.length>0&&r.jsx("span",{className:"bg-primary text-primary-foreground rounded-full w-5 h-5 sm:w-6 sm:h-6 flex items-center justify-center text-xs",children:s.length})]}),r.jsx(L,{variant:"ghost",size:"sm",onClick:Z,className:"h-8 w-8 sm:h-9 sm:w-9",children:r.jsx(Rs,{className:"h-3 w-3 sm:h-4 sm:w-4"})})]}),r.jsxs("div",{className:"relative mt-2",children:[r.jsxs("div",{className:"flex items-center gap-2 p-2 border rounded-md cursor-pointer hover:bg-muted",onClick:()=>u(!c),children:[r.jsx(Pi,{className:"h-3 w-3 sm:h-4 sm:w-4"}),r.jsx("span",{className:"flex-1 text-xs sm:text-sm",children:a?a.name_ar||a.name:" "})]}),c&&r.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 bg-background border rounded-md shadow-lg z-10 p-2",children:[r.jsx(G,{placeholder:"  ...",value:l,onChange:C=>o(C.target.value),className:"mb-2"}),r.jsxs("div",{className:"max-h-40 overflow-auto",children:[r.jsx("button",{type:"button",className:"w-full p-2 text-right hover:bg-muted rounded",onClick:()=>{i(null),u(!1)},children:" "}),P==null?void 0:P.map(C=>r.jsxs("button",{type:"button",className:"w-full p-2 text-right hover:bg-muted rounded",onClick:()=>{i(C),u(!1)},children:[r.jsx("p",{className:"font-medium",children:C.name_ar||C.name}),r.jsx("p",{className:"text-xs text-muted-foreground",children:C.phone})]},C.id))]})]})]})]}),r.jsx(Ce,{className:"flex-1 overflow-auto p-2 sm:p-4",children:s.length===0?r.jsx("div",{className:"h-full flex items-center justify-center text-muted-foreground",children:r.jsx("p",{className:"text-sm",children:" "})}):r.jsx("div",{className:"space-y-2",children:s.map((C,B)=>r.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 p-2 bg-muted/50 rounded",children:[r.jsx("span",{className:"text-xs text-muted-foreground w-4 sm:w-5",children:B+1}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"font-medium text-xs sm:text-sm truncate",children:C.product.name_ar}),r.jsx("p",{className:"text-xs text-muted-foreground",children:M(C.unit_price)})]}),r.jsxs("div",{className:"flex items-center gap-0.5 sm:gap-1",children:[r.jsx(L,{variant:"outline",size:"icon",className:"h-6 w-6 sm:h-7 sm:w-7",onClick:()=>V(C.id,-1),children:r.jsx(Io,{className:"h-2 w-2 sm:h-3 sm:w-3"})}),r.jsx(G,{type:"number",value:C.quantity,onChange:K=>{const ce=parseInt(K.target.value)||1,Q=C.product.available_quantity||0;if(ce>Q){alert(` : ${Q}`);return}ce<1||n(s.map(ge=>ge.id===C.id?{...ge,quantity:ce,total:ce*ge.unit_price}:ge))},className:"w-12 sm:w-16 h-6 sm:h-7 text-center font-bold p-1 text-xs sm:text-sm",min:1,max:C.product.available_quantity||999}),r.jsx(L,{variant:"outline",size:"icon",className:"h-6 w-6 sm:h-7 sm:w-7",onClick:()=>V(C.id,1),children:r.jsx(Nt,{className:"h-2 w-2 sm:h-3 sm:w-3"})})]}),r.jsx("span",{className:"font-bold w-16 sm:w-20 text-left text-xs sm:text-sm",children:M(C.total)}),r.jsx(L,{variant:"ghost",size:"icon",className:"h-6 w-6 sm:h-7 sm:w-7",onClick:()=>Y(C.id),children:r.jsx(Rs,{className:"h-2 w-2 sm:h-3 sm:w-3 text-destructive"})})]},C.id))})}),r.jsxs("div",{className:"border-t p-2 sm:p-4 space-y-2 sm:space-y-3",children:[r.jsxs("div",{className:"flex justify-between text-xs sm:text-sm",children:[r.jsx("span",{children:" "}),r.jsx("span",{children:M(U)})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-xs sm:text-sm",children:" %"}),r.jsx(G,{type:"number",value:d,onChange:C=>m(parseFloat(C.target.value)||0),className:"w-16 sm:w-20 h-7 sm:h-8 text-center text-xs sm:text-sm",min:0,max:100}),r.jsxs("span",{className:"text-xs sm:text-sm text-muted-foreground",children:["(",M(W),")"]})]}),r.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 py-2 border-y",children:[r.jsx("span",{className:"text-xs sm:text-sm font-medium",children:":"}),r.jsxs("label",{className:"flex items-center gap-1 sm:gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"tax",checked:!_,onChange:()=>x(!1),className:"w-3 h-3 sm:w-4 sm:h-4"}),r.jsx("span",{className:"text-xs sm:text-sm",children:""})]}),r.jsxs("label",{className:"flex items-center gap-1 sm:gap-2 cursor-pointer",children:[r.jsx("input",{type:"radio",name:"tax",checked:_,onChange:()=>x(!0),className:"w-3 h-3 sm:w-4 sm:h-4"}),r.jsx("span",{className:"text-xs sm:text-sm",children:""})]})]}),_&&r.jsxs("div",{className:"flex justify-between text-xs sm:text-sm text-blue-600",children:[r.jsx("span",{children:" (14%)"}),r.jsx("span",{children:M(ee)})]}),r.jsxs("div",{className:"flex justify-between text-base sm:text-lg font-bold border-t pt-2",children:[r.jsx("span",{children:""}),r.jsx("span",{className:"text-primary",children:M(oe)})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-xs sm:text-sm",children:""}),r.jsx(G,{type:"number",value:f,onChange:C=>v(C.target.value),className:"flex-1 h-8 sm:h-10 text-base sm:text-lg",placeholder:"0"})]}),a&&r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-xs sm:text-sm whitespace-nowrap",children:" "}),r.jsx(G,{type:"date",value:g,onChange:C=>w(C.target.value),className:"flex-1 h-8 sm:h-10 text-xs sm:text-sm",placeholder:""})]}),ue>0&&r.jsxs("div",{className:"flex justify-between text-destructive text-xs sm:text-sm",children:[r.jsx("span",{children:""}),r.jsx("span",{children:M(ue)})]}),ue<0&&r.jsxs("div",{className:"flex justify-between text-green-600 text-xs sm:text-sm",children:[r.jsx("span",{children:" "}),r.jsx("span",{children:M(Math.abs(ue))})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-2",children:[r.jsxs(L,{className:"h-10 sm:h-12 text-sm sm:text-base",onClick:()=>O.mutate("cash"),disabled:s.length===0||O.isPending,children:[r.jsx(C_,{className:"h-4 w-4 sm:h-5 sm:w-5 ml-2"}),""]}),r.jsxs(L,{variant:"outline",className:"h-10 sm:h-12 text-sm sm:text-base",onClick:()=>O.mutate("credit"),disabled:s.length===0||!a||O.isPending,children:[r.jsx(R_,{className:"h-4 w-4 sm:h-5 sm:w-5 ml-2"}),""]})]})]})]})]})}const m2=`
  @media print {
    /* Hide sidebar and controls */
    aside, nav, .no-print {
      display: none !important;
    }
    
    /* Hide browser default headers and footers */
    @page {
      margin: 0.5cm;
    }
    
    /* Make content full width */
    main {
      margin: 0 !important;
      padding: 20px !important;
    }
    
    /* Show print header with logo */
    .print-header {
      display: block !important;
      text-align: center;
      margin-bottom: 30px;
      border-bottom: 2px solid #000;
      padding-bottom: 20px;
    }
    .print-header img {
      max-width: 80px;
      margin: 0 auto 10px;
      display: block;
    }
    .print-header h2 {
      font-size: 24px;
      font-weight: bold;
      margin: 10px 0;
    }
    .print-stats {
      display: flex !important;
      justify-content: space-around;
      margin: 20px 0;
      padding: 15px;
      background: #f5f5f5;
      page-break-inside: avoid;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    table th, table td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: right;
    }
    table th {
      background-color: #f2f2f2;
      font-weight: bold;
    }
  }
  
  /* Hide print header on screen */
  .print-header {
    display: none;
  }
`;function f2(){var f,v;const[e,t]=S.useState("sales"),[s,n]=S.useState(""),[a,i]=S.useState(""),[l,o]=S.useState("all"),{data:c}=se({queryKey:["reports-branches"],queryFn:async()=>{const{data:g}=await I.from("branches").select("*").eq("status","active").eq("branch_type","outlet").order("name_ar");return g||[]}}),u=()=>{window.print()},d=()=>{var x;if(!document.querySelector(".report-content"))return;const w=((x=m.find(p=>p.key===e))==null?void 0:x.label)||"",_=s&&a?` ${s}  ${a}`:"";alert(`  ${w} ${_}`)},m=[{key:"sales",label:" ",icon:Lu},{key:"purchases",label:" ",icon:kg},{key:"inventory",label:" ",icon:$o},{key:"customers",label:" ",icon:_a},{key:"suppliers",label:" ",icon:_a},{key:"profit",label:" ",icon:ea}];return r.jsxs("div",{className:"p-3 md:p-6 space-y-4 md:space-y-6",children:[r.jsx("style",{children:m2}),r.jsxs("div",{className:"print-header",children:[r.jsx("img",{src:"/el-fagr/logo.jpg",alt:"  "}),r.jsx("h2",{children:"  "}),r.jsx("h3",{children:(f=m.find(g=>g.key===e))==null?void 0:f.label}),s&&a&&r.jsxs("p",{children:[" ",s,"  ",a]})]}),r.jsx("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 no-print",children:r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl md:text-2xl font-bold",children:""}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"  "})]})}),r.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:gap-6",children:[r.jsx("div",{className:"w-full md:w-56",children:r.jsx("div",{className:"flex md:flex-col gap-1 overflow-x-auto md:overflow-x-visible pb-2 md:pb-0 no-print",children:m.map(g=>r.jsxs("button",{type:"button",onClick:()=>t(g.key),className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm transition-colors whitespace-nowrap ${e===g.key?"bg-primary text-primary-foreground":"hover:bg-muted"}`,children:[r.jsx(g.icon,{className:"h-4 w-4 flex-shrink-0"}),r.jsx("span",{className:"hidden sm:inline",children:g.label})]},g.key))})}),r.jsx("div",{className:"flex-1 min-w-0",children:r.jsxs(le,{children:[r.jsx(Se,{className:"no-print",children:r.jsxs("div",{className:"flex flex-col gap-3",children:[r.jsx(Ge,{className:"text-base sm:text-lg",children:(v=m.find(g=>g.key===e))==null?void 0:v.label}),r.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[r.jsxs("select",{value:l,onChange:g=>o(g.target.value),className:"px-3 py-2 border rounded-md bg-background text-sm",children:[r.jsx("option",{value:"all",children:" "}),c==null?void 0:c.map(g=>r.jsx("option",{value:g.id,children:g.name_ar},g.id))]}),r.jsx(G,{type:"date",value:s,onChange:g=>n(g.target.value),className:"flex-1 sm:w-32"}),r.jsx("span",{className:"hidden sm:inline text-sm",children:""}),r.jsx(G,{type:"date",value:a,onChange:g=>i(g.target.value),className:"flex-1 sm:w-32"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(L,{variant:"outline",size:"icon",onClick:u,className:"flex-1 sm:flex-none",children:r.jsx(Rr,{className:"h-4 w-4"})}),r.jsx(L,{variant:"outline",size:"icon",onClick:d,className:"flex-1 sm:flex-none",children:r.jsx(O_,{className:"h-4 w-4"})})]})]})]})}),r.jsxs(Ce,{className:"report-content",children:[e==="sales"&&r.jsx(p2,{dateFrom:s,dateTo:a,branchFilter:l}),e==="purchases"&&r.jsx(x2,{dateFrom:s,dateTo:a,branchFilter:l}),e==="inventory"&&r.jsx(g2,{branchFilter:l}),e==="customers"&&r.jsx(y2,{branchFilter:l}),e==="suppliers"&&r.jsx(v2,{}),e==="profit"&&r.jsx(j2,{dateFrom:s,dateTo:a,branchFilter:l})]})]})})]})]})}function p2({dateFrom:e,dateTo:t,branchFilter:s}){const{data:n,isLoading:a}=se({queryKey:["sales-report",e,t,s],queryFn:async()=>{let i=I.from("sales").select("*").order("created_at",{ascending:!1});e&&(i=i.gte("invoice_date",e)),t&&(i=i.lte("invoice_date",t)),s!=="all"&&(i=i.eq("branch_id",s));const{data:l}=await i.limit(100),o=l||[],c=o.reduce((m,f)=>m+(f.total_amount||0),0),u=o.reduce((m,f)=>m+(f.paid_amount||0),0),d=o.length;return{sales:o,totalSales:c,totalPaid:u,count:d}}});return a?r.jsx("p",{className:"text-center py-8",children:" ..."}):r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4 print-stats",children:[r.jsxs("div",{className:"p-3 sm:p-4 bg-blue-50 rounded-lg",children:[r.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:"text-xl sm:text-2xl font-bold",children:n==null?void 0:n.count})]}),r.jsxs("div",{className:"p-3 sm:p-4 bg-green-50 rounded-lg",children:[r.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:"text-xl sm:text-2xl font-bold",children:M((n==null?void 0:n.totalSales)||0)})]}),r.jsxs("div",{className:"p-3 sm:p-4 bg-yellow-50 rounded-lg",children:[r.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:"text-xl sm:text-2xl font-bold",children:M((n==null?void 0:n.totalPaid)||0)})]})]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full text-xs sm:text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b",children:[r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:" "}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2 hidden sm:table-cell",children:""})]})}),r.jsx("tbody",{children:n==null?void 0:n.sales.slice(0,20).map(i=>r.jsxs("tr",{className:"border-b",children:[r.jsx("td",{className:"py-2 px-1 sm:px-2",children:i.invoice_number}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:Ee(i.invoice_date||i.created_at)}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:M(i.total_amount||0)}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:M(i.paid_amount||0)}),r.jsx("td",{className:"py-2 px-1 sm:px-2 hidden sm:table-cell",children:i.status})]},i.id))})]})})]})}function x2({dateFrom:e,dateTo:t,branchFilter:s}){const{data:n,isLoading:a}=se({queryKey:["purchases-report",e,t,s],queryFn:async()=>{let i=I.from("purchases").select("*, supplier:suppliers(name_ar)").order("created_at",{ascending:!1});e&&(i=i.gte("invoice_date",e)),t&&(i=i.lte("invoice_date",t)),s!=="all"&&(i=i.eq("branch_id",s));const{data:l}=await i.limit(100),o=l||[],c=o.reduce((d,m)=>d+(m.total_amount||0),0),u=o.reduce((d,m)=>d+(m.paid_amount||0),0);return{purchases:o,total:c,paid:u,count:o.length}}});return a?r.jsx("p",{className:"text-center py-8",children:" ..."}):r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4 print-stats",children:[r.jsxs("div",{className:"p-3 sm:p-4 bg-blue-50 rounded-lg",children:[r.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:"text-xl sm:text-2xl font-bold",children:n==null?void 0:n.count})]}),r.jsxs("div",{className:"p-3 sm:p-4 bg-red-50 rounded-lg",children:[r.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:"text-xl sm:text-2xl font-bold",children:M((n==null?void 0:n.total)||0)})]}),r.jsxs("div",{className:"p-3 sm:p-4 bg-green-50 rounded-lg",children:[r.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:"text-xl sm:text-2xl font-bold",children:M((n==null?void 0:n.paid)||0)})]})]}),r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"w-full text-xs sm:text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b",children:[r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:" "}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""})]})}),r.jsx("tbody",{children:n==null?void 0:n.purchases.slice(0,20).map(i=>{var l;return r.jsxs("tr",{className:"border-b",children:[r.jsx("td",{className:"py-2 px-1 sm:px-2",children:i.invoice_number}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:(l=i.supplier)==null?void 0:l.name_ar}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:Ee(i.invoice_date||i.created_at)}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:M(i.total_amount||0)}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:M(i.paid_amount||0)})]},i.id)})})]})}),r.jsx("div",{className:"block md:hidden space-y-3",children:n==null?void 0:n.purchases.slice(0,20).map(i=>{var l;return r.jsx(le,{className:"p-3",children:r.jsxs("div",{className:"space-y-2",children:[r.jsx("div",{className:"flex justify-between items-start",children:r.jsxs("div",{children:[r.jsx("p",{className:"font-mono text-sm font-bold",children:i.invoice_number}),r.jsx("p",{className:"text-xs text-muted-foreground",children:Ee(i.invoice_date||i.created_at)})]})}),r.jsxs("div",{className:"space-y-1 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-medium",children:(l=i.supplier)==null?void 0:l.name_ar})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-bold text-primary",children:M(i.total_amount||0)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-medium",children:M(i.paid_amount||0)})]})]})]})},i.id)})})]})}function g2({branchFilter:e}){const{data:t,isLoading:s}=se({queryKey:["inventory-report",e],queryFn:async()=>{let n=I.from("inventory").select("*, product:products(code, name_ar, selling_price), branch:branches(name_ar)").order("quantity",{ascending:!0});e!=="all"&&(n=n.eq("branch_id",e));const{data:a}=await n.limit(100),i=a||[],l=i.filter(c=>(c.quantity||0)<=(c.min_quantity||10)),o=i.reduce((c,u)=>{var d;return c+(u.quantity||0)*(((d=u.product)==null?void 0:d.selling_price)||0)},0);return{inventory:i,lowStock:l,totalValue:o}}});return s?r.jsx("p",{className:"text-center py-8",children:" ..."}):r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4 print-stats",children:[r.jsxs("div",{className:"p-3 sm:p-4 bg-blue-50 rounded-lg",children:[r.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:"text-xl sm:text-2xl font-bold",children:t==null?void 0:t.inventory.length})]}),r.jsxs("div",{className:"p-3 sm:p-4 bg-red-50 rounded-lg",children:[r.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"   "}),r.jsx("p",{className:"text-xl sm:text-2xl font-bold",children:t==null?void 0:t.lowStock.length})]}),r.jsxs("div",{className:"p-3 sm:p-4 bg-green-50 rounded-lg",children:[r.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:"text-xl sm:text-2xl font-bold",children:M((t==null?void 0:t.totalValue)||0)})]})]}),r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"w-full text-xs sm:text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b",children:[r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:" "}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:" "}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:" "})]})}),r.jsx("tbody",{children:t==null?void 0:t.inventory.map(n=>{var a,i,l;return r.jsxs("tr",{className:`border-b ${(n.quantity||0)<=(n.min_quantity||10)?"bg-red-50":""}`,children:[r.jsx("td",{className:"py-2 px-1 sm:px-2",children:(a=n.product)==null?void 0:a.code}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:(i=n.product)==null?void 0:i.name_ar}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:(l=n.branch)==null?void 0:l.name_ar}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:n.quantity||0}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:n.min_quantity||10})]},n.id)})})]})}),r.jsx("div",{className:"block md:hidden space-y-3",children:t==null?void 0:t.inventory.map(n=>{var a,i,l;return r.jsx(le,{className:`p-3 ${(n.quantity||0)<=(n.min_quantity||10)?"border-red-300 bg-red-50":""}`,children:r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-sm",children:(a=n.product)==null?void 0:a.name_ar}),r.jsx("p",{className:"text-xs text-muted-foreground font-mono",children:(i=n.product)==null?void 0:i.code})]}),(n.quantity||0)<=(n.min_quantity||10)&&r.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-700 text-xs rounded-full",children:" "})]}),r.jsxs("div",{className:"space-y-1 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-medium",children:(l=n.branch)==null?void 0:l.name_ar})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:`font-bold ${(n.quantity||0)<=(n.min_quantity||10)?"text-red-600":"text-primary"}`,children:n.quantity||0})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:" :"}),r.jsx("span",{className:"font-medium",children:n.min_quantity||10})]})]})]})},n.id)})})]})}function y2({branchFilter:e}){const{data:t,isLoading:s}=se({queryKey:["customers-report",e],queryFn:async()=>{let n=I.from("customers").select("*").order("current_balance",{ascending:!1});e!=="all"&&(n=n.eq("branch_id",e));const{data:a}=await n.limit(100),i=a||[],l=i.reduce((c,u)=>c+(u.current_balance||0),0),o=i.filter(c=>(c.current_balance||0)>0);return{customers:i,totalBalance:l,withBalance:o.length}}});return s?r.jsx("p",{className:"text-center py-8",children:" ..."}):r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4 print-stats",children:[r.jsxs("div",{className:"p-3 sm:p-4 bg-blue-50 rounded-lg",children:[r.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:"text-xl sm:text-2xl font-bold",children:t==null?void 0:t.customers.length})]}),r.jsxs("div",{className:"p-3 sm:p-4 bg-yellow-50 rounded-lg",children:[r.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"  "}),r.jsx("p",{className:"text-xl sm:text-2xl font-bold",children:t==null?void 0:t.withBalance})]}),r.jsxs("div",{className:"p-3 sm:p-4 bg-red-50 rounded-lg",children:[r.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:"text-xl sm:text-2xl font-bold",children:M((t==null?void 0:t.totalBalance)||0)})]})]}),r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"w-full text-xs sm:text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b",children:[r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:" "})]})}),r.jsx("tbody",{children:t==null?void 0:t.customers.map(n=>r.jsxs("tr",{className:`border-b ${(n.current_balance||0)>(n.credit_limit||0)?"bg-red-50":""}`,children:[r.jsx("td",{className:"py-2 px-1 sm:px-2",children:n.code}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:n.name_ar||n.name}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:n.phone}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:M(n.current_balance||0)}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:M(n.credit_limit||0)})]},n.id))})]})}),r.jsx("div",{className:"block md:hidden space-y-3",children:t==null?void 0:t.customers.map(n=>r.jsx(le,{className:`p-3 ${(n.current_balance||0)>(n.credit_limit||0)?"border-red-300 bg-red-50":""}`,children:r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-sm",children:n.name_ar||n.name}),r.jsx("p",{className:"text-xs text-muted-foreground font-mono",children:n.code})]}),(n.current_balance||0)>(n.credit_limit||0)&&r.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-700 text-xs rounded-full",children:" "})]}),r.jsxs("div",{className:"space-y-1 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-medium",children:n.phone})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:`font-bold ${(n.current_balance||0)>0?"text-red-600":"text-green-600"}`,children:M(n.current_balance||0)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:" :"}),r.jsx("span",{className:"font-medium",children:M(n.credit_limit||0)})]})]})]})},n.id))})]})}function v2(){const{data:e,isLoading:t}=se({queryKey:["suppliers-report"],queryFn:async()=>{const{data:s}=await I.from("suppliers").select("*").order("current_balance",{ascending:!1}).limit(100),n=s||[],a=n.reduce((i,l)=>i+(l.current_balance||0),0);return{suppliers:n,totalBalance:a}}});return t?r.jsx("p",{className:"text-center py-8",children:" ..."}):r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 print-stats",children:[r.jsxs("div",{className:"p-3 sm:p-4 bg-blue-50 rounded-lg",children:[r.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:"text-xl sm:text-2xl font-bold",children:e==null?void 0:e.suppliers.length})]}),r.jsxs("div",{className:"p-3 sm:p-4 bg-red-50 rounded-lg",children:[r.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:"text-xl sm:text-2xl font-bold",children:M((e==null?void 0:e.totalBalance)||0)})]})]}),r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"w-full text-xs sm:text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b",children:[r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:" "})]})}),r.jsx("tbody",{children:e==null?void 0:e.suppliers.map(s=>r.jsxs("tr",{className:"border-b",children:[r.jsx("td",{className:"py-2 px-1 sm:px-2",children:s.code}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:s.name_ar||s.name}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:s.phone}),r.jsx("td",{className:"py-2 px-1 sm:px-2",children:M(s.current_balance||0)})]},s.id))})]})}),r.jsx("div",{className:"block md:hidden space-y-3",children:e==null?void 0:e.suppliers.map(s=>r.jsx(le,{className:"p-3",children:r.jsxs("div",{className:"space-y-2",children:[r.jsx("div",{className:"flex justify-between items-start",children:r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-sm",children:s.name_ar||s.name}),r.jsx("p",{className:"text-xs text-muted-foreground font-mono",children:s.code})]})}),r.jsxs("div",{className:"space-y-1 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-medium",children:s.phone})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:" :"}),r.jsx("span",{className:`font-bold ${(s.current_balance||0)>0?"text-red-600":"text-green-600"}`,children:M(s.current_balance||0)})]})]})]})},s.id))})]})}function j2({dateFrom:e,dateTo:t,branchFilter:s}){const{data:n,isLoading:a}=se({queryKey:["profit-report",e,t,s],queryFn:async()=>{let i=I.from("sales").select("total_amount, discount_amount"),l=I.from("purchases").select("total_amount");e&&(i=i.gte("invoice_date",e),l=l.gte("invoice_date",e)),t&&(i=i.lte("invoice_date",t),l=l.lte("invoice_date",t)),s!=="all"&&(i=i.eq("branch_id",s),l=l.eq("branch_id",s));const[{data:o},{data:c}]=await Promise.all([i,l]),u=o||[],d=c||[],m=u.reduce((w,_)=>w+(_.total_amount||0),0),f=u.reduce((w,_)=>w+(_.discount_amount||0),0),v=d.reduce((w,_)=>w+(_.total_amount||0),0),g=m-v;return{totalSales:m,totalDiscounts:f,totalPurchases:v,grossProfit:g}}});return a?r.jsx("p",{className:"text-center py-8",children:" ..."}):r.jsx("div",{className:"space-y-4",children:r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 print-stats",children:[r.jsxs("div",{className:"p-4 sm:p-6 bg-green-50 rounded-lg",children:[r.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-green-600",children:M((n==null?void 0:n.totalSales)||0)})]}),r.jsxs("div",{className:"p-4 sm:p-6 bg-red-50 rounded-lg",children:[r.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-red-600",children:M((n==null?void 0:n.totalPurchases)||0)})]}),r.jsxs("div",{className:"p-4 sm:p-6 bg-yellow-50 rounded-lg",children:[r.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-yellow-600",children:M((n==null?void 0:n.totalDiscounts)||0)})]}),r.jsxs("div",{className:`p-4 sm:p-6 rounded-lg ${((n==null?void 0:n.grossProfit)||0)>=0?"bg-green-100":"bg-red-100"}`,children:[r.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:`text-2xl sm:text-3xl font-bold ${((n==null?void 0:n.grossProfit)||0)>=0?"text-green-700":"text-red-700"}`,children:M((n==null?void 0:n.grossProfit)||0)})]})]})})}function w2(){const[e,t]=S.useState(!1),[s,n]=S.useState({branch_id:"",partner_name:"",amount:0,notes:""}),a=ht(),{data:i}=se({queryKey:["withdrawal-branches"],queryFn:async()=>{const{data:d}=await I.from("branches").select("*").eq("status","active").order("name_ar");return d||[]}}),{data:l,isLoading:o}=se({queryKey:["partner-withdrawals"],queryFn:async()=>{const{data:d}=await I.from("partner_withdrawals").select("*, branch:branches(name_ar)").order("created_at",{ascending:!1});return d||[]}}),{data:c}=se({queryKey:["branch-balance",s.branch_id],queryFn:async()=>{if(!s.branch_id)return 0;const{data:d}=await I.from("sales").select("total_amount").eq("branch_id",s.branch_id).eq("status","completed"),f=((d==null?void 0:d.reduce((w,_)=>w+(_.total_amount||0),0))||0)*.2,{data:v}=await I.from("partner_withdrawals").select("amount").eq("branch_id",s.branch_id).eq("status","approved"),g=(v==null?void 0:v.reduce((w,_)=>w+(_.amount||0),0))||0;return f-g},enabled:!!s.branch_id}),u=dt({mutationFn:async()=>{const d=`WD-${Date.now()}`,m=c||0,f=m-s.amount,{error:v}=await I.from("partner_withdrawals").insert({withdrawal_number:d,branch_id:s.branch_id,partner_name:s.partner_name,amount:s.amount,balance_before:m,balance_after:f,notes:s.notes||null,status:"approved",withdrawal_date:new Date().toISOString()});if(v)throw v},onSuccess:()=>{a.invalidateQueries({queryKey:["partner-withdrawals"]}),a.invalidateQueries({queryKey:["branch-balance"]}),t(!1),n({branch_id:"",partner_name:"",amount:0,notes:""}),alert("   !")},onError:d=>alert(": "+d.message)});return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold",children:" "}),r.jsx("p",{className:"text-muted-foreground",children:"    "})]}),r.jsxs(L,{onClick:()=>t(!0),children:[r.jsx(Nt,{className:"h-4 w-4 ml-2"}),"  "]})]}),r.jsx(et,{open:e,onOpenChange:t,children:r.jsxs(tt,{onClose:()=>t(!1),className:"max-w-lg",children:[r.jsx(it,{children:r.jsx(lt,{children:"  "})}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"branch",className:"text-sm font-medium",children:" *"}),r.jsxs("select",{id:"branch",value:s.branch_id,onChange:d=>n({...s,branch_id:d.target.value}),className:"w-full px-3 py-2 border rounded-md bg-background",children:[r.jsx("option",{value:"",children:" "}),i==null?void 0:i.map(d=>r.jsx("option",{value:d.id,children:d.name_ar},d.id))]})]}),s.branch_id&&r.jsxs("div",{className:"p-3 bg-muted rounded-md",children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:"text-2xl font-bold text-primary",children:M(c||0)})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"partner",className:"text-sm font-medium",children:"  *"}),r.jsx(G,{id:"partner",value:s.partner_name,onChange:d=>n({...s,partner_name:d.target.value}),placeholder:"  "})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"amount",className:"text-sm font-medium",children:" *"}),r.jsx(G,{id:"amount",type:"number",value:s.amount,onChange:d=>n({...s,amount:parseFloat(d.target.value)||0}),placeholder:"0"})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"notes",className:"text-sm font-medium",children:""}),r.jsx(G,{id:"notes",value:s.notes,onChange:d=>n({...s,notes:d.target.value}),placeholder:" "})]})]}),r.jsxs(js,{children:[r.jsx(L,{variant:"outline",onClick:()=>t(!1),children:""}),r.jsx(L,{onClick:()=>u.mutate(),disabled:!s.branch_id||!s.partner_name||s.amount<=0||u.isPending,children:u.isPending?" ...":""})]})]})}),r.jsxs(le,{children:[r.jsx(Se,{children:r.jsx(Ge,{children:" "})}),r.jsx(Ce,{children:o?r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:" ..."}):l!=null&&l.length?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b",children:[r.jsx("th",{className:"text-right py-3 px-2",children:" "}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:" "}),r.jsx("th",{className:"text-right py-3 px-2",children:" "}),r.jsx("th",{className:"text-right py-3 px-2",children:""})]})}),r.jsx("tbody",{children:l.map(d=>{var m;return r.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[r.jsx("td",{className:"py-3 px-2 font-mono text-sm",children:d.withdrawal_number}),r.jsxs("td",{className:"py-3 px-2",children:[r.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[r.jsx(lo,{className:"h-3 w-3"}),new Date(d.withdrawal_date||d.created_at).toLocaleDateString("ar-EG")]}),r.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(d.withdrawal_date||d.created_at).toLocaleTimeString("ar-EG")})]}),r.jsx("td",{className:"py-3 px-2",children:r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(Ir,{className:"h-3 w-3"}),(m=d.branch)==null?void 0:m.name_ar]})}),r.jsx("td",{className:"py-3 px-2",children:r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(Pi,{className:"h-3 w-3"}),d.partner_name]})}),r.jsx("td",{className:"py-3 px-2",children:r.jsx("span",{className:"font-bold text-destructive",children:M(d.amount||0)})}),r.jsx("td",{className:"py-3 px-2",children:M(d.balance_before||0)}),r.jsx("td",{className:"py-3 px-2",children:M(d.balance_after||0)}),r.jsx("td",{className:"py-3 px-2",children:r.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-700",children:d.status==="approved"?"":""})})]},d.id)})})]})}),r.jsx("div",{className:"block md:hidden space-y-3",children:l.map(d=>{var m;return r.jsx(le,{className:"p-4",children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-mono text-sm font-bold",children:d.withdrawal_number}),r.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[r.jsx(lo,{className:"h-3 w-3"}),new Date(d.withdrawal_date||d.created_at).toLocaleDateString("ar-EG")]})]}),r.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-700",children:d.status==="approved"?"":""})]}),r.jsxs("div",{className:"space-y-1 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[r.jsx(Ir,{className:"h-3 w-3"}),":"]}),r.jsx("span",{className:"font-medium",children:(m=d.branch)==null?void 0:m.name_ar})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[r.jsx(Pi,{className:"h-3 w-3"}),":"]}),r.jsx("span",{className:"font-medium",children:d.partner_name})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[r.jsx(ea,{className:"h-3 w-3"}),":"]}),r.jsx("span",{className:"font-bold text-destructive",children:M(d.amount||0)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:" :"}),r.jsx("span",{className:"font-medium",children:M(d.balance_before||0)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:" :"}),r.jsx("span",{className:"font-medium",children:M(d.balance_after||0)})]})]})]})},d.id)})})]}):r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:"  "})})]})]})}function _2(){var m,f;const[e,t]=S.useState(""),[s,n]=S.useState(null),[a,i]=S.useState(!1),l=S.useRef(null),{data:o}=se({queryKey:["statement-customers",e],queryFn:async()=>{if(!e)return[];const{data:v}=await I.from("customers").select("*").or(`code.ilike.%${e}%,name_ar.ilike.%${e}%,phone.ilike.%${e}%`).limit(10);return v||[]},enabled:e.length>0}),{data:c,isLoading:u}=se({queryKey:["customer-transactions",s==null?void 0:s.id],queryFn:async()=>{if(!s)return[];const v=[],{data:g}=await I.from("sales").select("*").eq("customer_id",s.id).order("created_at",{ascending:!0});g==null||g.forEach(x=>{v.push({date:x.created_at,type:"sale",reference:x.invoice_number,description:" ",debit:x.payment_method==="credit"?x.total_amount:0,credit:0}),x.paid_amount&&x.paid_amount>0&&v.push({date:x.created_at,type:"payment",reference:x.invoice_number,description:"  ",debit:0,credit:x.paid_amount})});const{data:w}=await I.from("returns").select("*").eq("customer_id",s.id).order("created_at",{ascending:!0});w==null||w.forEach(x=>{v.push({date:x.created_at,type:"return",reference:x.return_number,description:"",debit:0,credit:x.total_amount||0})}),v.sort((x,p)=>new Date(x.date).getTime()-new Date(p.date).getTime());let _=0;return v.forEach(x=>{_+=(x.debit||0)-(x.credit||0),x.balance=_}),v},enabled:!!s}),d=Qg.useReactToPrint({content:()=>l.current,documentTitle:`  - ${(s==null?void 0:s.name_ar)||(s==null?void 0:s.name)}`});return r.jsxs("div",{className:"p-3 md:p-6 space-y-4 md:space-y-6",children:[r.jsx("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl md:text-2xl font-bold",children:"  "}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"     "})]})}),r.jsxs(le,{children:[r.jsx(Se,{children:r.jsx(Ge,{children:" "})}),r.jsx(Ce,{children:r.jsxs("div",{className:"relative",children:[r.jsxs("div",{className:"flex items-center gap-2 p-3 border rounded-md cursor-pointer hover:bg-muted",onClick:()=>i(!a),children:[r.jsx(Pi,{className:"h-5 w-5 text-primary"}),r.jsx("span",{className:"flex-1",children:s?s.name_ar||s.name:" ..."}),r.jsx(Os,{className:"h-4 w-4 text-muted-foreground"})]}),a&&r.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 bg-background border rounded-md shadow-lg z-10 p-2",children:[r.jsx("input",{type:"text",placeholder:"  ...",value:e,onChange:v=>t(v.target.value),className:"w-full px-3 py-2 border rounded-md mb-2",autoFocus:!0}),r.jsxs("div",{className:"max-h-60 overflow-auto",children:[o==null?void 0:o.map(v=>r.jsxs("button",{type:"button",className:"w-full p-2 text-right hover:bg-muted rounded",onClick:()=>{n(v),i(!1),t("")},children:[r.jsx("p",{className:"font-medium",children:v.name_ar||v.name}),r.jsxs("p",{className:"text-xs text-muted-foreground",children:[v.phone," - ",v.code]})]},v.id)),e&&(o==null?void 0:o.length)===0&&r.jsx("p",{className:"text-center py-4 text-muted-foreground text-sm",children:"  "})]})]})]})})]}),s&&r.jsxs(le,{children:[r.jsx(Se,{children:r.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[r.jsx(Ge,{className:"text-base sm:text-lg",children:" "}),r.jsxs(L,{onClick:d,disabled:!(c!=null&&c.length),className:"w-full sm:w-auto",children:[r.jsx(Rr,{className:"h-4 w-4 ml-2"}),""]})]})}),r.jsx(Ce,{children:r.jsxs("div",{ref:l,className:"space-y-4",children:[r.jsxs("div",{className:"print-only mb-6",children:[r.jsxs("div",{className:"text-center mb-4",children:[r.jsx("h1",{className:"text-2xl font-bold",children:"   "}),r.jsx("p",{className:"text-lg mt-2",children:"  "})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[r.jsxs("div",{children:[r.jsxs("p",{children:[r.jsx("strong",{children:":"})," ",s.name_ar||s.name]}),r.jsxs("p",{children:[r.jsx("strong",{children:":"})," ",s.code]})]}),r.jsxs("div",{children:[r.jsxs("p",{children:[r.jsx("strong",{children:":"})," ",s.phone]}),r.jsxs("p",{children:[r.jsx("strong",{children:":"})," ",new Date().toLocaleDateString("ar-EG")]})]})]}),r.jsx("hr",{className:"my-4"})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 p-3 sm:p-4 bg-muted rounded-md no-print",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:"font-bold text-sm sm:text-base",children:s.name_ar||s.name})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:"font-bold text-sm sm:text-base",children:s.phone})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:""}),r.jsx("p",{className:"font-bold text-sm sm:text-base",children:s.code})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:`font-bold text-base sm:text-lg ${(s.current_balance||0)>0?"text-destructive":"text-green-600"}`,children:M(s.current_balance||0)})]})]}),u?r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:" ..."}):c!=null&&c.length?r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full text-xs sm:text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b",children:[r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2 hidden sm:table-cell",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-1 sm:px-2",children:""})]})}),r.jsx("tbody",{children:c.map((v,g)=>r.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[r.jsx("td",{className:"py-2 px-1 sm:px-2",children:r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(lo,{className:"h-3 w-3 hidden sm:inline"}),r.jsx("span",{className:"text-xs",children:new Date(v.date).toLocaleDateString("ar-EG",{month:"numeric",day:"numeric"})})]})}),r.jsx("td",{className:"py-2 px-1 sm:px-2 font-mono text-xs",children:v.reference}),r.jsx("td",{className:"py-2 px-1 sm:px-2 hidden sm:table-cell",children:v.description}),r.jsx("td",{className:"py-2 px-1 sm:px-2 text-destructive text-xs sm:text-sm",children:v.debit>0?M(v.debit):"-"}),r.jsx("td",{className:"py-2 px-1 sm:px-2 text-green-600 text-xs sm:text-sm",children:v.credit>0?M(v.credit):"-"}),r.jsx("td",{className:"py-2 px-1 sm:px-2 font-bold text-xs sm:text-sm",children:r.jsx("span",{className:v.balance>0?"text-destructive":"text-green-600",children:M(v.balance)})})]},g))}),r.jsx("tfoot",{children:r.jsxs("tr",{className:"border-t-2 font-bold",children:[r.jsx("td",{colSpan:2,className:"py-3 px-1 sm:px-2 text-right text-xs sm:text-sm",children:""}),r.jsx("td",{className:"py-3 px-1 sm:px-2 text-destructive text-xs sm:text-sm hidden sm:table-cell",children:M(c.reduce((v,g)=>v+(g.debit||0),0))}),r.jsx("td",{className:"py-3 px-1 sm:px-2 text-destructive text-xs sm:text-sm sm:hidden",children:M(c.reduce((v,g)=>v+(g.debit||0),0))}),r.jsx("td",{className:"py-3 px-1 sm:px-2 text-green-600 text-xs sm:text-sm",children:M(c.reduce((v,g)=>v+(g.credit||0),0))}),r.jsx("td",{className:"py-3 px-1 sm:px-2 text-xs sm:text-sm",children:r.jsx("span",{className:((m=c[c.length-1])==null?void 0:m.balance)>0?"text-destructive":"text-green-600",children:M(((f=c[c.length-1])==null?void 0:f.balance)||0)})})]})})]})}):r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:"  "})]})})]}),r.jsx("style",{children:`
        @media print {
          .no-print { display: none !important; }
          .print-only { display: block !important; }
        }
        @media screen {
          .print-only { display: none !important; }
        }
      `})]})}function b2(){var j;const[e,t]=S.useState(""),[s,n]=S.useState(!1),[a,i]=S.useState([]),[l,o]=S.useState(""),c=ht(),{data:u}=se({queryKey:["stockcount-branches"],queryFn:async()=>{const{data:b}=await I.from("branches").select("*").eq("status","active").order("name_ar");return b||[]}}),{data:d,isLoading:m}=se({queryKey:["stockcount-inventory",e],queryFn:async()=>{if(!e)return[];const{data:b}=await I.from("inventory").select(`
          product_id,
          quantity,
          product:products(id, code, name, name_ar)
        `).eq("branch_id",e);return b||[]},enabled:!!e}),{data:f,isLoading:v}=se({queryKey:["stock-counts"],queryFn:async()=>{const{data:b}=await I.from("stock_counts").select("*, branch:branches(name_ar)").order("created_at",{ascending:!1});return b||[]}}),g=()=>{if(!e){alert("   ");return}if(!d||d.length===0){alert("     ");return}const b=d.map(N=>{var T,h,R;return{product_id:N.product_id,product_name:((T=N.product)==null?void 0:T.name_ar)||((h=N.product)==null?void 0:h.name),product_code:(R=N.product)==null?void 0:R.code,system_quantity:N.quantity||0,counted_quantity:0,variance:0,variance_type:"match"}});i(b),n(!0)},w=(b,N)=>{i(T=>T.map(h=>{if(h.product_id===b){const R=N-h.system_quantity,P=R>0?"surplus":R<0?"shortage":"match";return{...h,counted_quantity:N,variance:R,variance_type:P}}return h}))},_=dt({mutationFn:async()=>{var oe;const b=`SC-${Date.now()}`,{data:N}=await I.from("users").select("id").limit(1),T=(oe=N==null?void 0:N[0])==null?void 0:oe.id;a.reduce((re,ue)=>re+Math.abs(ue.variance),0);const h=a.filter(re=>re.variance_type==="surplus").length,R=a.filter(re=>re.variance_type==="shortage").length,{data:P,error:U}=await I.from("stock_counts").insert({count_number:b,branch_id:e,counted_by:T,count_date:new Date().toISOString(),status:"pending",notes:l||null,total_items:a.length,variance_items:h+R}).select().single();if(U)throw U;const W=a.map(re=>({stock_count_id:P.id,product_id:re.product_id,system_quantity:re.system_quantity,counted_quantity:re.counted_quantity,variance_quantity:re.variance,variance_type:re.variance_type})),{error:ee}=await I.from("stock_count_items").insert(W);if(ee)throw ee;return P},onSuccess:()=>{c.invalidateQueries({queryKey:["stock-counts"]}),n(!1),i([]),o(""),alert("   !")},onError:b=>{alert(" : "+b.message)}}),x=dt({mutationFn:async b=>{const{data:N}=await I.from("stock_count_items").select("*").eq("stock_count_id",b);if(!N)throw new Error("Count items not found");const{data:T}=await I.from("stock_counts").select("branch_id").eq("id",b).single();if(!T)throw new Error("Count not found");for(const h of N)h.variance_quantity!==0&&await I.from("inventory").update({quantity:h.counted_quantity}).eq("product_id",h.product_id).eq("branch_id",T.branch_id);await I.from("stock_counts").update({status:"approved",approved_at:new Date().toISOString()}).eq("id",b)},onSuccess:()=>{c.invalidateQueries({queryKey:["stock-counts"]}),c.invalidateQueries({queryKey:["stockcount-inventory"]}),alert("    !")},onError:b=>{alert(" : "+b.message)}});a.reduce((b,N)=>b+Math.abs(N.variance),0);const p=a.filter(b=>b.variance_type==="surplus").length,y=a.filter(b=>b.variance_type==="shortage").length;return r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold",children:" "}),r.jsx("p",{className:"text-muted-foreground",children:"   "})]})}),r.jsxs(le,{children:[r.jsx(Se,{children:r.jsx(Ge,{children:"  "})}),r.jsx(Ce,{className:"space-y-4",children:r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("label",{className:"text-sm font-medium",children:" "}),r.jsxs("select",{value:e,onChange:b=>t(b.target.value),className:"w-full px-3 py-2 border rounded-md bg-background mt-1",children:[r.jsx("option",{value:"",children:" "}),u==null?void 0:u.map(b=>r.jsx("option",{value:b.id,children:b.name_ar},b.id))]})]}),r.jsx("div",{className:"pt-6",children:r.jsxs(L,{onClick:g,disabled:!e||m,children:[r.jsx(Nt,{className:"h-4 w-4 ml-2"})," "]})})]})})]}),r.jsx(et,{open:s,onOpenChange:n,children:r.jsxs(tt,{onClose:()=>n(!1),className:"max-w-4xl max-h-[80vh] overflow-auto",children:[r.jsx(it,{children:r.jsxs(lt,{children:["  - ",(j=u==null?void 0:u.find(b=>b.id===e))==null?void 0:j.name_ar]})}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"p-3 bg-blue-50 rounded-md",children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:" "}),r.jsx("p",{className:"text-2xl font-bold",children:a.length})]}),r.jsxs("div",{className:"p-3 bg-green-50 rounded-md",children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:""}),r.jsx("p",{className:"text-2xl font-bold text-green-600",children:p})]}),r.jsxs("div",{className:"p-3 bg-red-50 rounded-md",children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:""}),r.jsx("p",{className:"text-2xl font-bold text-destructive",children:y})]})]}),r.jsx("div",{className:"overflow-x-auto max-h-96",children:r.jsxs("table",{className:"w-full text-sm",children:[r.jsx("thead",{className:"sticky top-0 bg-background",children:r.jsxs("tr",{className:"border-b",children:[r.jsx("th",{className:"text-right py-2 px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-2",children:""}),r.jsx("th",{className:"text-right py-2 px-2",children:" "}),r.jsx("th",{className:"text-right py-2 px-2",children:" "}),r.jsx("th",{className:"text-right py-2 px-2",children:""})]})}),r.jsx("tbody",{children:a.map(b=>r.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[r.jsx("td",{className:"py-2 px-2 font-mono text-xs",children:b.product_code}),r.jsx("td",{className:"py-2 px-2",children:b.product_name}),r.jsx("td",{className:"py-2 px-2 text-center font-bold",children:b.system_quantity}),r.jsx("td",{className:"py-2 px-2",children:r.jsx(G,{type:"number",value:b.counted_quantity,onChange:N=>w(b.product_id,parseInt(N.target.value)||0),className:"w-24 text-center",min:0})}),r.jsxs("td",{className:"py-2 px-2 text-center",children:[b.variance!==0&&r.jsxs("span",{className:`font-bold ${b.variance_type==="surplus"?"text-green-600":"text-destructive"}`,children:[b.variance>0?"+":"",b.variance]}),b.variance===0&&r.jsx("span",{className:"text-muted-foreground",children:"-"})]})]},b.product_id))})]})}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:""}),r.jsx(G,{value:l,onChange:b=>o(b.target.value),placeholder:" ...",className:"mt-1"})]})]}),r.jsxs(js,{children:[r.jsx(L,{variant:"outline",onClick:()=>n(!1),children:""}),r.jsx(L,{onClick:()=>_.mutate(),disabled:_.isPending||a.some(b=>b.counted_quantity===0),children:_.isPending?" ...":" "})]})]})}),r.jsxs(le,{children:[r.jsx(Se,{children:r.jsx(Ge,{children:"  "})}),r.jsx(Ce,{children:v?r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:" ..."}):f!=null&&f.length?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b",children:[r.jsx("th",{className:"text-right py-3 px-2",children:" "}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:" "}),r.jsx("th",{className:"text-right py-3 px-2",children:" "}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""})]})}),r.jsx("tbody",{children:f.map(b=>{var N;return r.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[r.jsx("td",{className:"py-3 px-2 font-mono text-sm",children:b.count_number}),r.jsx("td",{className:"py-3 px-2",children:new Date(b.count_date||b.created_at).toLocaleDateString("ar-EG")}),r.jsx("td",{className:"py-3 px-2",children:r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(Ir,{className:"h-3 w-3"}),(N=b.branch)==null?void 0:N.name_ar]})}),r.jsx("td",{className:"py-3 px-2 text-center",children:b.total_items||0}),r.jsx("td",{className:"py-3 px-2 text-center",children:b.variance_items>0?r.jsx("span",{className:"text-destructive font-bold",children:b.variance_items}):r.jsx("span",{className:"text-green-600",children:"-"})}),r.jsx("td",{className:"py-3 px-2",children:b.status==="approved"?r.jsxs("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-700 flex items-center gap-1 w-fit",children:[r.jsx(zm,{className:"h-3 w-3"}),""]}):b.status==="rejected"?r.jsxs("span",{className:"px-2 py-1 rounded-full text-xs bg-red-100 text-red-700 flex items-center gap-1 w-fit",children:[r.jsx(Wm,{className:"h-3 w-3"}),""]}):r.jsxs("span",{className:"px-2 py-1 rounded-full text-xs bg-yellow-100 text-yellow-700 flex items-center gap-1 w-fit",children:[r.jsx(gn,{className:"h-3 w-3"}),""]})}),r.jsx("td",{className:"py-3 px-2",children:b.status==="pending"&&r.jsx(L,{size:"sm",onClick:()=>x.mutate(b.id),disabled:x.isPending,children:""})})]},b.id)})})]})}),r.jsx("div",{className:"block md:hidden space-y-3",children:f.map(b=>{var N;return r.jsx(le,{className:"p-4",children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-mono text-sm font-bold",children:b.count_number}),r.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(b.count_date||b.created_at).toLocaleDateString("ar-EG")})]}),b.status==="approved"?r.jsxs("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-700 flex items-center gap-1",children:[r.jsx(zm,{className:"h-3 w-3"}),""]}):b.status==="rejected"?r.jsxs("span",{className:"px-2 py-1 rounded-full text-xs bg-red-100 text-red-700 flex items-center gap-1",children:[r.jsx(Wm,{className:"h-3 w-3"}),""]}):r.jsxs("span",{className:"px-2 py-1 rounded-full text-xs bg-yellow-100 text-yellow-700 flex items-center gap-1",children:[r.jsx(gn,{className:"h-3 w-3"}),""]})]}),r.jsxs("div",{className:"space-y-1 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[r.jsx(Ir,{className:"h-3 w-3"}),":"]}),r.jsx("span",{className:"font-medium",children:(N=b.branch)==null?void 0:N.name_ar})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[r.jsx($o,{className:"h-3 w-3"})," :"]}),r.jsx("span",{className:"font-medium",children:b.total_items||0})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:" :"}),b.variance_items>0?r.jsx("span",{className:"text-destructive font-bold",children:b.variance_items}):r.jsx("span",{className:"text-green-600 font-medium",children:" "})]})]}),b.status==="pending"&&r.jsx(L,{size:"sm",className:"w-full",onClick:()=>x.mutate(b.id),disabled:x.isPending,children:""})]})},b.id)})})]}):r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:"   "})})]})]})}function N2(){const[e,t]=S.useState(!1),[s,n]=S.useState(""),[a,i]=S.useState(""),[l,o]=S.useState("all"),[c,u]=S.useState("all"),[d,m]=S.useState("all"),[f,v]=S.useState({expense_date:new Date().toISOString().split("T")[0],branch_id:"",category_id:"",amount:"",payment_method:"cash",payment_status:"paid",reference_number:"",notes:""}),g=ht(),w=Ea(),{data:_}=se({queryKey:["expense-branches"],queryFn:async()=>{const{data:h}=await I.from("branches").select("*").eq("status","active").order("name_ar");return h||[]}}),{data:x}=se({queryKey:["expense-categories-list"],queryFn:async()=>{const{data:h}=await I.from("expense_categories").select("*").eq("is_active",!0).order("name_ar");return h||[]}}),{data:p,isLoading:y}=se({queryKey:["expenses",s,a,l,c,d],queryFn:async()=>{let h=I.from("expenses").select("*, branch:branches(name_ar), category:expense_categories(name_ar), created_by_user:users!expenses_created_by_fkey(full_name_ar, full_name)").order("expense_date",{ascending:!1});s&&(h=h.gte("expense_date",s)),a&&(h=h.lte("expense_date",a)),l!=="all"&&(h=h.eq("branch_id",l)),c!=="all"&&(h=h.eq("category_id",c)),d!=="all"&&(h=h.eq("payment_status",d));const{data:R}=await h.limit(100);return R||[]}}),j=(p==null?void 0:p.reduce((h,R)=>h+(R.amount||0),0))||0,b=(p==null?void 0:p.filter(h=>h.payment_status==="paid").reduce((h,R)=>h+(R.amount||0),0))||0,N=(p==null?void 0:p.filter(h=>h.payment_status==="pending").reduce((h,R)=>h+(R.amount||0),0))||0,T=dt({mutationFn:async()=>{var W;const h=`EXP-${Date.now()}`,{data:R}=await I.from("users").select("id").limit(1),P=(W=R==null?void 0:R[0])==null?void 0:W.id,{error:U}=await I.from("expenses").insert({expense_number:h,expense_date:f.expense_date,branch_id:f.branch_id,category_id:f.category_id,amount:parseFloat(f.amount),payment_method:f.payment_method,payment_status:f.payment_status,reference_number:f.reference_number||null,notes:f.notes||null,created_by:P});if(U)throw U},onSuccess:()=>{g.invalidateQueries({queryKey:["expenses"]}),t(!1),v({expense_date:new Date().toISOString().split("T")[0],branch_id:"",category_id:"",amount:"",payment_method:"cash",payment_status:"paid",reference_number:"",notes:""}),alert("   !")},onError:h=>alert(": "+h.message)});return r.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl sm:text-2xl font-bold",children:""}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"  "})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 w-full sm:w-auto",children:[r.jsxs(L,{variant:"outline",onClick:()=>w("/expense-categories"),className:"w-full sm:w-auto",children:[r.jsx(th,{className:"h-4 w-4 ml-2"})," "]}),r.jsxs(L,{onClick:()=>t(!0),className:"w-full sm:w-auto",children:[r.jsx(Nt,{className:"h-4 w-4 ml-2"})," "]})]})]}),r.jsxs("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 md:grid-cols-3",children:[r.jsxs(le,{children:[r.jsxs(Se,{className:"flex flex-row items-center justify-between pb-2",children:[r.jsx(Ge,{className:"text-sm font-medium",children:" "}),r.jsx(ea,{className:"h-5 w-5 text-muted-foreground"})]}),r.jsxs(Ce,{children:[r.jsx("div",{className:"text-2xl font-bold",children:M(j)}),r.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[(p==null?void 0:p.length)||0," "]})]})]}),r.jsxs(le,{children:[r.jsxs(Se,{className:"flex flex-row items-center justify-between pb-2",children:[r.jsx(Ge,{className:"text-sm font-medium",children:""}),r.jsx(ea,{className:"h-5 w-5 text-green-600"})]}),r.jsx(Ce,{children:r.jsx("div",{className:"text-2xl font-bold text-green-600",children:M(b)})})]}),r.jsxs(le,{children:[r.jsxs(Se,{className:"flex flex-row items-center justify-between pb-2",children:[r.jsx(Ge,{className:"text-sm font-medium",children:""}),r.jsx(ea,{className:"h-5 w-5 text-yellow-600"})]}),r.jsx(Ce,{children:r.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:M(N)})})]})]}),r.jsx(et,{open:e,onOpenChange:t,children:r.jsxs(tt,{onClose:()=>t(!1),className:"max-w-[95vw] sm:max-w-2xl max-h-[90vh] overflow-y-auto",children:[r.jsx(it,{children:r.jsx(lt,{className:"text-base sm:text-lg",children:"  "})}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:" *"}),r.jsx(G,{type:"date",value:f.expense_date,onChange:h=>v({...f,expense_date:h.target.value})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:" *"}),r.jsxs("select",{value:f.branch_id,onChange:h=>v({...f,branch_id:h.target.value}),className:"w-full px-3 py-2 border rounded-md bg-background text-sm",children:[r.jsx("option",{value:"",children:" "}),_==null?void 0:_.map(h=>r.jsx("option",{value:h.id,children:h.name_ar},h.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:"  *"}),r.jsxs("select",{value:f.category_id,onChange:h=>v({...f,category_id:h.target.value}),className:"w-full px-3 py-2 border rounded-md bg-background text-sm",children:[r.jsx("option",{value:"",children:" "}),x==null?void 0:x.map(h=>r.jsx("option",{value:h.id,children:h.name_ar},h.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:" *"}),r.jsx(G,{type:"number",value:f.amount,onChange:h=>v({...f,amount:h.target.value}),placeholder:"0.00"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:" "}),r.jsxs("select",{value:f.payment_method,onChange:h=>v({...f,payment_method:h.target.value}),className:"w-full px-3 py-2 border rounded-md bg-background text-sm",children:[r.jsx("option",{value:"cash",children:""}),r.jsx("option",{value:"bank_transfer",children:" "}),r.jsx("option",{value:"check",children:""}),r.jsx("option",{value:"credit_card",children:" "})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:" "}),r.jsxs("select",{value:f.payment_status,onChange:h=>v({...f,payment_status:h.target.value}),className:"w-full px-3 py-2 border rounded-md bg-background text-sm",children:[r.jsx("option",{value:"paid",children:""}),r.jsx("option",{value:"pending",children:""})]})]}),r.jsxs("div",{className:"sm:col-span-2",children:[r.jsx("label",{className:"text-sm font-medium",children:" "}),r.jsx(G,{value:f.reference_number,onChange:h=>v({...f,reference_number:h.target.value}),placeholder:"   "})]}),r.jsxs("div",{className:"sm:col-span-2",children:[r.jsx("label",{className:"text-sm font-medium",children:""}),r.jsx(G,{value:f.notes,onChange:h=>v({...f,notes:h.target.value}),placeholder:" "})]})]}),r.jsxs(js,{className:"flex-col sm:flex-row gap-2",children:[r.jsx(L,{variant:"outline",onClick:()=>t(!1),className:"w-full sm:w-auto",children:""}),r.jsx(L,{onClick:()=>T.mutate(),disabled:!f.branch_id||!f.category_id||!f.amount||T.isPending,className:"w-full sm:w-auto",children:T.isPending?" ...":""})]})]})}),r.jsxs(le,{children:[r.jsx(Se,{children:r.jsxs("div",{className:"flex flex-col gap-3",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[r.jsx(lo,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:":"})]}),r.jsx(G,{type:"date",value:s,onChange:h=>n(h.target.value),className:"flex-1 sm:w-40",placeholder:""}),r.jsx("span",{className:"text-center sm:text-right text-sm",children:""}),r.jsx(G,{type:"date",value:a,onChange:h=>i(h.target.value),className:"flex-1 sm:w-40",placeholder:""})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2",children:[r.jsxs("select",{value:l,onChange:h=>o(h.target.value),className:"w-full px-3 py-2 border rounded-md bg-background text-sm",children:[r.jsx("option",{value:"all",children:" "}),_==null?void 0:_.map(h=>r.jsx("option",{value:h.id,children:h.name_ar},h.id))]}),r.jsxs("select",{value:c,onChange:h=>u(h.target.value),className:"w-full px-3 py-2 border rounded-md bg-background text-sm",children:[r.jsx("option",{value:"all",children:" "}),x==null?void 0:x.map(h=>r.jsx("option",{value:h.id,children:h.name_ar},h.id))]}),r.jsxs("select",{value:d,onChange:h=>m(h.target.value),className:"w-full px-3 py-2 border rounded-md bg-background text-sm",children:[r.jsx("option",{value:"all",children:" "}),r.jsx("option",{value:"paid",children:""}),r.jsx("option",{value:"pending",children:""})]})]})]})}),r.jsx(Ce,{children:y?r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:" ..."}):p!=null&&p.length?r.jsxs("div",{children:[r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b",children:[r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:" "}),r.jsx("th",{className:"text-right py-3 px-2",children:""}),r.jsx("th",{className:"text-right py-3 px-2",children:""})]})}),r.jsx("tbody",{children:p.map(h=>{var R,P;return r.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[r.jsx("td",{className:"py-3 px-2 font-mono text-sm",children:h.expense_number}),r.jsx("td",{className:"py-3 px-2",children:new Date(h.expense_date).toLocaleDateString("ar-EG")}),r.jsx("td",{className:"py-3 px-2",children:(R=h.branch)==null?void 0:R.name_ar}),r.jsx("td",{className:"py-3 px-2",children:(P=h.category)==null?void 0:P.name_ar}),r.jsx("td",{className:"py-3 px-2 font-bold",children:M(h.amount||0)}),r.jsx("td",{className:"py-3 px-2",children:r.jsxs("span",{className:"text-sm",children:[h.payment_method==="cash"&&"",h.payment_method==="bank_transfer"&&" ",h.payment_method==="check"&&"",h.payment_method==="credit_card"&&""]})}),r.jsx("td",{className:"py-3 px-2",children:r.jsxs("span",{className:`px-2 py-1 rounded-full text-xs ${h.payment_status==="paid"?"bg-green-100 text-green-700":h.payment_status==="pending"?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"}`,children:[h.payment_status==="paid"&&"",h.payment_status==="pending"&&"",h.payment_status==="cancelled"&&""]})}),r.jsx("td",{className:"py-3 px-2 text-sm text-muted-foreground",children:h.notes||"-"})]},h.id)})})]})}),r.jsx("div",{className:"block md:hidden space-y-3",children:p.map(h=>{var R,P;return r.jsx(le,{className:"p-4",children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-mono text-sm font-bold",children:h.expense_number}),r.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(h.expense_date).toLocaleDateString("ar-EG")})]}),r.jsxs("span",{className:`px-2 py-1 rounded-full text-xs ${h.payment_status==="paid"?"bg-green-100 text-green-700":h.payment_status==="pending"?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"}`,children:[h.payment_status==="paid"&&"",h.payment_status==="pending"&&"",h.payment_status==="cancelled"&&""]})]}),r.jsxs("div",{className:"space-y-1 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-medium",children:(R=h.branch)==null?void 0:R.name_ar})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-medium",children:(P=h.category)==null?void 0:P.name_ar})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:":"}),r.jsx("span",{className:"font-bold text-primary",children:M(h.amount||0)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:" :"}),r.jsxs("span",{className:"font-medium",children:[h.payment_method==="cash"&&"",h.payment_method==="bank_transfer"&&" ",h.payment_method==="check"&&"",h.payment_method==="credit_card"&&""]})]}),h.notes&&r.jsx("div",{className:"pt-2 border-t",children:r.jsx("p",{className:"text-xs text-muted-foreground",children:h.notes})})]})]})},h.id)})})]}):r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:"  "})})]})]})}function k2(){const[e,t]=S.useState(!1),[s,n]=S.useState(null),[a,i]=S.useState({name_ar:"",name_en:"",description:""}),l=ht(),{data:o,isLoading:c}=se({queryKey:["expense-categories"],queryFn:async()=>{const{data:g}=await I.from("expense_categories").select("*").order("name_ar");return g||[]}}),u=dt({mutationFn:async()=>{if(s){const{error:g}=await I.from("expense_categories").update({name_ar:a.name_ar,name_en:a.name_en||null,description:a.description||null,updated_at:new Date().toISOString()}).eq("id",s.id);if(g)throw g}else{const g=`EXP_${Date.now()}`,{error:w}=await I.from("expense_categories").insert({code:g,name_ar:a.name_ar,name_en:a.name_en||null,description:a.description||null,is_system:!1});if(w)throw w}},onSuccess:()=>{l.invalidateQueries({queryKey:["expense-categories"]}),t(!1),n(null),i({name_ar:"",name_en:"",description:""}),alert(s?"   !":"   !")},onError:g=>alert(": "+g.message)}),d=dt({mutationFn:async g=>{const{error:w}=await I.from("expense_categories").delete().eq("id",g);if(w)throw w},onSuccess:()=>{l.invalidateQueries({queryKey:["expense-categories"]}),alert("   !")},onError:g=>alert(": "+g.message)}),m=g=>{n(g),i({name_ar:g.name_ar,name_en:g.name_en||"",description:g.description||""}),t(!0)},f=g=>{if(g.is_system){alert("    ");return}confirm(`     "${g.name_ar}"`)&&d.mutate(g.id)},v=()=>{t(!1),n(null),i({name_ar:"",name_en:"",description:""})};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold",children:" "}),r.jsx("p",{className:"text-muted-foreground",children:"  "})]}),r.jsxs(L,{onClick:()=>t(!0),children:[r.jsx(Nt,{className:"h-4 w-4 ml-2"}),"  "]})]}),r.jsx(et,{open:e,onOpenChange:v,children:r.jsxs(tt,{onClose:v,className:"max-w-lg",children:[r.jsx(it,{children:r.jsx(lt,{children:s?"  ":"   "})}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"name_ar",className:"text-sm font-medium",children:"  *"}),r.jsx(G,{id:"name_ar",value:a.name_ar,onChange:g=>i({...a,name_ar:g.target.value}),placeholder:": "})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"name_en",className:"text-sm font-medium",children:" "}),r.jsx(G,{id:"name_en",value:a.name_en,onChange:g=>i({...a,name_en:g.target.value}),placeholder:"Example: Electricity"})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"description",className:"text-sm font-medium",children:""}),r.jsx(G,{id:"description",value:a.description,onChange:g=>i({...a,description:g.target.value}),placeholder:" "})]})]}),r.jsxs(js,{children:[r.jsx(L,{variant:"outline",onClick:v,children:""}),r.jsx(L,{onClick:()=>u.mutate(),disabled:!a.name_ar||u.isPending,children:u.isPending?" ...":""})]})]})}),r.jsxs(le,{children:[r.jsx(Se,{children:r.jsx(Ge,{children:" "})}),r.jsx(Ce,{children:c?r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:" ..."}):o!=null&&o.length?r.jsx("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:o.map(g=>r.jsx("div",{className:"p-4 border rounded-lg hover:border-primary transition-colors",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Cg,{className:"h-5 w-5 text-primary"}),r.jsxs("div",{children:[r.jsx("p",{className:"font-bold",children:g.name_ar}),g.name_en&&r.jsx("p",{className:"text-sm text-muted-foreground",children:g.name_en}),g.description&&r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:g.description}),g.is_system&&r.jsx("span",{className:"inline-block mt-2 px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded",children:""})]})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(L,{variant:"ghost",size:"icon",onClick:()=>m(g),children:r.jsx(yn,{className:"h-4 w-4"})}),!g.is_system&&r.jsx(L,{variant:"ghost",size:"icon",onClick:()=>f(g),children:r.jsx(Rs,{className:"h-4 w-4 text-destructive"})})]})]})},g.id))}):r.jsx("p",{className:"text-center py-8 text-muted-foreground",children:"  "})})]})]})}function S2(){return r.jsxs(jj,{children:[r.jsx(We,{path:"/login",element:r.jsx(D1,{})}),r.jsxs(We,{path:"/",element:r.jsx(W_,{}),children:[r.jsx(We,{index:!0,element:r.jsx(eg,{to:"/dashboard",replace:!0})}),r.jsx(We,{path:"dashboard",element:r.jsx(F1,{})}),r.jsx(We,{path:"pos",element:r.jsx(h2,{})}),r.jsx(We,{path:"products",element:r.jsx(B1,{})}),r.jsx(We,{path:"customers",element:r.jsx(K1,{})}),r.jsx(We,{path:"sales",element:r.jsx(V1,{})}),r.jsx(We,{path:"inventory",element:r.jsx(H1,{})}),r.jsx(We,{path:"purchases",element:r.jsx(Q1,{})}),r.jsx(We,{path:"suppliers",element:r.jsx(X1,{})}),r.jsx(We,{path:"returns",element:r.jsx(Z1,{})}),r.jsx(We,{path:"transfers",element:r.jsx(r2,{})}),r.jsx(We,{path:"damaged",element:r.jsx(n2,{})}),r.jsx(We,{path:"reports",element:r.jsx(f2,{})}),r.jsx(We,{path:"partner-withdrawals",element:r.jsx(w2,{})}),r.jsx(We,{path:"customer-statement",element:r.jsx(_2,{})}),r.jsx(We,{path:"stock-count",element:r.jsx(b2,{})}),r.jsx(We,{path:"expenses",element:r.jsx(N2,{})}),r.jsx(We,{path:"expense-categories",element:r.jsx(k2,{})}),r.jsx(We,{path:"settings",element:r.jsx(a2,{})})]})]})}const C2=new ew({defaultOptions:{queries:{staleTime:1e3*60*5,retry:1}}});Cc.createRoot(document.getElementById("root")).render(r.jsx(is.StrictMode,{children:r.jsx(tw,{client:C2,children:r.jsx(Cj,{children:r.jsx(S2,{})})})}));
